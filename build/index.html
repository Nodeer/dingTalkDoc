
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>钉钉开放平台</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <link href="stylesheets/nav.css" rel="stylesheet" type="text/css" media="nav" />
    <script src="./javascripts/jquery.min.js" type="text/javascript"></script>
      <script src="javascripts/all_nosearch.js" type="text/javascript"></script>
  </head>

  <body class="index">

	  <div class="navbar-container">
      <nav class="navbar"  id="top-nav">
        <a class="logo-container" href="/">
	      <div class="logo" style="font-family:'Microsoft Yahei','SimHe','SimSun'"></div>
	      </a>
        <ul>
          <li><a href="#概述">概述</a></li>
          <li><a href="#接入指南">接入指南</a></li>
          <li><a href="#服务端开发文档">服务端开发文档<b class="caret"></b></a>
          </li>
          <li><a href="#客户端开发文档">客户端开发文档<b class="caret"></b></a>
          </li>
          <li><a href="#faq">FAQ</a></li>
        </ul>
      </nav>
    </div>





    <a href="#" id="nav-button">
      <span>
        菜单
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="概述">概述</h1>

<p>欢迎您成为钉钉开放平台的开发者。</p>

<p>钉钉是阿里巴巴专为中小企业和团队打造的沟通、协同的多端平台，钉钉开放平台旨在为企业提供更为丰富的办公协同解决方案。通过钉钉开放平台，企业或第三方合作伙伴可以帮助企业快速、低成本的实现高质量的移动微应用，实现生产、管理、协作、运营的移动化。钉钉开放平台依托阿里巴巴多年的技术积累，建立业界一流的开放技术体系，帮助每一位开发者，提升开发效率，降低开发成本与难度。钉钉开放平台能帮助您获得更多的商业机会，服务更多的企业客户，从而不断的提升你的价值。</p>

<p>当您成功注册为开发者，可以通过本文档所描述的接口创建钉钉微应用，为企业实现更多丰富且个性化的企业移动应用。</p>

<p>开发者可以通过以下方式了解更多关于钉钉开放平台的消息：</p>

<ul>
<li><a href="http://bbs.aliyun.com/thread/276.html?spm=5176.7189909.0.0.bq46VP"><font color=red >开发者论坛</font></a></li>
<li>邮件组: open-dingtalk@list.alibaba-inc.com</li>
</ul>

          <h1 id="快速开发指南">快速开发指南</h1>

<p>假如你是企业用户，要为自己的公司开发微应用，查看<a href="#企业接入"><font color=red >企业接入</font></a>。</p>

<p>假如你是ISV(服务提供商)，作为第三方要给其他公司提供微应用，先查看<a href="#isv接入"><font color=red >ISV接入</font></a>。</p>

<p>钉钉开放平台提供了<strong>企业通讯录管理、文件管理、发送企业会话消息</strong>等功能，接口使用可以参考<a href="#服务端开发文档"><font color=red >服务端开发文档</font></a>；</p>

<p>我们定制了微应用专用的运行容器，提供了一组可以调用<strong>钉钉的本地能力和业务逻辑</strong>的JS接口，开发者可以通过这些接口使用钉钉的本地能力或者钉钉的业务逻辑，降低开发成本，提高微应用在移动客户端的体验。接口使用可以参考<a href="#客户端开发文档"><font color=red >客户端开发文档</font></a>。</p>

<p>该指南主要介绍了企业和ISV（服务提供商）如何接入钉钉开放平台，其中涉及到接入过程中使用的工具、与钉钉开放平台相关的概念和接入钉钉开放平台的一些实践方法，以帮助开发者快速开发自己的微应用。</p>

<h2 id="企业接入">企业接入</h2>

<p>企业接入指南重点介绍使用钉钉开放平台的开发微应用的流程，帮助企业快速接入钉钉开放平台。该节主要分为四个部分：第一部分介绍企业接入钉钉开放平台的准备工作；第二部介绍如何访问开放平台服务端接口；第三部分介绍钉钉开放平台提供的员工身份验证流程；第四部分介绍发送消息到微应用会话。</p>

<p><br /></p>

<h3 id="开发环境准备">开发环境准备</h3>

<p>开发者在使用钉钉开放平台开发微应用前需做好以下准备：</p>

<ul>
<li>获取钉钉开放平台开发者信息；</li>
<li>服务端环境搭建和域名注册；</li>
<li>开发环境搭建；</li>
</ul>

<p>开发者可以从 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 获取必要的信息用于微应用开发，还可以利用该系统完成微应用配置相关的工作；开发者可以自己搭建服务器也可以购买云主机来搭建自己的服务端环境，开发者需要为自己的微应用注册合法有效的域名并配置在 <a href="https://oa.dingtalk.com/#/microApp/microAppList"><font color=red >应用中心</font></a> ；钉钉开放平台的服务端接口不区分语言和平台，开发者可以使用自己熟悉的技术搭建开发环境来开发微应用。</p>

<p><a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 系统为企业提供了企业通讯录管理、微应用、安全中心、员工数据统计和系统常用设置等功能。</p>

<p><img alt="oa_system.jpg" src="https://img.alicdn.com/tps/TB1b4jcJFXXXXXOXpXXXXXXXXXX-666-421.jpg" /></p>

<p><strong>钉钉管理后台管理员（以下简称钉钉后台管理员）</strong> 在企业通讯录管理页面可以完成企业的组织结构和员工个人信息的添加、删除、查看和修改等操作；在微应用管理页面可以完成添加和删除微应用，获取CorpID和CorpSecret(接入钉钉开放平台的凭证)，查看微应用相关信息，管理微应用的运行状态等。开发者在使用该系统前需要注册成为钉钉后台管理员或者由钉钉后台管理员分配管理员子帐号。</p>

<h3 id="创建微应用">创建微应用</h3>

<p>一、进入 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 页面, 点击 <a href="https://oa.dingtalk.com/register.html?spm=0.0.0.0.dL51oc"><font color=red >企业注册</font></a>；（已经注册可跳过此步骤）</p>

<p><img alt="enterprise_register_entry" src="https://img.alicdn.com/tps/TB14kI8IFXXXXciapXXXXXXXXXX.jpg" /></p>

<p>二、填写注册手机号码和短信验证码；</p>

<p>三、输入企业基本信息和管理员帐号和密码，点击 <em>注册</em> 按钮完成注册过程。</p>

<p><img alt="input_enterprise_info" src="https://img.alicdn.com/tps/TB1bru8JFXXXXXcXFXXXXXXXXXX-1171-807.png" /></p>

<aside class="notice">
通过钉钉移动客户端创建的企业默认没有设置钉钉后台管理员，需要通过以上流程注册管理员帐号。
</aside>

<h4 id="分配管理员子账号：">分配管理员子账号：</h4>

<p>一、登录钉钉后台管理系统，按下图进入安全中心的添加管理员子帐号页面；</p>

<p><img alt="add_sub_manager" src="https://img.alicdn.com/tps/TB1Q3DiJFXXXXbkXXXXXXXXXXXX-1147-377.png" /></p>

<p>二、按下图提示填写子帐号信息</p>

<p><img alt="set_sub_manager_account" src="https://img.alicdn.com/tps/TB16euYJFXXXXcRXFXXXXXXXXXX-601-336.png" /></p>

<p>完成管理员子帐号设置后，子帐号关联的钉钉用户会在钉钉客户端的 <em>钉小秘</em> 会话中收到管理员帐号和初始密码，该钉钉用户可以通过收到的帐号和密码登录 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 进入安全中心对初始密码进行修改。</p>

<h4 id="微应用管理和创建">微应用管理和创建</h4>

<p>登录钉钉管理后台后可以进入 <em>应用中心</em> 页面对微应用进行运行状态管理，进入微应用后台，微应用信息查看与设置，微应用添加和删除等操作。</p>

<p><img alt="enter_microapp_center" src="https://img.alicdn.com/tps/TB1lnfcJFXXXXc6XXXXXXXXXXXX-1110-783.png" /></p>

<p>点击 <em>新增微应用</em> 按钮，按下图填写微应用信息，点击确定后可以新增微应用。</p>

<p><img alt="add_micro_app" src="https://img.alicdn.com/tps/TB1Qe_XJFXXXXalXpXXXXXXXXXX-598-477.png" /></p>

<p><em>首页地址</em> : 以<code class="prettyprint">http://</code>或者<code class="prettyprint">https://</code> 开头的URL，是微应用的首页地址；在移动设备上打开微应用Tab页，点击微应用列表中的微应用将访问这个URL指向的页面。</p>

<p><em>后台地址</em> : 以<code class="prettyprint">http://</code>或者<code class="prettyprint">https://</code> 开头的URL，是微应用的后台管理页面地址；配置后台地址后可以通过应用中心页面进入到微应用的管理后台。</p>

<aside class="notice">
<b>首页地址</b> 的URL域名务必保证真实有效，否则会导致钉钉用户无法正常使用微应用。
</aside>

<p>每个微应用都有 <em>设置</em> 选项，点击后进入微应用的设置页面，开发者可以在这里修改微应用的常用信息设置</p>

<p><img alt="get_micro_app_agentID" src="https://img.alicdn.com/tps/TB1N490JFXXXXceXFXXXXXXXXXX-602-524.png" /></p>

<p>开发者在应用中心创建微应用后，如上图所示可获取到微应用的AgentID，AgentID可用于发送企业会话消息等场景。</p>

<p>开发者完成以上准备工作后就可以进入开发阶段。</p>

<p><br /></p>

<p>创建成功之后将会在手机的工作tab上显示出来</p>

<p><img alt="createMi" src="https://img.alicdn.com/tps/TB1xStVKpXXXXbjXFXXXXXXXXXX-361-640.jpg" /></p>

<h3 id="使用免登服务">使用免登服务</h3>

<p>假如在进入微应用的时候需要获取当前用户的信息，可以使用免登服务，实现账户打通。详细文档请参阅<a href="#免登服务"><font color=red >免登服务</font></a>。</p>

<p><br /></p>

<h3 id="调用平台接口">调用平台接口</h3>

<p>开发者在调用钉钉开放平台接口时需要附加AccessToken，AccessToken可以通过CorpID和CorpSecret获取。</p>

<h4 id="获取corpid和corpsecret">获取CorpID和CorpSecret</h4>

<p>CorpID是企业的唯一标识，获取CorpID和CorpSecret的步骤如下:</p>

<p>一、使用管理员帐号登录 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> ；</p>

<p>二、选择顶部菜单 <strong>微应用</strong> 进入微应用页面，在左侧菜单选择 <strong>微应用设置</strong> 进入微应用设置页；</p>

<p>三、在微应用设置页面底部点击 <strong>获取</strong> 按钮即可获取CorpID和CorpSecret。</p>

<p><img alt="get_scecret_corpId" src="https://img.alicdn.com/tps/TB1xStVKpXXXXbjXFXXXXXXXXXX-361-640.jpg" /></p>

<aside class="notice">
钉钉开放平台提供了获取和修改企业(团队)的组织结构信息、人员信息等功能，所以请妥善保管CorpID和CorpSecret，避免外泄影响企业信息安全。
</aside>

<h4 id="获取accesstoken">获取AccessToken</h4>

<p>开发者在调用开放平台接口前需要通过CorpID和CorpSecret获取AccessToken。获取AccessToken的方法是向 <code class="prettyprint">https://oapi.dingtalk.com/gettoken?corpid=id&amp;corpsecret=secrect</code> GET请求。</p>

<p>开发者获取AccessToken后便可以调用开放平台其他接口。</p>

<p>以获取部门列表接口为例，获取部门列表接口为：</p>

<p><code class="prettyprint">oapi.dingtalk.com/department/list</code></p>

<p>在请求该接口时，需要将获取的AccessToken作为请求参数拼装到URL中：</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/list?access_token=ACCESS_TOKEN</code></p>

<p>更多关于AccessToken的信息请参考<a href="#建立连接"><font color=red >《服务端开发文档-建立连接》</font></a>一节。</p>

<p><br /></p>

<h3 id="发送企业会话消息">发送企业会话消息</h3>

<p>用户可以在企业会话中查看微应用发送的消息，开发者可以通过发送消息接口将消息发送到企业会话中。</p>

<p><img alt="send_micro_app_message" src="https://img.alicdn.com/tps/TB1X.m6JFXXXXX0XFXXXXXXXXXX-1089-652.jpg" /></p>

<p>调用消息发送接口时需要使用<code class="prettyprint">HTTPS</code>协议，发送的数据包为<code class="prettyprint">JSON</code>格式。目前钉钉开放平台支持文本、图片、声音、文件、链接、办公消息等消息类型。</p>

<h3 id="示例程序">示例程序</h3>

<p>在<a href="#demo"><font color=red >《Open API - 代码示例》</font></a>中有发送消息的代码演示，开发者可以下载参考。</p>

<p>如果在使用开放平台中遇到困难请浏览<a href="#faq"><font color=red >《常见问题》</font></a>一节，若仍不能解决请按概述中的提供的反馈方式联系我们。</p>

<h2 id="isv接入">ISV接入</h2>

<h3 id="钉钉isv（服务提供商）应用授权和接口说明">钉钉ISV（服务提供商）应用授权和接口说明</h3>

<p>欢迎成为钉钉微应用的服务提供商！
通过接入钉钉ISV的应用授权接口，可以快速发布自己的微应用套件，引导企业客户自动开通微应用，将自己的服务快速触达到自己的目标客户！
钉钉的应用授权方案包含以下两个场景：</p>

<h4 id="isv注册应用">ISV注册应用</h4>

<p>你，作为ISV若要使用此方案，只需在阿里云上注册成为第三方服务提供商，在ISV接入后台创建应用套件，并在应用套件中配置好相应的应用。
本方案所说的应用套件，是第三方应用授权的主体，它可以包含多个第三方所提供的同一类型的应用。目前一个第三方最多可以注册五个应用套件，一个应用套件最多可以包含五个应用。</p>

<h4 id="企业管理员授权应用">企业管理员授权应用</h4>

<p>企业的管理员在钉钉企业后台的微应用列表中浏览你的应用套件后，即可发起一键授权，系统将展示微应用的第三方授权页面，管理员根据授权页面的引导，确认授权内容，完成授权操作。
授权完成之后，企业就可使用ISV服务提供商所提供的应用服务了。一切将变得简单自然。以下是详细的接口调用时序图</p>

<p><img alt="Mou icon" src="https://img.alicdn.com/tps/TB1RhMGJXXXXXXdXVXXXXXXXXXX-876-659.jpg" /></p>

<h3 id="1-注册成为第三方服务提供商">1:注册成为第三方服务提供商</h3>

<h4 id="1-1需要提供的数据项">1.1需要提供的数据项</h4>

<table><thead>
<tr>
<th>字段</th>
<th>属性</th>
</tr>
</thead><tbody>
<tr>
<td>开发者介绍</td>
<td>100字</td>
</tr>
<tr>
<td>开发应用类型</td>
<td>选择“钉钉企业账号”</td>
</tr>
<tr>
<td>钉钉企业账号</td>
<td>4-11位小写英文字符、数字、下划线</td>
</tr>
<tr>
<td>账号密码</td>
<td>必须为6位以上数字、大小写字母的组合</td>
</tr>
</tbody></table>

<h4 id="1-2-描述（description）">1.2 描述（Description）</h4>

<p>阿里云用户登录后，在通过实名认证的情况下，填写相关信息，完成开发者的身份申请。</p>

<h4 id="1-3-前置条件（pre-conditions）">1.3 前置条件（Pre-Conditions）</h4>

<p>申请者首先是阿里云用户</p>

<h4 id="1-4-基本流程（basic-flow）">1.4 基本流程（Basic Flow）</h4>

<h5 id="a-点击进入控制台，进行登录。">a. 点击进入<a href="http://console.d.aliyun.com"><font color=red >控制台</font></a>，进行登录。</h5>

<h5 id="b-登录阿里云账号">b. 登录阿里云账号</h5>

<h5 id="c-进行实名认证（已经实名认证过的开发者直接看g-步骤）">c. 进行实名认证（已经实名认证过的开发者直接看g.步骤）</h5>

<p>用户未通过实名认证，需要实名认证后，才能申请开发者，流程如下：</p>

<h5 id="d-点击“立即认证”">d. 点击“立即认证”</h5>

<p><img alt="lijirz" src="https://img.alicdn.com/tps/TB1PUwmIVXXXXbbXXXXXXXXXXXX-866-305.png" /></p>

<h5 id="e-新开窗口跳转到阿里云认证页面">e. 新开窗口跳转到阿里云认证页面</h5>

<p><img alt="shimingrz" src="https://img.alicdn.com/tps/TB1lv3iIVXXXXa6XpXXXXXXXXXX-866-412.png" /></p>

<h5 id="f-实名认证通过，在弹窗点击“立即刷新”按钮">f. 实名认证通过，在弹窗点击“立即刷新”按钮</h5>

<p><img alt="zhengzairz" src="https://img.alicdn.com/tps/TB11m_VIVXXXXaqapXXXXXXXXXX-866-334.png" /></p>

<h5 id="g-显示已通过实名认证">g. 显示已通过实名认证</h5>

<p><img alt="shiming" src="https://img.alicdn.com/tps/TB1C3T6IVXXXXXWaXXXXXXXXXXX-866-335.png" /></p>

<h5 id="h-选择开发应用类型为“钉钉企业类型”，填入“钉钉企业账号”">h. 选择开发应用类型为“钉钉企业类型”，填入“钉钉企业账号”</h5>

<h5 id="i-显示申请开发者成功">i. 显示申请开发者成功</h5>

<h3 id="2-创建套件">2: 创建套件</h3>

<h4 id="2-1-需要提供的数据项：">2.1 需要提供的数据项：</h4>

<table><thead>
<tr>
<th>字段</th>
<th>属性</th>
</tr>
</thead><tbody>
<tr>
<td>套件Logo</td>
<td>上传大小不超过1M，长宽等比且范围在50px至200px之间的png格式图片</td>
</tr>
<tr>
<td>回调URL</td>
<td>以http://开头，系统将会把此套件的SuiteTicket，临时授权码以及授权变更事件推送给此URL，详细请看<a href="#5-回调接口（分为五个回调类型）"><font color=red >回调接口</font></a></td>
</tr>
<tr>
<td>Token</td>
<td>可任意填写，用于生成签名，校验回调请求的合法性。本套件下相关应用产生的回调消息都使用该值来解密。</td>
</tr>
<tr>
<td>数据加密密钥</td>
<td>回调消息加解密参数，是AES密钥的Base64编码，用于解密回调消息内容对应的密文。本套件下相关应用产生的回调消息都使用该值来解密。</td>
</tr>
<tr>
<td>IP白名单</td>
<td>调用钉钉API时的合法IP列表，多个IP请以“,”隔开，如IP有变化，请立即更新</td>
</tr>
<tr>
<td>部署方式</td>
<td>选择ACE，系统接下来将自动开通基于ACE的开发环境，选择其他则需要自行准备开发环境</td>
</tr>
<tr>
<td>当前状态</td>
<td>对于需要公开售卖的套件，只有处于已完成状态，才可进入售卖流程</td>
</tr>
</tbody></table>

<h4 id="2-2-描述（description）">2.2 描述（Description）</h4>

<p>在开发钉钉应用前，首先要创建一个套件，套件可以包含一组应用，并对这组应用统一进行权限管理。</p>

<h4 id="2-3-前置条件（pre-conditions）">2.3 前置条件（Pre-Conditions）</h4>

<p>阿里云用户成功申请开发者</p>

<h4 id="2-4-基本流程（basic-flow）">2.4 基本流程（Basic Flow）</h4>

<h5 id="a-钉钉应用菜单-套件列表，点击“创建套件”">a.钉钉应用菜单-套件列表，点击“创建套件”</h5>

<p><img alt="createtj" src="https://img.alicdn.com/tps/TB1fyqYJFXXXXcXXVXXXXXXXXXX-1346-479.jpg" /></p>

<h5 id="b．填写创建套件表单">b．填写创建套件表单</h5>

<p><img alt="createtjbd" src="https://img.alicdn.com/tps/TB1Az_EJFXXXXb3XFXXXXXXXXXX-678-539.jpg" /></p>

<p><strong>当您注册套件时，钉钉服务器为了避免无效推送，将会验证回调url的有效性，对回调url推送&quot;验证回调URL有效性事件&ldquo;，收到推送后您需要做正确的处理，才能成功创建套件。详细处理步骤请查看<a href="#5-回调接口（分为五个回调类型）"><font color=red >回调接口</font></a>和&quot;验证回调URL有效性事件&quot;。</strong></p>

<h5 id="c-点击“确定”按钮进入套件列">c.点击“确定”按钮进入套件列</h5>

<p>在这里可以查看套件详细信息，比如套件Key（suite_key），套件secret(suite_secret)</p>

<h3 id="3-创建微应用">3: 创建微应用</h3>

<h4 id="3-1-需要提供的数据项：">3.1 需要提供的数据项：</h4>

<table><thead>
<tr>
<th>字段</th>
<th>属性</th>
</tr>
</thead><tbody>
<tr>
<td>名称</td>
<td>应用的名称，2-16个字。</td>
</tr>
<tr>
<td>图标</td>
<td>上传大小不超过1M，长宽等比且范围在50px至200px之间的png格式图片</td>
</tr>
<tr>
<td>应用描述</td>
<td>描述该应用的功能与特色，4-120个字内</td>
</tr>
<tr>
<td>主页地址</td>
<td>以http://开头，用于接收托管企业应用的用户消息，URL支持使用$CORPID$模板参数表示corpid，用户访问应用的时候将把$CORPID$替换成用户所属企业的corpid，例如http://www.dingtalk.com/index?corpid=$CORPID$</td>
</tr>
<tr>
<td>权限设置</td>
<td>多选</td>
</tr>
<tr>
<td>接口权限</td>
<td>多选</td>
</tr>
</tbody></table>

<h4 id="3-2-描述（description）">3.2 描述（Description）</h4>

<p>开发者编辑套件基本信息，创建微应用。</p>

<h4 id="3-3-前置条件（pre-conditions）">3.3 前置条件（Pre-Conditions）</h4>

<p>阿里云用户，申请成为开发者，套件列表点击“管理”操作</p>

<h4 id="3-4-基本流程（basic-flow）">3.4 基本流程（Basic Flow）</h4>

<h5 id="a-查看套件基本信息">a 查看套件基本信息</h5>

<h5 id="b-点击“创建微应用按钮”">b 点击“创建微应用按钮”</h5>

<p><img alt="createmini1" src="https://img.alicdn.com/tps/TB19X14JFXXXXc3XFXXXXXXXXXX-1164-326.jpg" /></p>

<h5 id="c-添加创建微应用表单，点击“确定”按钮">c 添加创建微应用表单，点击“确定”按钮</h5>

<p><img alt="createmini2" src="https://img.alicdn.com/tps/TB1G0nnJFXXXXa8XXXXXXXXXXXX-705-649.jpg" /></p>

<h5 id="d-微应用列表添加一行记录">d 微应用列表添加一行记录</h5>

<p><img alt="createmini3" src="https://img.alicdn.com/tps/TB1V7DoJFXXXXarXXXXXXXXXXXX-1164-440.jpg" /></p>

<h3 id="4-注册测试企业">4: 注册测试企业</h3>

<h4 id="1-描述（description）">1.描述（Description）</h4>

<p>钉钉套件在开发过程中，需要在钉钉移动端上登录绑定了相关企业的钉钉帐号来进行调试。在此之前，需要开发者对注册的测试企业&quot;发起授权所有套件&quot;，之后钉钉服务器会向您填写的回调url<a href="##5-回调接口（分为五个回调类型）"><font color=red>推送临时授权码</font></a>，您需要通过临时授权码一步一步到<a href="#11-激活授权套件"><font color=red>激活授权套件</font></a>，才能让测试企业的微应用列表出现您开发的微应用。</p>

<h4 id="2-前置条件（pre-conditions）">2.前置条件（Pre-Conditions）</h4>

<p>阿里云用户成功申请开发者</p>

<h4 id="3-基本流程（basic-flow）">3.基本流程（Basic Flow）</h4>

<h5 id="a-钉钉应用菜单—开发环境列表，点击“注册测试企业”">a.钉钉应用菜单—开发环境列表，点击“注册测试企业”</h5>

<p><img alt="signintest1" src="https://img.alicdn.com/tps/TB1VBWRJVXXXXXGaXXXXXXXXXXX-1022-78.jpg" /></p>

<h5 id="b-填写企业相关信息">b.填写企业相关信息</h5>

<p><img alt="signintest2" src="https://img.alicdn.com/tps/TB1p1H3IVXXXXX8aXXXXXXXXXXX-729-447.png" /></p>

<h5 id="c-点击“确定”后列表增加一行记录">c.点击“确定”后列表增加一行记录</h5>

<p><img alt="signintest3" src="https://img.alicdn.com/tps/TB1pvqVJVXXXXahXVXXXXXXXXXX-1029-343.jpg" /></p>

<h5 id="d-点击“模拟测试企业发起授权所有套件”，弹窗提示微应用开通成功">d.点击“模拟测试企业发起授权所有套件”，弹窗提示微应用开通成功</h5>

<p>注意：只有在微应用注册的回调接口能够接收推送，才能成功开通微应用，具体详情查看<a href="#5-回调接口（分为五个回调类型）"><font color=red>回调接口</font></a></p>

<p><img alt="signintest4" src="https://img.alicdn.com/tps/TB1B2njJVXXXXaEXXXXXXXXXXXX-1048-158.jpg" /></p>

<h5 id="e-点击“登录管理”跳转钉钉登录后台">e.点击“登录管理”跳转钉钉登录后台</h5>

<p><img alt="signintest5" src="https://img.alicdn.com/tps/TB1lEKUJVXXXXaSXVXXXXXXXXXX-1048-158.jpg" /></p>

<p><img alt="signintest6" src="https://img.alicdn.com/tps/TB1snUfIVXXXXbSXpXXXXXXXXXX-866-456.png" /></p>

<h3 id="5-回调接口（分为五个回调类型）">5: 回调接口（分为五个回调类型）</h3>

<p>在使用回调接口之前您需要了解的是，</p>

<p>首先要拿到您创建套件时填写的&quot;回调URL&quot;，&quot;Token&quot;，&quot;数据加密密钥(ENCODING_AES_KEY)&quot;，</p>

<ul>
<li><p>回调URL:服务提供商接收推送请求的协议和地址</p></li>
<li><p>Token:服务提供商在注册时任意填写的，用来生成signature，用来和回调参数中的signature比对，校验消息的合法性</p></li>
<li><p>数据加密密钥(ENCODING_AES_KEY):用于消息体的加解密。</p></li>
</ul>

<p>钉钉服务器会向服务提供商申请时填写的套件回调URL定时推送SuiteTicket，以及临时授权码和授权设置变更。</p>

<p>假设您提供的回调URL是</p>

<p><code class="prettyprint">https://127.0.0.1/suite/receive</code></p>

<p>那么在钉钉服务器每一次访问回调URL的时候
将请求(下面链接中的signature,timestamp,nonce的值只是示例，并不代表真实返回的值):</p>

<p><code class="prettyprint">https://127.0.0.1/suite/receive?signature=111108bb8e6dbce3c9671d6fdb69d15066227608
&amp;timestamp=1783610513&amp;nonce=380320111</code></p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>回调数据的格式如右所示：</p>

<p>其中的encrypt字段是经过加密的消息体，encrypt经过一系列解密步骤后，才能产生下面所说的“POST数据解密后示例”，服务提供商可以直接使用钉钉提供的库进行解密的处理。</p>

<p>除此之外，在接收到推送之后，<strong>需要返回相应的加密字符串（代表了你收到了推送）</strong>，如果ISV未能成功返回，钉钉服务器将持续推送下去，达到100次后将不再推送。</p>

<p>&quot;Talk is cheap, show me the code.&quot;所以我们也为开发者提供了加解密的demo，目前提供Java/PHP等语言版本。
加解密库和demo的下载：<a href="#加解密库和demo下载"><font color=red >加解密库和demo下载</font></a></p>

<p>本地调试：<a href="#调试工具"><font color=red >如何本地进行调试？</font></a></p>

<p>如有需要，可以查看具体加解密步骤：<a href="#12-加解密方案"><font color=red >查看</font></a></p>

<h4 id="a-验证回调url有效性事件">a.<font color=red >验证回调URL有效性事件</font></h4>

<p>此事件的推送会发生在注册套件，点击下图按钮之时。注意，若未能成功验证回调URL有效性，套件将不能被创建。</p>

<p><img alt="verifyurl" src="https://img.alicdn.com/tps/TB1RuHzJFXXXXahXVXXXXXXXXXX-615-100.jpg" /></p>
<pre class="highlight plaintext"><code>dingTalkEncryptor = new DingTalkEncryptor(Env.TOKEN, Env.ENCODING_AES_KEY, Env.CREATE_SUITE_KEY);//套件在创建中，使用默认的SUITE_KEY进行加解密

</code></pre>

<p>此时，由于套件尚未创建成功，还未生成套件的SUITE_KEY，所以在解密post数据的时候，需要使用默认的Env.CREATE_SUITE_KEY（默认值为&quot;suite4xxxxxxxxxxxxxxx&quot;）来解密，以java-demo代码为例（Env为Demo中配置文件），如右。</p>

<p>待成功处理『验证回调URL有效性事件』事件，套件创建成功之后，就不能再使用默认的SUITE_KEY了，需要使用套件本身的SUITE_KEY，所以需要在Env.java中配置SUITE_KEY，然后重新部署代码,此时将用下面的语句进行加解密。</p>

<p><code class="prettyprint">dingTalkEncryptor = new DingTalkEncryptor(Env.TOKEN, Env.ENCODING_AES_KEY, Env.SUITE_KEY);//套件创建成功后，使用套件本身的SUITE_KEY进行加解密</code></p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">

  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="s2">"check_create_suite_url"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Random"</span><span class="p">:</span><span class="s2">"brdkKLMW"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TestSuiteKey"</span><span class="p">:</span><span class="s2">"suite4xxxxxxxxxxxxxxx"</span><span class="w">

</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>Random</td>
<td>随机字符串</td>
</tr>
<tr>
<td>EventType</td>
<td>check_create_suite_url</td>
</tr>
<tr>
<td>TestSuiteKey</td>
<td>校验的SuiteKey</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密后&quot;Random&quot;字段的json数据，比如对于上面的示例，需要返回的即是加密后的&quot;brdkKLMW&quot;字符串。</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;Random&quot;字段的加密字符串</td>
</tr>
</tbody></table>

<h4 id="b-定时推送ticket">b: 定时推送Ticket</h4>

<p>服务器会向服务提供商申请时填写的套件事件接收 URL定时（二十分钟）推送ticket：</p>

<p>服务提供商在收到ticket推送后务必返回经过加密的字符串&quot;success&quot;的json数据</p>

<p>如果不返回，钉钉服务器将连续推送，直到推送次数超过100次，就不再推送。倘若您希望钉钉服务器重新推送，需要进入<a href="http://console.d.aliyun.com"><font color=red>开发者后台</font></a>，进入套件管理页面，点击『重新推送』按钮，即可重新推送。
<img alt="repush" src="https://img.alicdn.com/tps/TB15j7OJFXXXXckXXXXXXXXXXXX-1121-124.jpg" /></p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suitexxxxxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suite_ticket "</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234456</span><span class="p">,</span><span class="w">
  </span><span class="nt">"SuiteTicket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"adsadsad"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>EventType</td>
<td>suite_ticket</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>SuiteTicket</td>
<td>Ticket内容</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h4 id="c-回调向isv推送临时授权码">c:回调向ISV推送临时授权码</h4>

<p>当授权方（即授权企业）在微应用管理端的授权管理中，向服务提供商的应用套件授权了访问权限，钉钉服务器会向服务提供商的套件事件接收 URL（创建套件时填写）推送临时授权码，</p>

<p>比如在<a href="http://console.d.aliyun.com"><font color=red>钉钉开发者后台</font></a>中，模拟测试企业发起授权，钉钉服务器就会向回调url推送测试企业的临时授权码</p>

<p><img alt="shouqun" src="https://img.alicdn.com/tps/TB1rZerKpXXXXX8XXXXXXXXXXXX-720-124.jpg" /></p>

<p>收到临时授权码之后请按照步骤换取永久授权码，并将永久授权码存下来。</p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suitexxxxxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">" tmp_auth_code"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234456</span><span class="p">,</span><span class="w">
  </span><span class="nt">"AuthCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"adads"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>字段说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>EventType</td>
<td>tmp_auth_code</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>AuthCode</td>
<td>临时授权码</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h4 id="d-回调向isv推送授权变更消息">d:回调向ISV推送授权变更消息</h4>

<p>当授权方（即授权企业）在微应用管理端中，修改了对套件的授权托管后，钉钉服务器会向服务提供商的套件事件接收 URL（创建套件时填写）推送授权变更消息。注意，推送的授权变更信息并不包括企业用户具体做了什么修改，所以收到推送之后,</p>

<p><strong>ISV需要通过调用<a href="#10-获取企业的应用信息"><font color=red >获取企业的应用信息</font></a>接口</strong>，获取接口返回值其中的&quot;close&quot;参数，才能得知微应用在企业用户做了授权变更之后的状态，有三种状态码，分别为0，1，2.含义如下：</p>

<ul>
<li>0:禁用（例如企业用户在OA后台禁用了微应用）</li>
<li>1:正常 (例如企业用户在禁用之后又启用了微应用)</li>
<li>2:待激活 (企业已经进行了授权，但是ISV还未为企业激活应用)</li>
</ul>

<p>再根据具体状态做具体操作。比如状态为2，就需要ISV为企业进行激活授权套件的操作。</p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suitexxxxxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">" change_auth"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234456</span><span class="p">,</span><span class="w">
  </span><span class="nt">"AuthCorpId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxxx"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>字段说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>EventType</td>
<td>change_auth</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>AuthCorpID</td>
<td>授权方企业的corpid</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h4 id="e-quot-套件信息更新-quot-事件">e.&quot;套件信息更新&quot;事件</h4>

<p>此事件的推送会发生在更新套件信息的时候。</p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="s2">"check_update_suite_url"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Random"</span><span class="p">:</span><span class="s2">"Aedr5LMW"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TestSuiteKey"</span><span class="p">:</span><span class="s2">"suited6db0pze8yao1b1y"</span><span class="w">

</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>服务提供商在收到&quot;套件信息更新&quot;事件推送后务必返回经过加密后&quot;Random&quot;字段，比如对于右边的示例，需要返回的即是加密后的&quot;Aedr5LMW&quot;字符串。</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>Random</td>
<td>随机字符串</td>
</tr>
<tr>
<td>EventType</td>
<td>check_update_suite_url</td>
</tr>
<tr>
<td>TestSuiteKey</td>
<td>校验的SuiteKey(此处为套件的SuiteKey)</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密后&quot;Random&quot;字段的json数据，比如对于上面的示例，需要返回的即是加密后的&quot;Aedr5LMW&quot;字符串。</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;Random&quot;字段的加密字符串</td>
</tr>
</tbody></table>

<h3 id="6-获取套件访问token（suite_access_token）">6: 获取套件访问Token（suite_access_token）</h3>

<p>该API用于获取应用套件令牌（suite_access_token）</p>

<p>接口调用请求说明
https请求方式: POST
https://oapi.dingtalk.com/service/get_suite_token</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"suite_key"</span><span class="p">:</span><span class="s2">"key_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_ticket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ticket_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_key</td>
<td>应用套件的key</td>
</tr>
<tr>
<td>suite_secret</td>
<td>应用套件secret</td>
</tr>
<tr>
<td>suite_ticket</td>
<td>钉钉后台推送的ticket</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"suite_access_token"</span><span class="p">:</span><span class="s2">"61W3mEpU66027wgNZ_MhGHNQDHnFATkDa9-2llqrMBjUwxRSNPbVsMmyD-yq8wZETSoE5NQgecigDrSHkPtIYA"</span><span class="p">,</span><span class="w">  </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="mi">7200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_access_token</td>
<td>应用套件access_token</td>
</tr>
<tr>
<td>expires_in</td>
<td>有效期</td>
</tr>
</tbody></table>

<h3 id="7-获取企业的永久授权码">7: 获取企业的永久授权码</h3>

<p>该API用于使用临时授权码换取授权方的永久授权码，并换取授权信息、企业access_token。得到永久授权码之后请将永久授权码存储下来。</p>

<p>注：临时授权码使用一次后即失效</p>

<p>接口调用请求说明
https请求方式: POST
https://oapi.dingtalk.com/service/get_permanent_code?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"tmp_auth_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">" value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>tmp_auth_code</td>
<td>回调接口（tmp_auth_code）获取的临时授权码</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"auth_corp_info"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"corpid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxx"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"auth_user_info"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"userId"</span><span class="p">:</span><span class="s2">""</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>permanent_code</td>
<td>永久授权码</td>
</tr>
<tr>
<td>auth_corp_info</td>
<td>授权方企业信息</td>
</tr>
<tr>
<td>corpid</td>
<td>授权方企业id</td>
</tr>
<tr>
<td>corp_name</td>
<td>授权方企业名称</td>
</tr>
<tr>
<td>auth_user_info</td>
<td>授权方管理员信息</td>
</tr>
<tr>
<td>mobile</td>
<td>管理员电话</td>
</tr>
<tr>
<td>name</td>
<td>管理员名字</td>
</tr>
</tbody></table>

<h3 id="8-获取企业授权的access_token">8:获取企业授权的access_token</h3>

<p>服务提供商在取得企业的永久授权码并完成对企业应用的设置之后，便可以开始通过调用企业接口来运营这些应用。其中，调用企业接口所需的access_token获取方法如下。</p>

<p>接口调用请求说明</p>

<p>https请求方式: POST
https://oapi.dingtalk.com/service/get_corp_token?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"code_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，通过get_permanent_code获取</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">7200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>授权方（企业）access_token</td>
</tr>
<tr>
<td>expires_in</td>
<td>授权方（企业）access_token超时时间</td>
</tr>
</tbody></table>

<h3 id="9-获取企业授权的授权数据">9: 获取企业授权的授权数据</h3>

<p>该API用于通过永久授权码换取授权信息。 永久授权码的获取，是通过临时授权码使用get_permanent_code 接口获取到的permanent_code。</p>

<p>接口调用请求说明</p>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/get_auth_info?suite_access_token=xxxx</p>

<p>//注意，是suite_access_token，不是授权方（企业）的access_token</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="s2">"code_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_key"</span><span class="p">:</span><span class="s2">"key_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_key</td>
<td>应用套件key</td>
</tr>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，通过get_permanent_code获取</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"auth_corp_info"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"corp_logo_url"</span><span class="p">:</span><span class="s2">"http://xxxx.png"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="s2">"corpid"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"industry"</span><span class="p">:</span><span class="s2">"互联网"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"invite_code"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1001"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"auth_user_info"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"userId"</span><span class="p">:</span><span class="s2">""</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"auth_info"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"agent"</span><span class="p">:[{</span><span class="w">
            </span><span class="nt">"agent_name"</span><span class="p">:</span><span class="s2">"aaaa"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"appid"</span><span class="p">:</span><span class="mi">-3</span><span class="p">,</span><span class="w">
            </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="s2">"http://aaaaaa.com"</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="p">,{</span><span class="w">
            </span><span class="nt">"agent_name"</span><span class="p">:</span><span class="s2">"bbbb"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w">
            </span><span class="nt">"appid"</span><span class="p">:</span><span class="mi">-2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="s2">"http://vvvvvv.com"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
    </span><span class="p">},</span><span class="w">
          </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>auth_corp_info</td>
<td>授权方企业信息</td>
</tr>
<tr>
<td>corpid</td>
<td>授权方企业id</td>
</tr>
<tr>
<td>invite_code</td>
<td>表示邀请码，只有填写过且是ISV自己邀请码的数据才会返回,否则值为空字符串</td>
</tr>
<tr>
<td>industry</td>
<td>表示企业所属行业</td>
</tr>
<tr>
<td>corp_name</td>
<td>授权方企业名称</td>
</tr>
<tr>
<td>auth_user_info</td>
<td>授权方管理员信息</td>
</tr>
<tr>
<td>mobile</td>
<td>管理员电话</td>
</tr>
<tr>
<td>name</td>
<td>管理员名字</td>
</tr>
<tr>
<td>corp_logo_url</td>
<td>企业logo</td>
</tr>
<tr>
<td>auth_info</td>
<td>授权信息</td>
</tr>
<tr>
<td>agent</td>
<td>授权的应用信息</td>
</tr>
<tr>
<td>agentid</td>
<td>授权方应用id</td>
</tr>
<tr>
<td>agent_name</td>
<td>授权方应用名字</td>
</tr>
<tr>
<td>logo_url</td>
<td>授权方应用头像</td>
</tr>
<tr>
<td>appid</td>
<td>服务商套件中的对应应用id</td>
</tr>
</tbody></table>

<h3 id="10-获取企业的应用信息">10:获取企业的应用信息</h3>

<p>该API用于获取授权方的企业的某个应用的基本信息，包括LOGO,名称，描述等,信息接口调用请求说明</p>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/get_agent?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">   </span><span class="nt">"suite_key"</span><span class="p">:</span><span class="s2">"key_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="s2">"code_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">541</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_key</td>
<td>应用套件key</td>
</tr>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，从get_permanent_code接口中获取</td>
</tr>
<tr>
<td>agentid</td>
<td>授权方应用id</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">541</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"公告"</span><span class="p">,</span><span class="w">    
    </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="s2">"http://xxxxxxx/png"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"企业重要消息"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"close"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>agentid</td>
<td>授权方企业应用id</td>
</tr>
<tr>
<td>name</td>
<td>授权方企业应用名称</td>
</tr>
<tr>
<td>logo_url</td>
<td>授权方企业应用头像</td>
</tr>
<tr>
<td>description</td>
<td>授权方企业应用详情</td>
</tr>
<tr>
<td>close</td>
<td>授权方企业应用是否被禁用（0:禁用  1:正常  2:待激活 ）</td>
</tr>
</tbody></table>

<h3 id="11-激活授权套件">11:激活授权套件</h3>

<p>该API用于激活授权方企业的套件微应用,信息接口调用请求说明</p>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/activate_suite?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"suite_key"</span><span class="p">:</span><span class="s2">"key_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="s2">"permanent_code"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_key</td>
<td>应用套件key</td>
</tr>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，从get_permanent_code接口中获取</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="12-加解密方案">12: 加解密方案</h3>

<p>开启回调模式时，有以下术语需要了解：</p>

<ol>
<li><p>signature是签名，用于验证调用者的合法性。具体算法见以下&#39;消息体签名&#39;章节</p></li>
<li><p>EncodingAESKey：注册套件提供的数据加密密钥。用于消息体的加密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取，是AESKey的Base64编码。解码后即为32字节长的AESKey</p></li>
<li><p>AESKey=Base64_Decode(EncodingAESKey + “=”)，是AES算法的密钥，长度为32字节。AES采用CBC模式，数据采用PKCS#7填充；IV初始向量大小为16字节，取AESKey前16字节。具体详见：http://tools.ietf.org/html/rfc2315</p></li>
<li><p>msg为消息体明文，格式为JSON</p></li>
<li><p>钉钉服务器会把msg消息体明文编码成encrypt，encrypt = Base64_Encode(AES_Encrypt[random(16B) + msg_len(4B) + msg + $key])，是对明文消息msg加密处理后的Base64编码。其中random为16字节的随机字符串；msg_len为4字节的msg长度，网络字节序；msg为消息体明文；$key对于ISV开发来说，填写对应的suitekey，$key对于普通企业开发，填写企业的Corpid。
最终传给回调者的是encrypt，字段名为encrypt。</p></li>
</ol>

<h3 id="13-isv套件上架流程">13: ISV套件上架流程</h3>

<ul>
<li>云市场商品发布操作介绍文档：<a href="http://download.taobaocdn.com/freedom/31112/pdf/p1a5lce9b113k21o24lrv1kom4un5.pdf"><font color=red>下载</font></a></li>
</ul>

<p>云市场商品发布操作文档介绍了套件上架的流程。</p>

<ul>
<li>云市场ISV接入文档：<a href="http://download.taobaocdn.com/freedom/31112/pdf/p1a5lce9b01ron15tb3lm1pukcnh4.pdf"><font color=red>下载</font></a></li>
</ul>

<p>云市场ISV接入文档描述了第三方应用接入到阿里云市场所须实现的接口定义,服务商通过提供以下接口,即可获 得应用订购成功的信息,从而为购买者开通应用。</p>

<h3 id="消息体签名">消息体签名</h3>

<p>为了验证调用者的合法性，钉钉在回调url中增加了消息签名，以参数signature标识，企业需要验证此参数的正确性后再解密。</p>

<p>验证步骤：</p>

<ol>
<li><p>企业计算签名：dev_msg_signature=sha1(sort(token、timestamp、nonce、msg_encrypt))。sort的含义是将参数按照字母字典排序，然后从小到大拼接成一个字符串</p></li>
<li><p>比较dev_msg_signature和回调接口中推送的字段signature是否相等，相等则表示验证通过</p></li>
</ol>

<h5 id="加解密方案说明">加解密方案说明</h5>

<h6 id="对明文msg加密的过程如下：">对明文msg加密的过程如下：</h6>

<p>msg_encrypt = Base64_Encode( AES_Encrypt[random(16B) + msg_len(4B) + msg + $key] )
AES加密的buf由16个字节的随机字符串、4个字节的msg长度、明文msg和$key组成。其中msg_len为msg的字节数，网络字节序；</p>

<ul>
<li>$key对于ISV来说，填写对应的suitekey</li>
<li>$key对于普通企业开发，填写企业的Corpid</li>
</ul>

<h5 id="对应于加密方案，解密方案如下：">对应于加密方案，解密方案如下：</h5>

<ul>
<li>取出返回的JSON中的encrypt字段。</li>
<li>对密文BASE64解码：aes_msg=Base64_Decode(encrypt)</li>
<li>使用AESKey做AES解密：rand_msg=AES_Decrypt(aes_msg)</li>
<li>验证解密后$key、msg_len</li>
<li>去掉rand_msg头部的16个随机字节，4个字节的msg_len,和尾部的$CorpID即为最终的消息体原文msg</li>
</ul>

<h3 id="加解密库和demo下载">加解密库和demo下载</h3>

<h4 id="java库和demo">Java库和demo</h4>

<p>首先，您需要做以下准备工作</p>

<p>1.请开发者使用jdk1.6或以上版本，针对加解密包中使用的org.apache.commons.codec.binary.Base64，须导入jar包commons-codec-1.10(或comm ons-codec-1.9等其他版本)，在java-demo的WebContent/WEB_INF/lib目录中我们也提供了commons-codec-1.10.jar。</p>

<p>官方下载地址：<a href="http://commons.apache.org/proper/commons-codec/download_codec.cgi">http://commons.apache.org/proper/commons-codec/download_codec.cgi</a></p>

<p>2.异常java.security.InvalidKeyException:illegal Key Size和『计算解密文字错误』的解决方案：</p>

<p>在官方网站下载JCE无限制权限策略文件
JDK6的下载地址：<a href="http://www.oracle.com/technetwork/java/javase/downloads/jce-6-download-429243.html">http://www.oracle.com/technetwork/java/javase/downloads/jce-6-download-429243.html</a></p>

<p>JDK7的下载地址：<a href="http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html">http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html</a></p>

<p>下载后解压，可以看到local_policy.jar和US_export_policy.jar以及readme.txt。如果安装的是JRE，将两个jar文件放到%JRE_HOME% \lib\security目录下覆盖原来的文件，如果安装的是JDK，将两个jar文件放到%JDK_HOME%\jre\lib\security目录下覆盖原来文件。</p>

<p>库地址：<a href="https://github.com/injekt/openapi-demo-java/tree/master/src/com/alibaba/dingtalk/openapi/demo/utils/aes">https://github.com/injekt/openapi-demo-java/tree/master/src/com/alibaba/dingtalk/openapi/demo/utils/aes</a></p>

<p>demo地址：<a href="https://github.com/injekt/openapi-demo-java/blob/master/src/com/alibaba/dingtalk/openapi/servlet">https://github.com/injekt/openapi-demo-java/blob/master/src/com/alibaba/dingtalk/openapi/servlet</a></p>

<h4 id="php库和demo">php库和demo</h4>

<p>库地址：<a href="https://github.com/injekt/openapi-demo-php/tree/master/crypto">https://github.com/injekt/openapi-demo-php/tree/master/crypto</a></p>

<p>demo地址：<a href="https://github.com/injekt/openapi-demo-php/blob/master/receive.php">https://github.com/injekt/openapi-demo-php/blob/master/receive.php</a></p>

<h4 id="c-库和demo">C#库和demo</h4>

<p>库地址：<a href="https://github.com/ian-cuc/suite-demo-c-/tree/master/API">https://github.com/ian-cuc/suite-demo-c-/tree/master/API</a></p>

<p>demo地址：<a href="https://github.com/ian-cuc/suite-demo-c-/blob/master/receive.ashx.cs">https://github.com/ian-cuc/suite-demo-c-/blob/master/receive.ashx.cs</a></p>

<h3 id="调试工具">调试工具</h3>

<p>回调接口本地调试方案：由于回调接口需要在外网环境接收钉钉服务器的推送，假如开发者暂时没有外网地址，需要在本地调试回调接口的加解密方案，可以在本地环境构造推送。具体构造参数示例：</p>

<p>URL后面带的参数：signature=5a65ceeef9aab2d149439f82dc191dd6c5cbe2c0&amp;timestamp=1445827045067&amp;nonce=nEXhMP4r</p>

<p>Post参数：
<code class="prettyprint">
{&quot;encrypt&quot;:&quot;1a3NBxmCFwkCJvfoQ7WhJHB+iX3qHPsc9JbaDznE1i03peOk1LaOQoRz3+nlyGNhwmwJ3vDMG+OzrHMeiZI7gTRWVdUBmfxjZ8Ej23JVYa9VrYeJ5as7XM/ZpulX8NEQis44w53h1qAgnC3PRzM7Zc/D6Ibr0rgUathB6zRHP8PYrfgnNOS9PhSBdHlegK+AGGanfwjXuQ9+0pZcy0w9lQ==&quot;
}
</code>
Token：123456</p>

<p>数据加密密钥(ENCODING_AES_KEY)：4g5j64qlyl3zvetqxz5jiocdr586fn2zvjpa8zls3ij</p>

<p>suitekey：suite4xxxxxxxxxxxxxxx</p>

<p>ISV接入相关接口调试：<a href="https://debug.dingtalk.com/isv.html"><font color=red >ISV接入调试工具</font></a></p>

          <h1 id="免登服务">免登服务</h1>

<p>通过免登服务，在企业微应用的H5中，无需重复输入用户名和密码，可以通过身份认证获取当前使用钉钉的用户身份及相关信息。</p>

<p>具体流程为：</p>

<p>1.获取CODE(免登授权码)，获取CODE的方式有两种，一种是调用js-api接口（推荐），一种是使用标准OAUTH2.0 HTTP 302跳转的方式。</p>

<p>2.通过CODE换取用户身份。</p>

<p>通过CODE获取用户身份会有一定的时间开销。对于频繁获取用户身份的场景，建议采用如下方案：</p>

<ol>
<li>用户跳转到企业页面时，企业校验是否有代表用户身份的cookie，此cookie由企业生成</li>
<li>如果没有获取到cookie，调用免登服务，获取用户身份后，由企业生成代表用户身份的cookie</li>
<li>根据cookie获取用户身份，进入相应的页面</li>
</ol>

<h2 id="手机客户端调用免登">手机客户端调用免登</h2>

<h3 id="使用js-api-推荐使用">使用JS-API(推荐使用)</h3>

<p>步骤一：首先需要获取当前用户的corpid。ISV开发者请在微应用主页地址使用$CORPID$模板参数表示corpid，用户访问微应用的时候钉钉服务器将把$CORPID$替换成用户所属企业的corpid，例如原本的主页地址是http://www.dingtalk.com/index，则能获取用户corpid的主页地址为http://www.dingtalk.com/index?corpid=$CORPID$</p>

<p>步骤二：使用钉钉js-api提供的<a href="#获取免登授权码"><font color=red >获取免登授权码</font></a>接口获取CODE</p>

<p>步骤二：<a href="#通过code换取用户身份"><font color=red >通过CODE换取身份</font></a></p>

<p>demo地址:<a href="https://github.com/injekt/openapi-demo-php/blob/master/public/javascripts/demo.js"><font color=red >https://github.com/injekt/openapi-demo-php/blob/master/public/javascripts/demo.js</font></a></p>

<h3 id="使用标准oauth2-0">使用标准OAUTH2.0</h3>

<p><a href="#http://tools.ietf.org/html/rfc6749"><font color=red >什么是OAUTH2.0</font></a></p>

<p>步骤一：企业在后台构造一个连接，通过HTTP 302跳转方式，让用户访问钉钉开放平台授权网址，构造的地址如下:</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/connect/oauth2/authorize?appid=CORPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE</code></p>

<p>其中REDIRECT_URI为企业H5地址，钉钉开放平台授权服务器如果判断当前用户属于当前企业时，会再次通过HTTP 302跳转回企业应用的H5地址(即REDIRECT_URI)，并在H5的URL后面追加参数code=CODE&amp;state=STATE,即</p>

<p><code class="prettyprint">REDIRECT_URI?code=CODE&amp;state=abcd1234</code></p>

<p>步骤二：企业在后台解析code参数，获取CODE</p>

<p>步骤三：<a href="#通过code换取用户身份"><font color=red >通过CODE换取身份</font></a></p>

<aside class="notice">
有安全限制，REDIRECT_URI域名必须包含在企业所有的微应用域名内,否则会提示无权访问页面，微应用请到钉钉oa后台->选择微应用菜单->微应用中心，添加微应用
</aside>

<h2 id="钉钉pc版调用免登">钉钉PC版调用免登</h2>

<p>敬请期待</p>

<h2 id="微应用后台管理免登">微应用后台管理免登</h2>

<p>实现微应用后台管理系统与钉钉OA后台的免登</p>

<p>应用场景示例如下图：</p>

<p><img alt="normalcorp" src="https://img.alicdn.com/tps/TB1iw.4KFXXXXXoXFXXXXXXXXXX-594-302.png" /></p>

<p><strong>准备工作</strong>：</p>

<p>1: 配置微应用后台地址</p>

<p>普通企业在<a href="https://oa.dingtalk.com/#/microApp/microAppList"><font color=red>OA后台</font></a>添加微应用配置如左图，ISV在<a href="http://console.d.aliyun.com"><font color=red>开发者后台</font></a>添加微应用配置如下图</p>

<p><img alt="oaback" src="https://img.alicdn.com/tps/TB15zWTKFXXXXcEXVXXXXXXXXXX-642-367.jpg" /></p>

<p>2: 获取完成免登过程中验证身份的密钥（SSOSecret）</p>

<p><font color=red >重要说明：企业和ISV获取的方法一致，都是通过OA后台获取，ISV开发套件微应用的管理后台，使用自己企业的SSOSecret即可完成身份认证</font></p>

<p>在<a href="https://oa.dingtalk.com/#/microApp/microAppSet"><font color=red>OA后台</font></a>获取SSOSecret的方法如下：</p>

<p><img alt="normalcorp" src="https://img.alicdn.com/tps/TB1y_xcKVXXXXa6XXXXXXXXXXXX-1084-621.jpg" /></p>

<p><strong>使用方法（钉钉管理员登陆态）</strong> </p>

<p>步骤一：在OA后台，点击微应用的“进入后台”，自动跳转到准备工作1中配置的微应用后台地址，开发者从跳转的URL中解析code参数，获取CODE并保存下来</p>

<p>步骤二：通过<a href="#获取微应用后台管理Token"><font color=red >获取微应用后台管理Token</font></a>获取AccessToken</p>

<p>步骤三：使用AccessToken<a href="#通过code换取微应用管理员的身份信息"><font color=red >通过步骤一获取的CODE换取微应用管理员的身份信息</font></a></p>

<p><strong>更多用法</strong></p>

<p>在钉钉管理员非登陆态，使用钉钉管理后台的Oauth身份认证可以通过下面方法：</p>

<p>在管理员访问后台地址的时候，企业在后台构造一个连接，通过HTTP 302跳转方式，让用户访问钉钉开放平台授权网址，构造的地址如下:</p>

<p><code class="prettyprint">https://oa.dingtalk.com/omp/api/micro_app/admin/landing?corpid=CORPID&amp;redirect_url=REDIRECT_URL</code></p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpid</td>
<td>开发此微应用的公司corpid，ISV填写自己企业的CorpID</td>
</tr>
<tr>
<td>redirect_url</td>
<td>重定向地址(需要urlencode编码)</td>
</tr>
</tbody></table>

<p>REDIRECT_URL为微应用后台地址，首先跳转到钉钉OA管理后台登录页，登陆成功后，会再次通过HTTP 302跳转回微应用的后台地址(即REDIRECT_URL)，并在REDIRECT_URL后面追加参数code=CODE,即</p>

<p><code class="prettyprint">REDIRECT_URL?code=CODE</code></p>

<p>开发者从URL中解析code参数，获取CODE并保存下来，再按照上面使用方法中的步骤二和步骤三 获得管理员信息</p>

<p>demo查看:<a href="https://github.com/injekt/openapi-demo-java/tree/master/src/com/alibaba/dingtalk/openapi/servlet">https://github.com/injekt/openapi-demo-java/tree/master/src/com/alibaba/dingtalk/openapi/servlet</a></p>

          <h1 id="服务端开发文档">服务端开发文档</h1>

<p>欢迎您，钉钉的开发者，我们很期待你成为钉钉开放平台的开发者。</p>

<p>微应用是钉钉为连接企业办公打造的移动入口，通过微应用你可以将企业的业务审批，内部OA，CRM，协作，上下游沟通连接到钉钉，更简单和低成本实现企业移动化； 结合钉钉的基础通信能力，让企业应用更活跃，员工更高效，移动化成本更低。</p>

<p>此文档很适合于:</p>

<ol>
<li><p>企业的IT部，了解钉钉如何连接你所在企业的办公；</p></li>
<li><p>服务提供商（ISV），了解如何通过钉钉为您的客户提供定制的企业办公软件，提升你的服务价值。</p></li>
</ol>

<h2 id="建立连接">建立连接</h2>

<p>你可以使用以下两种方式，将钉钉微应用连接到你的企业应用：</p>

<ol>
<li><p>企业应用服务器调用钉钉开放平台提供的接口，以钉钉微应用的身份给企业用户的钉钉账号推送消息，以下称 <strong>主动调用模式</strong>。</p></li>
<li><p>钉钉用户在使用企业提供的微应用H5页面时，该页面可以调用钉钉提供的JS接口，使用钉钉开放的终端能力和业务能力，以下称 <strong>JSAPI模式</strong>。</p></li>
<li><p>钉钉服务器把用户发送的消息或用户触发的事件推送给企业应用，由企业应用处理，以下称 <strong>回调模式</strong>。</p></li>
</ol>

<h3 id="主动调用">主动调用</h3>

<p>当企业应用服务器调用钉钉开放平台接口时，需使用https协议、Json数据格式、UTF8编码，访问域名为 https://oapi.dingtalk.com。
在每次主动调用钉钉开放平台接口时需要带上AccessToken参数。AccessToken参数由CorpID和CorpSecret换取。对于ISV来说，<a href="#8-获取企业授权的access_token"><font color=red>获取企业授权的access_token</font></a></p>

<p>CorpID是企业在钉钉中的标识，每个企业拥有一个唯一的CorpID；</p>

<p>CorpSecret是企业每个应用的凭证密钥。</p>

<p>CorpID及CorpSecret可以在钉钉为企业提供的管理后台中找到，由钉钉自动分配。</p>

<aside class="notice">
POST请求请在HTTP Header中设置 Content-Type:application/json，否则接口调用失败
</aside>

<h3 id="主动调用的频率限制">主动调用的频率限制</h3>

<p>当你获取到AccessToken时，你的微应用后台就可以成功调用钉钉后台所提供的各种接口或访问相应企业的资源或给成员发消息。</p>

<p>为了防止微应用的程序错误而引发钉钉服务器负载异常，默认情况下，每个服务端调用接口都有一定的频率限制，当超过此限制时，调用对应接口会收到相应错误码。</p>

<p>以下是当前默认的频率限制，钉钉后台可能会根据运营情况调整此阈值：</p>

<ul>
<li><p>每个企业调用单个接口的频率不可超过1500次/分</p></li>
<li><p>每个ISV（应用提供商）调用单个接口的频率不可超过2000次/分</p></li>
<li><p>每个ISV（应用提供商）调用单个企业的单个接口频率不可超过1500次/分</p></li>
<li><p>每个套件调用单个企业的单个接口频率不可超过1000次/分</p></li>
</ul>

<h4 id="获取accesstoken">获取AccessToken</h4>

<p>AccessToken是企业访问钉钉开放平台接口的全局唯一票据，调用接口时需携带AccessToken。</p>

<p>AccessToken需要用CorpID和CorpSecret来换取，不同的CorpSecret会返回不同的AccessToken。正常情况下AccessToken有效期为7200秒，有效期内重复获取返回相同结果，并自动续期。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET
<code class="prettyprint">https://oapi.dingtalk.com/gettoken?corpid=id&amp;corpsecret=secrect</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpid</td>
<td>String</td>
<td>是</td>
<td>企业Id</td>
</tr>
<tr>
<td>corpsecret</td>
<td>String</td>
<td>是</td>
<td>企业应用的凭证密钥</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>a)正确的Json返回结果:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fw8ef8we8f76e6f7s8df8s"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>access_token</td>
<td>获取到的凭证</td>
</tr>
</tbody></table>

<p>b)错误的Json返回示例:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">43003</span><span class="p">,</span><span class="w">
   </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"require https"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h4 id="获取微应用后台管理token">获取微应用后台管理Token</h4>

<p>本接口获取的Token和上面获取的AccessToken应用场景不一样，此token只在<a href="#oa后台调用管理员免登"><font color=red>微应用后台管理免登</font></a>服务中使用。
应用场景示例如下图：</p>

<p><img alt="normalcorp" src="https://img.alicdn.com/tps/TB1iw.4KFXXXXXoXFXXXXXXXXXX-594-302.png" /></p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET
<code class="prettyprint">https://oapi.dingtalk.com/sso/gettoken?corpid=id&amp;corpsecret=ssosecret</code></p>

<p>企业在<a href="https://oa.dingtalk.com/#/microApp/microAppSet"><font color=red>OA后台</font></a>获取SSOSecret的方法如下</p>

<p><img alt="normalcorp" src="https://img.alicdn.com/tps/TB1y_xcKVXXXXa6XXXXXXXXXXXX-1084-621.jpg" /></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpid</td>
<td>String</td>
<td>是</td>
<td>企业Id</td>
</tr>
<tr>
<td>corpsecret</td>
<td>String</td>
<td>是</td>
<td>这里必须填写专属的SSOSecret</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>a)正确的Json返回结果:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fw8ef8we8f76e6f7s8df8s"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>access_token</td>
<td>获取到的凭证</td>
</tr>
</tbody></table>

<p>b)错误的Json返回示例:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">43003</span><span class="p">,</span><span class="w">
   </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"require https"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="管理通讯录">管理通讯录</h2>

<h3 id="获取部门列表">获取部门列表</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/list?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
           </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"钉钉事业部"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"autoAddUser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"服务端开发组"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
            </span><span class="s2">"autoAddUser"</span><span class="err">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>department</td>
<td>部门列表数据。以部门的order字段从小到大排列</td>
</tr>
<tr>
<td>id</td>
<td>部门id</td>
</tr>
<tr>
<td>name</td>
<td>部门名称</td>
</tr>
<tr>
<td>parentid</td>
<td>父部门id，根部门为1</td>
</tr>
<tr>
<td>createDeptGroup</td>
<td>是否同步创建一个关联此部门的企业群, true表示是, false表示不是</td>
</tr>
<tr>
<td>autoAddUser</td>
<td>当群已经创建后，是否有新人加入部门会自动加入该群, true表示是, false表示不是</td>
</tr>
</tbody></table>

<h3 id="获取部门详情">获取部门详情</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/get?access_token=ACCESS_TOKEN&amp;id=2</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>是</td>
<td>部门id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"钉钉事业部"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"order"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"autoAddUser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptHiding"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptPerimits"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"3|4"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"orgDeptOwner"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptManagerUseridList"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122|manager3211"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>id</td>
<td>部门id</td>
</tr>
<tr>
<td>name</td>
<td>部门名称</td>
</tr>
<tr>
<td>parentid</td>
<td>父部门id，根部门为1</td>
</tr>
<tr>
<td>order</td>
<td>在父部门中的次序值</td>
</tr>
<tr>
<td>createDeptGroup</td>
<td>是否同步创建一个关联此部门的企业群, true表示是, false表示不是</td>
</tr>
<tr>
<td>autoAddUser</td>
<td>当群已经创建后，是否有新人加入部门会自动加入该群, true表示是, false表示不是</td>
</tr>
<tr>
<td>deptHiding</td>
<td>是否隐藏部门, true表示隐藏, false表示显示</td>
</tr>
<tr>
<td>deptPerimits</td>
<td>可以查看指定隐藏部门的其他部门列表，如果部门隐藏，则此值生效，取值为其他的部门id组成的的字符串，使用&rsquo; &#124; &lsquo;符号进行分割</td>
</tr>
<tr>
<td>orgDeptOwner</td>
<td>企业群群主</td>
</tr>
<tr>
<td>deptManagerUseridList</td>
<td>部门的主管列表,取值为由主管的userid组成的字符串，不同的userid使用&rsquo; &#124; &#39;符号进行分割</td>
</tr>
</tbody></table>

<h3 id="创建部门">创建部门</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"钉钉事业部"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>部门名称。长度限制为1~64个字符</td>
</tr>
<tr>
<td>parentid</td>
<td>String</td>
<td>是</td>
<td>父部门id。根部门id为1</td>
</tr>
<tr>
<td>order</td>
<td>String</td>
<td>否</td>
<td>在父部门中的次序值。order值小的排序靠前</td>
</tr>
<tr>
<td>createDeptGroup</td>
<td>Boolean</td>
<td>否</td>
<td>是否创建一个关联此部门的企业群，默认为false</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>id</td>
<td>创建的部门id</td>
</tr>
</tbody></table>

<h3 id="更新部门">更新部门</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/update?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"钉钉事业部"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"autoAddUser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptManagerUseridList"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1111|2222"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptHiding"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptPerimits"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12|23"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"orgDeptOwner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1111"</span><span class="p">,</span><span class="w">   
</span><span class="err">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>string</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>否</td>
<td>部门名称。长度限制为1~64个字符</td>
</tr>
<tr>
<td>parentid</td>
<td>String</td>
<td>否</td>
<td>父部门id。根部门id为1</td>
</tr>
<tr>
<td>order</td>
<td>String</td>
<td>否</td>
<td>在父部门中的次序值。order值小的排序靠前</td>
</tr>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>部门id</td>
</tr>
<tr>
<td>createDeptGroup</td>
<td>Boolean</td>
<td>否</td>
<td>是否创建一个关联此部门的企业群</td>
</tr>
<tr>
<td>autoAddUser</td>
<td>Boolean</td>
<td>否</td>
<td>如果有新人加入部门是否会自动加入部门群</td>
</tr>
<tr>
<td>deptManagerUseridList</td>
<td>String</td>
<td>否</td>
<td>部门的主管列表,取值为由主管的userid组成的字符串，不同的userid使用&rsquo; &#124; &#39;符号进行分割</td>
</tr>
<tr>
<td>deptHiding</td>
<td>Boolean</td>
<td>否</td>
<td>是否隐藏部门</td>
</tr>
<tr>
<td>deptPerimits</td>
<td>String</td>
<td>否</td>
<td>可以查看指定隐藏部门的其他部门列表，如果部门隐藏，则此值生效，取值为其他的部门id组成的的字符串，使用&rsquo; &#124; &#39;符号进行分割</td>
</tr>
<tr>
<td>orgDeptOwner</td>
<td>String</td>
<td>否</td>
<td>企业群群主</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"updated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="删除部门">删除部门</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/delete?access_token=ACCESS_TOKEN&amp;id=ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>部门id。（注：不能删除根部门；不能删除含有子部门、成员的部门）</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取成员详情">获取成员详情</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/get?access_token=ACCESS_TOKEN&amp;userid=zhangsan</code></p>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工在企业内的UserID，企业用来唯一标识用户的字段。</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tel"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-123333"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"workPlace"</span><span class="w"> </span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"remark"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"mobile"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"13800000000"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dingding@aliyun.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"orderInDepts"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{1:10, 2:20}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isAdmin"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isBoss"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dingId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"WsUDaq7DCVIHc6z1GAsYDSA"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isLeaderInDepts"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{1:true, 2:false}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isHide"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
    </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"工程师"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dingtalk.com/abc.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"jobnumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"爱好"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"年龄"</span><span class="p">:</span><span class="s2">"24"</span><span class="w">
                </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userid</td>
<td>员工唯一标识ID（不可修改）</td>
</tr>
<tr>
<td>name</td>
<td>成员名称</td>
</tr>
<tr>
<td>tel</td>
<td>分机号（ISV不可见）</td>
</tr>
<tr>
<td>workPlace</td>
<td>办公地点（ISV不可见）</td>
</tr>
<tr>
<td>remark</td>
<td>备注（ISV不可见）</td>
</tr>
<tr>
<td>mobile</td>
<td>手机号码</td>
</tr>
<tr>
<td>email</td>
<td>电子邮箱</td>
</tr>
<tr>
<td>active</td>
<td>是否已经激活, true表示已激活, false表示未激活</td>
</tr>
<tr>
<td>orderInDepts</td>
<td>在对应的部门中的排序, Map结构的json字符串, key是部门的Id, value是人员在这个部门的排序值</td>
</tr>
<tr>
<td>isAdmin</td>
<td>是否为企业的管理员, true表示是, false表示不是</td>
</tr>
<tr>
<td>isBoss</td>
<td>是否为企业的老板, true表示是, false表示不是</td>
</tr>
<tr>
<td>dingId</td>
<td>钉钉Id</td>
</tr>
<tr>
<td>isLeaderInDepts</td>
<td>在对应的部门中是否为主管, Map结构的json字符串, key是部门的Id, value是人员在这个部门中是否为主管, true表示是, false表示不是</td>
</tr>
<tr>
<td>isHide</td>
<td>是否号码隐藏, true表示隐藏, false表示不隐藏</td>
</tr>
<tr>
<td>department</td>
<td>成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>职位信息</td>
</tr>
<tr>
<td>avatar</td>
<td>头像url</td>
</tr>
<tr>
<td>jobnumber</td>
<td>员工工号</td>
</tr>
<tr>
<td>extattr</td>
<td>扩展属性，可以设置多种属性(但手机上最多只能显示10个扩展属性，具体显示哪些属性，请到OA管理后台-&gt;设置-&gt;通讯录信息设置和OA管理后台-&gt;设置-&gt;手机端显示信息设置)性</td>
</tr>
</tbody></table>

<h3 id="创建成员">创建成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"orderInDepts"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{1:10, 2:20}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
    </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"产品经理"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15913215421"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tel"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-123333"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"workPlace"</span><span class="w"> </span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"remark"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan@gzdev.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"jobnumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"爱好"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"年龄"</span><span class="p">:</span><span class="s2">"24"</span><span class="w">
                </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>否</td>
<td>员工唯一标识ID（不可修改），企业内必须唯一。长度为1~64个字符，如果不传，服务器将自动生成一个userid</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>成员名称。长度为1~64个字符</td>
</tr>
<tr>
<td>orderInDepts</td>
<td>在对应的部门中的排序, Map结构的json字符串, key是部门的Id, value是人员在这个部门的排序值</td>
<td></td>
<td></td>
</tr>
<tr>
<td>department</td>
<td>List</td>
<td>是</td>
<td>数组类型，数组里面值为整型，成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>String</td>
<td>否</td>
<td>职位信息。长度为0~64个字符</td>
</tr>
<tr>
<td>mobile</td>
<td>String</td>
<td>是</td>
<td>手机号码。企业内必须唯一</td>
</tr>
<tr>
<td>tel</td>
<td>String</td>
<td>否</td>
<td>分机号，长度为0~50个字符</td>
</tr>
<tr>
<td>workPlace</td>
<td>String</td>
<td>否</td>
<td>办公地点，长度为0~50个字符</td>
</tr>
<tr>
<td>remark</td>
<td>String</td>
<td>否</td>
<td>备注，长度为0~1000个字符</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>否</td>
<td>邮箱。长度为0~64个字符。企业内必须唯一</td>
</tr>
<tr>
<td>jobnumber</td>
<td>String</td>
<td>否</td>
<td>员工工号。对应显示到OA后台和客户端个人资料的工号栏目。长度为0~64个字符</td>
</tr>
<tr>
<td>extattr</td>
<td>JSONObject</td>
<td>否</td>
<td>扩展属性，可以设置多种属性(但手机上最多只能显示10个扩展属性，具体显示哪些属性，请到OA管理后台-&gt;设置-&gt;通讯录信息设置和OA管理后台-&gt;设置-&gt;手机端显示信息设置)</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dedwefewfwe1231"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userid</td>
<td>员工唯一标识</td>
</tr>
</tbody></table>

<h3 id="更新成员">更新成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/update?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
    </span><span class="nt">"orderInDepts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{1:10}"</span><span class="p">,</span><span class="w"> 
    </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"产品经理"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15913215421"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tel"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-123333"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"workPlace"</span><span class="w"> </span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"remark"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan@gzdev.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"jobnumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"爱好"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"年龄"</span><span class="p">:</span><span class="s2">"24"</span><span class="w">
                </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明（如果非必须的字段未指定，则钉钉后台不改变该字段之前设置好的值）">参数说明（如果非必须的字段未指定，则钉钉后台不改变该字段之前设置好的值）</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工唯一标识ID（不可修改），企业内必须唯一。长度为1~64个字符</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>成员名称。长度为1~64个字符</td>
</tr>
<tr>
<td>department</td>
<td>List</td>
<td>否</td>
<td>成员所属部门id列表</td>
</tr>
<tr>
<td>orderInDepts</td>
<td>JSONObject</td>
<td>否</td>
<td>实际是Map的序列化字符串，Map的Key是deptId，表示部门id，Map的Value是order，表示排序的值，列表是按order的倒序排列输出的，即从大到小排列输出的</td>
</tr>
<tr>
<td>position</td>
<td>String</td>
<td>否</td>
<td>职位信息。长度为0~64个字符</td>
</tr>
<tr>
<td>mobile</td>
<td>String</td>
<td>否</td>
<td>手机号码。企业内必须唯一</td>
</tr>
<tr>
<td>tel</td>
<td>String</td>
<td>否</td>
<td>分机号，长度为0~50个字符</td>
</tr>
<tr>
<td>workPlace</td>
<td>String</td>
<td>否</td>
<td>办公地点，长度为0~50个字符</td>
</tr>
<tr>
<td>remark</td>
<td>String</td>
<td>否</td>
<td>备注，长度为0~1000个字符</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>否</td>
<td>邮箱。长度为0~64个字符。企业内必须唯一</td>
</tr>
<tr>
<td>jobnumber</td>
<td>String</td>
<td>否</td>
<td>员工工号，对应显示到OA后台和客户端个人资料的工号栏目。长度为0~64个字符</td>
</tr>
<tr>
<td>extattr</td>
<td>JSONObject</td>
<td>否</td>
<td>扩展属性，可以设置多种属性(但手机上最多只能显示10个扩展属性，具体显示哪些属性，请到OA管理后台-&gt;设置-&gt;通讯录信息设置和OA管理后台-&gt;设置-&gt;手机端显示信息设置)</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"updated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="删除成员">删除成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/delete?access_token=ACCESS_TOKEN&amp;userid=ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工唯一标识ID（不可修改）</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="批量删除成员">批量删除成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/batchdelete?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构">请求包结构</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"useridlist"</span><span class="p">:[</span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="s2">"lisi"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>useridlist</td>
<td>List</td>
<td>是</td>
<td>员工UserID列表。列表长度在1到20之间</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取部门成员">获取部门成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/simplelist?access_token=ACCESS_TOKEN&amp;department_id=1</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>department_id</td>
<td>long</td>
<td>是</td>
<td>获取的部门id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userlist</td>
<td>成员列表</td>
</tr>
<tr>
<td>userid</td>
<td>员工唯一标识ID（不可修改）</td>
</tr>
<tr>
<td>name</td>
<td>成员名称</td>
</tr>
<tr>
<td>active</td>
<td>表示该用户是否激活了钉钉</td>
</tr>
</tbody></table>

<h3 id="获取部门成员（详情）">获取部门成员（详情）</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/list?access_token=ACCESS_TOKEN&amp;department_id=1</code></p>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>department_id</td>
<td>long</td>
<td>是</td>
<td>获取的部门id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userlist"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"dingId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dwdded"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13122222222"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"tel"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-123333"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"workPlace"</span><span class="w"> </span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"remark"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"order"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"isAdmin"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"isBoss"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nt">"isHide"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"isLeader"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
            </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"工程师"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan@alibaba-inc.com"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"avatar"</span><span class="p">:</span><span class="w">  </span><span class="s2">"./dingtalk/abc.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"jobnumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">,</span><span class="w"> 
            </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"爱好"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"年龄"</span><span class="p">:</span><span class="s2">"24"</span><span class="w">
                </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userlist</td>
<td>成员列表</td>
</tr>
<tr>
<td>userid</td>
<td>员工唯一标识ID（不可修改）</td>
</tr>
<tr>
<td>order</td>
<td>表示人员在此部门中的排序，列表是按order的倒序排列输出的，即从大到小排列输出的</td>
</tr>
<tr>
<td>dingId</td>
<td>钉钉ID</td>
</tr>
<tr>
<td>mobile</td>
<td>手机号（ISV不可见）</td>
</tr>
<tr>
<td>tel</td>
<td>分机号（ISV不可见）</td>
</tr>
<tr>
<td>workPlace</td>
<td>办公地点（ISV不可见）</td>
</tr>
<tr>
<td>remark</td>
<td>备注（ISV不可见）</td>
</tr>
<tr>
<td>isAdmin</td>
<td>是否是企业的管理员, true表示是, false表示不是</td>
</tr>
<tr>
<td>isBoss</td>
<td>是否为企业的老板, true表示是, false表示不是</td>
</tr>
<tr>
<td>isHide</td>
<td>是否隐藏号码, true表示是, false表示不是</td>
</tr>
<tr>
<td>isLeader</td>
<td>是否是部门的主管, true表示是, false表示不是</td>
</tr>
<tr>
<td>name</td>
<td>成员名称</td>
</tr>
<tr>
<td>active</td>
<td>表示该用户是否激活了钉钉</td>
</tr>
<tr>
<td>department</td>
<td>成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>职位信息</td>
</tr>
<tr>
<td>email</td>
<td>邮箱</td>
</tr>
<tr>
<td>avatar</td>
<td>头像url</td>
</tr>
<tr>
<td>jobnumber</td>
<td>员工工号</td>
</tr>
<tr>
<td>extattr</td>
<td>扩展属性，可以设置多种属性(但手机上最多只能显示10个扩展属性，具体显示哪些属性，请到OA管理后台-&gt;设置-&gt;通讯录信息设置和OA管理后台-&gt;设置-&gt;手机端显示信息设置)</td>
</tr>
</tbody></table>

<!--
"mobile": "15913215421",
mobile | 手机号码
-->

<h2 id="管理微应用">管理微应用</h2>

<h3 id="创建微应用">创建微应用</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/microapp/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"appIcon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@HIdsabikkhjsdsas"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"appName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试微应用"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"appDesc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试使用的微应用"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"homepageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://oa.dingtalk.com/?h5"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"pcHomepageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://oa.dingtalk.com/?pc"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ompLink"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>appIcon</td>
<td>String</td>
<td>是</td>
<td>微应用的图标。需要调用上传接口将图标上传到钉钉服务器后获取到的mediaId</td>
</tr>
<tr>
<td>appName</td>
<td>String</td>
<td>是</td>
<td>微应用的名称。长度限制为1~10个字符</td>
</tr>
<tr>
<td>appDesc</td>
<td>String</td>
<td>是</td>
<td>微应用的描述。长度限制为1~20个字符</td>
</tr>
<tr>
<td>homepageUrl</td>
<td>String</td>
<td>是</td>
<td>微应用的移动端主页，必须以http开头或https开头</td>
</tr>
<tr>
<td>pcHomepageUrl</td>
<td>String</td>
<td>否</td>
<td>微应用的PC端主页，必须以http开头或https开头，如果不为空则必须与homepageUrl的域名一致</td>
</tr>
<tr>
<td>ompUrl</td>
<td>String</td>
<td>否</td>
<td>微应用的OA后台管理主页，必须以http开头或https开头</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>id</td>
<td>创建的部门id</td>
</tr>
</tbody></table>

<h2 id="群会话接口（暂未开放）">群会话接口（暂未开放）</h2>

<h3 id="创建会话">创建会话</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"群名称"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"useridlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="s2">"lisi"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>群名称。长度限制为1~20个字符</td>
</tr>
<tr>
<td>owner</td>
<td>String</td>
<td>是</td>
<td>群主userId，员工唯一标识ID；必须为该会话useridlist的成员之一</td>
</tr>
<tr>
<td>useridlist</td>
<td>String[]</td>
<td>是</td>
<td>群成员列表，每次最多操作40人，群人数上限为1000</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxxxxxxxxxxxx"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>chatid</td>
<td>群会话的标识ID</td>
</tr>
</tbody></table>

<h3 id="修改会话">修改会话</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/update?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxxxxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"群名称"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"add_useridlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"lisi"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"del_useridlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"wangwu"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>否</td>
<td>群名称。长度限制为1~20个字符，不传则不修改</td>
</tr>
<tr>
<td>owner</td>
<td>String</td>
<td>否</td>
<td>群主userId，员工唯一标识ID；必须为该会话成员之一；不传则不修改</td>
</tr>
<tr>
<td>add_useridlist</td>
<td>String[]</td>
<td>否</td>
<td>添加成员列表，每次最多操作40人，群人数上限为1000</td>
</tr>
<tr>
<td>del_useridlist</td>
<td>String[]</td>
<td>否</td>
<td>删除成员列表，每次最多操作40人，群人数上限为1000</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取会话">获取会话</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/get?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"chat_info"</span><span class="p">:</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"群名称"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"useridlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="s2">"lisi"</span><span class="p">],</span><span class="w">
            </span><span class="nt">"agentidlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"12345"</span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>chat_info</td>
<td>群会话信息</td>
</tr>
<tr>
<td>name</td>
<td>群名称</td>
</tr>
<tr>
<td>owner</td>
<td>群主userid</td>
</tr>
<tr>
<td>useridlist</td>
<td>群成员userId列表</td>
</tr>
<tr>
<td>agentidlist</td>
<td>群绑定的微应用agentId列表</td>
</tr>
</tbody></table>

<h3 id="绑定微应用和群会话">绑定微应用和群会话</h3>

<p>此接口仅限ISV接入使用</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/bind?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>agentid</td>
<td>String</td>
<td>是</td>
<td>微应用agentId，每个群最多绑定5个微应用，一个群只能被一个ISV套件绑定一次</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="解绑微应用和群会话">解绑微应用和群会话</h3>

<p>此接口仅限ISV接入使用</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/unbind?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>agentid</td>
<td>String</td>
<td>是</td>
<td>微应用agentId</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="发送消息到群会话">发送消息到群会话</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/send?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h4 id="消息类型及数据格式">消息类型及数据格式</h4>

<h5 id="text消息">text消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三的请假申请"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：text</td>
</tr>
</tbody></table>

<h6 id="text消息体格式">text消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text.content</td>
<td>String</td>
<td>是</td>
<td>消息内容</td>
</tr>
</tbody></table>

<h5 id="image消息">image消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：image</td>
</tr>
</tbody></table>

<h6 id="image消息体格式">image消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>image.media_id</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取。建议宽600像素 x 400像素，宽高比3：2</td>
</tr>
</tbody></table>

<h5 id="voice消息">voice消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"voice"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"voice"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：voice</td>
</tr>
</tbody></table>

<h6 id="voice消息体格式">voice消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>voice.media_id</td>
<td>String</td>
<td>是</td>
<td>语音媒体文件id，可以调用上传媒体文件接口获取。2MB，播放长度不超过60s，AMR格式</td>
</tr>
</tbody></table>

<h5 id="file消息">file消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"file"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：file</td>
</tr>
</tbody></table>

<h6 id="file消息体格式">file消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>file.media_id</td>
<td>String</td>
<td>是</td>
<td>媒体文件id，可以调用上传媒体文件接口获取。10MB</td>
</tr>
</tbody></table>

<h5 id="link消息">link消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="w">
        </span><span class="s2">"picUrl"</span><span class="err">:</span><span class="s2">"@lALOACZwe2Rk"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"messageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s.dingtalk.com/market/dingtalk/error_code.php"</span><span class="p">,</span><span class="w">
    </span><span class="err">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：link</td>
</tr>
</tbody></table>

<h6 id="link消息体格式">link消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>link.title</td>
<td>String</td>
<td>是</td>
<td>消息标题</td>
</tr>
<tr>
<td>link.text</td>
<td>String</td>
<td>是</td>
<td>消息描述</td>
</tr>
<tr>
<td>link.pic_url</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取</td>
</tr>
<tr>
<td>link.message_url</td>
<td>String</td>
<td>是</td>
<td>消息点击链接地址</td>
</tr>
</tbody></table>

<h5 id="oa消息">OA消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
     </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"oa"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"oa"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"message_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.dingtalk.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"pc_message_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://oa.dingtalk.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"head"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"bgcolor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FFBBBBBB"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"头部标题"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"正文标题"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"form"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"姓名:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"年龄:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"身高:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.8米"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"体重:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"130斤"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"学历:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"本科"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"爱好:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"打球、听音乐"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nt">"rich"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"num"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15.6"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"元"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@lADOADmaWMzazQKA"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"file_count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"李四 "</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：oa</td>
</tr>
</tbody></table>

<h6 id="oa消息体格式">OA消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>oa.message_url</td>
<td>String</td>
<td>是</td>
<td>客户端点击消息时跳转到的H5地址</td>
</tr>
<tr>
<td>oa.pc_message_url</td>
<td>String</td>
<td>否</td>
<td>PC端点击消息时跳转到的URL地址</td>
</tr>
<tr>
<td>oa.head</td>
<td>String</td>
<td>是</td>
<td>消息头部内容</td>
</tr>
<tr>
<td>oa.head.bgcolor</td>
<td>String</td>
<td>是</td>
<td>消息头部的背景颜色。长度限制为8个英文字符，其中前2为表示透明度，后6位表示颜色值。不要添加0x</td>
</tr>
<tr>
<td>oa.head.text</td>
<td>String</td>
<td>是</td>
<td>消息的头部标题</td>
</tr>
<tr>
<td>oa.body</td>
<td>Array[JSON Object]</td>
<td>是</td>
<td>消息体</td>
</tr>
<tr>
<td>oa.body.title</td>
<td>String</td>
<td>否</td>
<td>消息体的标题</td>
</tr>
<tr>
<td>oa.body.form</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>消息体的表单，最多显示6个，超过会被隐藏</td>
</tr>
<tr>
<td>oa.body.form.key</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字</td>
</tr>
<tr>
<td>oa.body.form.value</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字对应的值</td>
</tr>
<tr>
<td>oa.body.rich</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>单行富文本信息</td>
</tr>
<tr>
<td>oa.body.rich.num</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的数目</td>
</tr>
<tr>
<td>oa.body.rich.unit</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的单位</td>
</tr>
<tr>
<td>oa.body.content</td>
<td>String</td>
<td>否</td>
<td>消息体的内容，最多显示3行</td>
</tr>
<tr>
<td>oa.body.image</td>
<td>String</td>
<td>否</td>
<td>消息体中的图片media_id</td>
</tr>
<tr>
<td>oa.body.file_count</td>
<td>String</td>
<td>否</td>
<td>自定义的附件数目。此数字仅供显示，钉钉不作验证</td>
</tr>
<tr>
<td>oa.body.author</td>
<td>String</td>
<td>否</td>
<td>自定义的作者名字</td>
</tr>
</tbody></table>

<h4 id="oa消息截图">OA消息截图</h4>

<p><img alt="oames" src="https://img.alicdn.com/tps/TB1gVcFIFXXXXcGXXXXXXXXXXXX.jpg" /></p>

<h2 id="通讯录变更事件回调接口">通讯录变更事件回调接口</h2>

<p>在使用回调接口之前您需要了解的是，</p>

<p>首先您需要准备好，</p>

<ul>
<li><p>URL:<a href="#注册事件回调接口"><font color=red>注册事件回调接口</font></a>填写的接收推送的地址</p></li>
<li><p>Token:<a href="#注册事件回调接口"><font color=red>注册事件回调接口</font></a>中任意填写的，用来生成signature，用来和回调参数中的signature比对，校验消息的合法性</p></li>
<li><p>数据加密密钥(ENCODING_AES_KEY):<a href="#注册事件回调接口"><font color=red>注册事件回调接口</font></a>中填写的数据加密密钥。用于回调数据的加解密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取,您可以随机生成。</p></li>
</ul>

<p>钉钉服务器会向回调url推送事件变更。</p>

<p>假设您提供的回调URL是</p>

<p><code class="prettyprint">https://127.0.0.1/suite/receive</code></p>

<p>那么在钉钉服务器每一次访问回调URL的时候
将请求(下面链接中的signature,timestamp,nonce的值只是示例，并不代表真实返回的值):</p>

<p><code class="prettyprint">https://127.0.0.1/suite/receive?signature=111108bb8e6dbce3c9671d6fdb69d15066227608
&amp;timestamp=1783610513&amp;nonce=380320111</code></p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>回调数据的格式如右所示：</p>

<p>其中的encrypt字段是经过加密的消息体，encrypt经过一系列解密步骤后，才能产生下面所说的“POST数据解密后示例”，服务提供商可以直接使用钉钉提供的库进行解密的处理。</p>

<p>除此之外，在接收到推送之后，<strong>需要返回字符串success（代表了你收到了推送），返回的数据也需要做加密处理</strong>，如果不返回，钉钉服务器将持续推送下去，达到一定阈值后将不再推送。</p>

<p>&ldquo;Talk is cheap, show me the code.&quot;所以我们也为开发者提供了加解密的demo，目前提供Java/PHP等语言版本。
加解密库和demo的下载：<a href="#加解密库和demo下载"><font color=red >加解密库和demo下载</font></a></p>

<p>如有需要，可以查看具体加解密步骤：<a href="#12-加解密方案"><font color=red >查看</font></a></p>

<h3 id="事件回调">事件回调</h3>

<p>当企业通讯录发生变化，并且事件类型包含在注册时填写的&quot;call_back_tag&quot;中时，比如call_back_tag字段为&rdquo;[&ldquo;user_add_org&rdquo;,&ldquo;user_modify_org&rdquo;]&ldquo;，那么企业通讯录发生了&quot;通讯录用户增加&quot;和&quot;讯录用户更改&quot;，钉钉服务器会向url推送事件。</p>

<p>目前可以监听的事件类型分别为:</p>

<ul>
<li>user_add_org : 通讯录用户增加</li>
<li>user_modify_org : 通讯录用户更改</li>
<li>user_leave_org : 通讯录用户离职</li>
</ul>

<p>POST数据解密后示例
接收到推送之后请务必返回经过加密的字符串&quot;success&quot;的json数据</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">43535463645</span><span class="p">,</span><span class="w">
    </span><span class="nt">"UserId"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"efefef"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"CorpId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"corpid"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>EventType</td>
<td>事件类型，有三种，&quot;user_add_org&rdquo;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>UserId</td>
<td>发生变更的userid列表</td>
</tr>
<tr>
<td>CorpId</td>
<td>发生通讯录变更的企业</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> 
 </span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&ldquo;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h3 id="注册事件回调接口">注册事件回调接口</h3>

<p>注册回调接口的时候，钉钉服务器会回调<a href="#测试回调url"><font color=red>测试回调url</font></a>，来验证填写的url的合法性，需要您再接收到回调之后返回加密字符串&quot;success&quot;的json数据,才能完成注册。</p>

<p><img src="https://img.alicdn.com/tps/TB10MOOJFXXXXbdXpXXXXXXXXXX-373-351.png" width = "373" height = "351" alt="图片名称" align=center /></p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/register_call_back?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"call_back_tag"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_modify_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_leave_org"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"aes_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="s2">"www.dingtalk.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>call_back_tag</td>
<td>Array[String]</td>
<td>是</td>
<td>需要监听的事件类型，有三种，&quot;user_add_org&rdquo;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;</td>
</tr>
<tr>
<td>token</td>
<td>String</td>
<td>是</td>
<td>加解密需要用到的token，ISV(服务提供商)推荐使用注册套件时填写的token，普通企业可以随机填写</td>
</tr>
<tr>
<td>aes_key</td>
<td>String</td>
<td>是</td>
<td>数据加密密钥。用于回调数据的加密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取,您可以随机生成，ISV(服务提供商)推荐使用注册套件时填写的EncodingAESKey</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>是</td>
<td>接收事件回调的url</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="查询事件回调接口">查询事件回调接口</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: get</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/get_call_back?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">   
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"call_back_tag"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_modify_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_leave_org"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"aes_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="s2">"www.dingtalk.com"</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>access_token</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>call_back_tag</td>
<td>需要监听的事件类型，有三种，&quot;user_add_org&quot;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;</td>
</tr>
<tr>
<td>token</td>
<td>加解密需要用到的token，ISV(服务提供商)推荐使用注册套件时填写的token，普通企业可以随机填写</td>
</tr>
<tr>
<td>aes_key</td>
<td>数据加密密钥。用于回调数据的加密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取,您可以随机生成，ISV(服务提供商)推荐使用注册套件时填写的EncodingAESKey</td>
</tr>
<tr>
<td>url</td>
<td>接收事件回调的url</td>
</tr>
</tbody></table>

<h3 id="更新事件回调接口">更新事件回调接口</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/update_call_back?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"call_back_tag"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_modify_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_leave_org"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"aes_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11111111lvdhntotr3x9qhlbytb18zyz5z111111111"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"www.dingtalk.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>call_back_tag</td>
<td>Array[String]</td>
<td>是</td>
<td>需要监听的事件类型，有三种，&quot;user_add_org&quot;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;</td>
</tr>
<tr>
<td>token</td>
<td>String</td>
<td>是</td>
<td>加解密需要用到的token，ISV(服务提供商)推荐使用注册套件时填写的token，普通企业可以随机填写</td>
</tr>
<tr>
<td>aes_key</td>
<td>String</td>
<td>是</td>
<td>数据加密密钥。用于回调数据的加密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取,您可以随机生成，ISV(服务提供商)推荐使用注册套件时填写的EncodingAESKey</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>是</td>
<td>接收事件回调的url</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="删除事件回调接口">删除事件回调接口</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: get</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/delete_call_back?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取回调失败的结果">获取回调失败的结果</h3>

<p>钉钉服务器给回调接口推送 通讯录变更事件的时候，有可能因为各种原因推送失败(比如网络异常)，此时钉钉服务器将保留此次变更事件。</p>

<p>用户可以通过此回调接口获取推送失败的变更事件。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: get</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/get_call_back_failed_result?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="nt">"failed_list"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"event_time"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">32112412</span><span class="p">,</span><span class="w">
            </span><span class="nt">"call_back_tag"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"userid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">""</span><span class="p">,</span><span class="s2">""</span><span class="p">],</span><span class="w">
            </span><span class="nt">"corpid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"event_time"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">24431231</span><span class="p">,</span><span class="w">
            </span><span class="nt">"call_back_tag"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"userid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">""</span><span class="p">,</span><span class="s2">""</span><span class="p">],</span><span class="w">
            </span><span class="nt">"corpid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>has_more</td>
<td>是否还有推送失败的变更事件，若为true,则表示还有未回调的事件</td>
</tr>
<tr>
<td>failed_list</td>
<td>事件列表，一次最多200个</td>
</tr>
<tr>
<td>event_time</td>
<td>事件的时间戳</td>
</tr>
<tr>
<td>call_back_tag</td>
<td>事件类型，有三种，&quot;user_add_org&quot;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;</td>
</tr>
<tr>
<td>userid</td>
<td>相关员工列表</td>
</tr>
<tr>
<td>corpid</td>
<td>相关企业id</td>
</tr>
</tbody></table>

<h3 id="测试回调url">测试回调url</h3>

<p>在您注册事件回调接口的时候，钉钉服务器会向您”注册回调接口“时候上传的url(接收回调的url)推送一条消息，用来测试url的合法性。</p>

<p>收到消息需要返回经过加密后的字符串&quot;success&quot;的json数据，否则钉钉服务器将认为url不合法，从而不予推送。</p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"EventType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"check_url"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>EventType</td>
<td>&ldquo;check_url&rdquo;</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> 
  </span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&ldquo;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h2 id="发送普通会话消息">发送普通会话消息</h2>

<p>员工可以在微应用中把消息发送到同企业的人或群。</p>

<p>调用接口时，使用Https协议、JSON数据包格式。</p>

<p>目前支持文本、图片、语音、普通文件、OA消息以及link等消息类型，每个消息都由消息头和消息体组成，普通会话的消息头由sender,cid组成。消息体请参见以下各种<a href="#消息类型及数据格式"><font color=red >消息类型</font></a>。</p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>消息发送者员工ID</td>
</tr>
<tr>
<td>cid</td>
<td>String</td>
<td>是</td>
<td>群消息或者个人聊天会话Id，(通过<a href="#获取会话信息"><font color=red>JSAPI之pickConversation接口</font></a>唤起联系人界面拿到会话ID）</td>
</tr>
</tbody></table>

<p>普通会话消息样例：</p>

<p><img alt="msg1" src="https://img.alicdn.com/tps/TB1FVMvIFXXXXcnXXXXXXXXXXXX.jpg" /></p>

<h3 id="发送普通会话消息接口说明">发送普通会话消息接口说明</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/message/send_to_conversation?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>如果是群，返回跟发送者同一家企业的一组工号；如果是个人聊天，只返回发送者同一家企业的一个工号；不在同一家企业，发送失败</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"receiver"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UserID1|UserID2"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="发送企业会话消息">发送企业会话消息</h2>

<p>企业可以主动发消息给员工，消息量不受限制。</p>

<p>发送企业会话消息和发送普通会话消息的不同之处在于发送消息的主体不同
- 普通会话消息发送主体是普通员工，体现在接收方手机上的联系人是消息发送员工</p>

<ul>
<li>企业会话消息发送主体是企业，体现在接收方手机上的联系人是你填写的agentid对应的微应用</li>
</ul>

<p>调用接口时，使用Https协议、JSON数据包格式。</p>

<p>目前支持text、image、voice、file、link、OA消息类型。每个消息都由消息头和消息体组成，企业会话的消息头由touser,toparty,agentid组成。消息体请参见以下各种<a href="#消息类型及数据格式"><font color=red >消息类型</font></a>。</p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>touser</td>
<td>String</td>
<td>否</td>
<td>员工ID列表（消息接收者，多个接收者用&rsquo; &#124; &#39;分隔）。特殊情况：指定为@all，则向该企业应用的全部成员发送</td>
</tr>
<tr>
<td>toparty</td>
<td>String</td>
<td>否</td>
<td>部门id列表，多个接收者用&rsquo; &#124; &#39;分隔。当touser为@all时忽略本参数 <font color=red >touser或者toparty 二者有一个必填</font></td>
</tr>
<tr>
<td>agentid</td>
<td>String</td>
<td>是</td>
<td>企业应用id，这个值代表以哪个应用的名义发送消息</td>
</tr>
</tbody></table>

<p>企业会话消息样例：</p>

<p><img alt="msg2" src="https://img.alicdn.com/tps/TB1PAQwIFXXXXXOXXXXXXXXXXXX.jpg" /></p>

<h3 id="发送企业消息接口说明">发送企业消息接口说明</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/message/send?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>如果收件人、部门或标签不存在，发送仍然执行，但返回无效的部分。</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"invaliduser"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UserID1|UserID2"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"invalidparty"</span><span class="p">:</span><span class="s2">"PartyID1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="消息类型及数据格式">消息类型及数据格式</h2>

<h3 id="text消息">text消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三的请假申请"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：text</td>
</tr>
<tr>
<td>content</td>
<td>String</td>
<td>是</td>
<td>消息内容</td>
</tr>
</tbody></table>

<h3 id="image消息">image消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：image</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取。建议宽600像素 x 400像素，宽高比3：2</td>
</tr>
</tbody></table>

<h3 id="voice消息">voice消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"voice"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"voice"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：voice</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>语音媒体文件id，可以调用上传媒体文件接口获取。2MB，播放长度不超过60s，AMR格式</td>
</tr>
</tbody></table>

<h3 id="file消息">file消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"file"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：file</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>媒体文件id，可以调用上传媒体文件接口获取。10MB</td>
</tr>
</tbody></table>

<h3 id="link消息">link消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"messageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s.dingtalk.com/market/dingtalk/error_code.php"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"picUrl"</span><span class="p">:</span><span class="s2">"@lALOACZwe2Rk"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：link</td>
</tr>
</tbody></table>

<h5 id="link消息体格式">link消息体格式</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>link.messageUrl</td>
<td>String</td>
<td>是</td>
<td>消息点击链接地址</td>
</tr>
<tr>
<td>link.picUrl</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取</td>
</tr>
<tr>
<td>link.title</td>
<td>String</td>
<td>是</td>
<td>消息标题</td>
</tr>
<tr>
<td>link.text</td>
<td>String</td>
<td>是</td>
<td>消息描述</td>
</tr>
</tbody></table>

<h3 id="oa消息">OA消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
     </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"oa"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"oa"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"message_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dingtalk.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"head"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"bgcolor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FFBBBBBB"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"头部标题"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"正文标题"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"form"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"姓名:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"年龄:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"身高:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.8米"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"体重:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"130斤"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"学历:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"本科"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"爱好:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"打球、听音乐"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nt">"rich"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"num"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15.6"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"元"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@lADOADmaWMzazQKA"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"file_count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"李四 "</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：oa</td>
</tr>
</tbody></table>

<h4 id="oa消息体内容">OA消息体内容</h4>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>oa.message_url</td>
<td>String</td>
<td>是</td>
<td>客户端点击消息时跳转到的H5地址</td>
</tr>
<tr>
<td>oa.head</td>
<td>String</td>
<td>是</td>
<td>消息头部内容</td>
</tr>
<tr>
<td>oa.head.bgcolor</td>
<td>String</td>
<td>是</td>
<td>消息头部的背景颜色。长度限制为8个英文字符，其中前2为表示透明度，后6位表示颜色值。不要添加0x</td>
</tr>
<tr>
<td>oa.head.text</td>
<td>String</td>
<td>是</td>
<td>消息的头部标题</td>
</tr>
<tr>
<td>oa.body</td>
<td>Array[JSON Object]</td>
<td>是</td>
<td>消息体</td>
</tr>
<tr>
<td>oa.body.title</td>
<td>String</td>
<td>否</td>
<td>消息体的标题</td>
</tr>
<tr>
<td>oa.body.form</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>消息体的表单，最多显示6个，超过会被隐藏</td>
</tr>
<tr>
<td>oa.body.form.key</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字</td>
</tr>
<tr>
<td>oa.body.form.value</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字对应的值</td>
</tr>
<tr>
<td>oa.body.rich</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>单行富文本信息</td>
</tr>
<tr>
<td>oa.body.rich.num</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的数目</td>
</tr>
<tr>
<td>oa.body.rich.unit</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的单位</td>
</tr>
<tr>
<td>oa.body.content</td>
<td>String</td>
<td>否</td>
<td>消息体的内容，最多显示3行</td>
</tr>
<tr>
<td>oa.body.image</td>
<td>String</td>
<td>否</td>
<td>消息体中的图片media_id</td>
</tr>
<tr>
<td>oa.body.file_count</td>
<td>String</td>
<td>否</td>
<td>自定义的附件数目。此数字仅供显示，钉钉不作验证</td>
</tr>
<tr>
<td>oa.body.author</td>
<td>String</td>
<td>否</td>
<td>自定义的作者名字</td>
</tr>
</tbody></table>

<h4 id="oa消息截图">OA消息截图</h4>

<p><img alt="oames" src="https://img.alicdn.com/tps/TB1gVcFIFXXXXcGXXXXXXXXXXXX.jpg" /></p>

<h2 id="管理多媒体文件">管理多媒体文件</h2>

<p>企业在使用接口时，对多媒体文件、多媒体消息的获取和调用等操作，是通过media_id来进行的。通过本接口，企业可以上传或下载多媒体文件。</p>

<h3 id="上传媒体文件">上传媒体文件</h3>

<p>用于上传图片、语音等媒体资源文件以及普通文件（如doc，ppt），接口返回媒体资源标识ID：media_id。请注意，media_id是可复用的，同一个media_id可用于消息的多次发送。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/media/upload?access_token=ACCESS_TOKEN&amp;type=TYPE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>是</td>
<td>媒体文件类型，分别有图片（image）、语音（voice）、普通文件(file)</td>
</tr>
<tr>
<td>media</td>
<td>String</td>
<td>是</td>
<td>form-data中媒体文件标识，有filename、filelength、content-type等信息</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@dsa8d87y7c8d8c"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>type</td>
<td>媒体文件类型，分别有图片（image）、语音（voice）、普通文件(file)</td>
</tr>
<tr>
<td>media_id</td>
<td>媒体文件上传后获取的唯一标识</td>
</tr>
<tr>
<td>created_at</td>
<td>媒体文件上传时间戳</td>
</tr>
</tbody></table>

<h6 id="上传的媒体文件限制">上传的媒体文件限制</h6>

<ul>
<li>图片（image）:1MB，支持JPG格式</li>
<li>语音（voice）：2MB，播放长度不超过60s，AMR格式</li>
<li>普通文件（file）：10MB</li>
</ul>

<h3 id="获取媒体文件">获取媒体文件</h3>

<p>通过media_id获取图片、语音等文件。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/media/get?access_token=ACCESS_TOKEN&amp;media_id=MEDIA_ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>媒体文件的唯一标示</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>和普通的http下载相同，请根据http头做相应的处理。</p>
<pre class="highlight plaintext"><code>  HTTP/1.1 200: OK
  Connection: close
  Content-Type: image/jpeg
  Content-disposition: attachment; filename="MEDIA_ID.jpg"
  Date: Sun, 04 Jan 2015 12:00:00 GMT
  Cache-Control: no-cache, must-revalidate
  Content-Length: 1234567
  ...
</code></pre>

<p>a)正确时返回：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40004</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid media_id"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>b)错误时返回（这里省略了HTTP首部）：</p>

<h2 id="免登">免登</h2>

<p>免登接口是关于用户无需输入用户名＋密码就可以实现登录，通过权限认证后获取用户身份的接口。</p>

<p>详细信息请查看<a href="#免登服务"><font color=red >免登服务流程</font></a></p>

<h3 id="通过code换取用户身份">通过CODE换取用户身份</h3>

<p>企业应用的服务器在拿到CODE后，需要将CODE发送到钉钉开放平台接口，如果验证通过，则返回CODE对应的用户信息。<strong>此接口只用于免登服务中用来换取用户信息</strong></p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/getuserinfo?access_token=ACCESS_TOKEN&amp;code=CODE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>code</td>
<td>String</td>
<td>是</td>
<td>通过Oauth认证会给URL带上CODE</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>

<p>正确时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40029</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid code"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USERID"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deviceId"</span><span class="p">:</span><span class="s2">"DEVICEID"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_sys"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sys_level"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="err">|</span><span class="mi">1</span><span class="err">|</span><span class="mi">2</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>userid</td>
<td>员工在企业内的UserID</td>
</tr>
<tr>
<td>deviceId</td>
<td>手机设备号,由钉钉在安装时随机产生</td>
</tr>
<tr>
<td>is_sys</td>
<td>是否是管理员</td>
</tr>
<tr>
<td>sys_level</td>
<td>级别，三种取值。0:非管理员 1：普通管理员 2：超级管理员</td>
</tr>
</tbody></table>

<p>出错时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40029</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid code"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="通过code换取微应用管理员的身份信息">通过CODE换取微应用管理员的身份信息</h3>

<p>企业应用的服务器在拿到CODE后，需要将CODE发送到钉钉开放平台接口，如果验证通过，则返回CODE对应的管理员信息。<strong>此接口只用于微应用后台管理员免登中用来换取管理员信息</strong></p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/sso/getuserinfo?access_token=ACCESS_TOKEN&amp;code=CODE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>再次强调，此token不同于一般的accesstoken，需要调用<a href="#获取管理员免登token"><font color=red >获取微应用管理员免登需要的AccessToken</font></a></td>
</tr>
<tr>
<td>code</td>
<td>String</td>
<td>是</td>
<td>通过Oauth认证给URL带上的CODE</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>

<p>正确时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"corp_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"一家公司"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"corpid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dingxxxxxx"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_sys"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://xxxxxxx.jpg"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456@aliyun.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"名称"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0571"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corp_name</td>
<td>公司名字</td>
</tr>
<tr>
<td>corpid</td>
<td>公司corpid</td>
</tr>
<tr>
<td>is_sys</td>
<td>是否是管理员（在这里是true）</td>
</tr>
<tr>
<td>avatar</td>
<td>头像地址</td>
</tr>
<tr>
<td>email</td>
<td>email地址&rdquo;,</td>
</tr>
<tr>
<td>name</td>
<td>用户名字,</td>
</tr>
<tr>
<td>userid</td>
<td>员工在企业内的UserID</td>
</tr>
</tbody></table>

<p>出错时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40029</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid code"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<!-- ### 通过CODE换取用户身份

企业应用的服务器在拿到CODE后，需要将CODE发送到钉钉开放平台接口，如果验证通过，则返回CODE对应的用户信息。

###### 请求说明

Https请求方式: GET

`https://oapi.dingtalk.com/user/getuserinfo?access_token=ACCESS_TOKEN&code=CODE`

###### 参数说明

参数 | 参数类型 | 必须 | 说明
---------- | ------- | ------- | ------
access_token | String | 是 | 调用接口凭证
code | String | 是 | 通过Oauth认证会给URL带上CODE

###### 返回结果

正确时返回示例如下：

```
{
    "errcode": 40029,
    "errmsg": "invalid code",
    "userid": "USERID",
    "deviceId":"DEVICEID"
}
```

参数 | 说明
---------- | ------
userId | 员工在企业内的UserID
deviceId | 手机设备号,由钉钉在安装时随机产生

出错时返回示例如下：

```
{
    "errcode": 40029,
    "errmsg": "invalid code"
}
``` -->

<h2 id="统计数据">统计数据</h2>

<h3 id="记录统计数据">记录统计数据</h3>

<p>用户在使用微应用的时候，企业可以通过这个接口记录微应用使用的相关信息，比如调用时间，结束时间等等。钉钉的数据分析工具会对这些数据进行汇总，提供给开发者。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式：POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/data/record?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>startTimeMs</td>
<td>String</td>
<td>是</td>
<td>事件发生时间，单位为距离1970的毫秒数</td>
</tr>
<tr>
<td>endTimeMs</td>
<td>String</td>
<td>是</td>
<td>事件结束时间（瞬间结束的，该值和发生事件一致）</td>
</tr>
<tr>
<td>module</td>
<td>String</td>
<td>否</td>
<td>微应用提供区分内部模块的标记</td>
</tr>
<tr>
<td>originId</td>
<td>String</td>
<td>否</td>
<td>微应用中该记录的主键索引</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工在企业内的UserID，企业用来唯一标识用户的字段</td>
</tr>
<tr>
<td>agentId</td>
<td>String</td>
<td>是</td>
<td>授权方应用id</td>
</tr>
<tr>
<td>extension</td>
<td>JSONObject</td>
<td>否</td>
<td>扩展字段，json格式</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h2 id="js接口api">JS接口API</h2>

<h3 id="获取jsapi_ticket">获取jsapi_ticket</h3>

<p>企业在使用微应用中的JS API时，需要先从钉钉开放平台接口获取jsapi_ticket生成签名数据，并将最终签名用的部分字段及签名结果返回到H5中，JS API底层将通过这些数据判断H5是否有权限使用JS API。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式：GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/get_jsapi_ticket?access_token=ACCESS_TOKE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>是</td>
<td>这里是固定值，jsapi</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>

<p>正确时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ticket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dsf8sdf87sd7f87sd8v8ds0vs09dvu09sd8vy87dsv87"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">7200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>ticket</td>
<td>用于JS API的临时票据</td>
</tr>
<tr>
<td>expires_in</td>
<td>票据过期时间</td>
</tr>
</tbody></table>

<p>出错时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">45009</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"接口调用超过限制"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="js-sdk">JS-SDK</h3>

<p>JS-SDK 为H5页面提供了一系列原生UI控件或者服务的JS接口，文档地址如下：</p>

<p><a href="#客户端开发文档"><font color=red >客户端开发文档</font></a></p>

<h2 id="附录">附录</h2>

<h3 id="全局返回码说明">全局返回码说明</h3>

<p>开发者每次调用接口时，可能获得正确或错误的返回码，企业可以根据返回码信息调试接口，排查错误。</p>

<h6 id="全局返回码说明如下：">全局返回码说明如下：</h6>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>-1</td>
<td>系统繁忙</td>
</tr>
<tr>
<td>0</td>
<td>请求成功</td>
</tr>
<tr>
<td>40001</td>
<td>获取access_token时Secret错误，或者access_token无效</td>
</tr>
<tr>
<td>40002</td>
<td>不合法的凭证类型</td>
</tr>
<tr>
<td>40003</td>
<td>不合法的UserID</td>
</tr>
<tr>
<td>40004</td>
<td>不合法的媒体文件类型</td>
</tr>
<tr>
<td>40005</td>
<td>不合法的文件类型</td>
</tr>
<tr>
<td>40006</td>
<td>不合法的文件大小</td>
</tr>
<tr>
<td>40007</td>
<td>不合法的媒体文件id</td>
</tr>
<tr>
<td>40008</td>
<td>不合法的消息类型</td>
</tr>
<tr>
<td>40009</td>
<td>不合法的部门id</td>
</tr>
<tr>
<td>40010</td>
<td>不合法的父部门id</td>
</tr>
<tr>
<td>40011</td>
<td>不合法的排序order</td>
</tr>
<tr>
<td>40012</td>
<td>不合法的发送者</td>
</tr>
<tr>
<td>40013</td>
<td>不合法的corpid</td>
</tr>
<tr>
<td>40014</td>
<td>不合法的access_token</td>
</tr>
<tr>
<td>40015</td>
<td>发送者不在会话中</td>
</tr>
<tr>
<td>40016</td>
<td>不合法的会话ID</td>
</tr>
<tr>
<td>40017</td>
<td>在会话中没有找到与发送者在同一企业的人</td>
</tr>
<tr>
<td>40018</td>
<td>不允许以递归方式查询部门用户列表</td>
</tr>
<tr>
<td>40019</td>
<td>该手机号码对应的用户最多可以加入5个非认证企业</td>
</tr>
<tr>
<td>40020</td>
<td>当前团队人数已经达到上限,用电脑登录钉钉企业管理后台，升级成为认证企业</td>
</tr>
<tr>
<td>40021</td>
<td>更换的号码已注册过钉钉，无法使用该号码</td>
</tr>
<tr>
<td>40022</td>
<td>企业中的手机号码和登陆钉钉的手机号码不一致,暂时不支持修改用户信息,可以删除后重新添加</td>
</tr>
<tr>
<td>60107</td>
<td>使用该手机登录钉钉的用户已经在企业中</td>
</tr>
<tr>
<td>40029</td>
<td>不合法的oauth_code</td>
</tr>
<tr>
<td>40031</td>
<td>不合法的UserID列表</td>
</tr>
<tr>
<td>40032</td>
<td>不合法的UserID列表长度</td>
</tr>
<tr>
<td>40033</td>
<td>不合法的请求字符，不能包含\uxxxx格式的字符</td>
</tr>
<tr>
<td>40035</td>
<td>不合法的参数</td>
</tr>
<tr>
<td>40038</td>
<td>不合法的请求格式</td>
</tr>
<tr>
<td>40039</td>
<td>不合法的URL长度</td>
</tr>
<tr>
<td>40048</td>
<td>url中包含不合法domain</td>
</tr>
<tr>
<td>40055</td>
<td>不合法的agent结构</td>
</tr>
<tr>
<td>40056</td>
<td>不合法的agentid</td>
</tr>
<tr>
<td>40057</td>
<td>不合法的callbackurl</td>
</tr>
<tr>
<td>40061</td>
<td>设置应用头像失败</td>
</tr>
<tr>
<td>40062</td>
<td>不合法的应用模式</td>
</tr>
<tr>
<td>40063</td>
<td>不合法的分机号</td>
</tr>
<tr>
<td>40064</td>
<td>不合法的工作地址</td>
</tr>
<tr>
<td>40065</td>
<td>不合法的备注</td>
</tr>
<tr>
<td>40066</td>
<td>不合法的部门列表</td>
</tr>
<tr>
<td>40067</td>
<td>标题长度不合法</td>
</tr>
<tr>
<td>40073</td>
<td>不存在的openid</td>
</tr>
<tr>
<td>40077</td>
<td>不存在的预授权码</td>
</tr>
<tr>
<td>40078</td>
<td>不存在的临时授权码</td>
</tr>
<tr>
<td>40079</td>
<td>不存在的授权信息</td>
</tr>
<tr>
<td>40080</td>
<td>不合法的suitesecret</td>
</tr>
<tr>
<td>40082</td>
<td>不合法的suitetoken</td>
</tr>
<tr>
<td>40083</td>
<td>不合法的suitekey</td>
</tr>
<tr>
<td>40084</td>
<td>不合法的永久授权码</td>
</tr>
<tr>
<td>40085</td>
<td>不存在的suiteticket</td>
</tr>
<tr>
<td>40086</td>
<td>不合法的第三方应用appid</td>
</tr>
<tr>
<td>40087</td>
<td>创建永久授权码失败</td>
</tr>
<tr>
<td>40088</td>
<td>不合法的套件key或secret</td>
</tr>
<tr>
<td>40089</td>
<td>不合法的corpid或corpsecret</td>
</tr>
<tr>
<td>40090</td>
<td>套件已经不存在</td>
</tr>
<tr>
<td>41001</td>
<td>缺少access_token参数</td>
</tr>
<tr>
<td>41002</td>
<td>缺少corpid参数</td>
</tr>
<tr>
<td>41003</td>
<td>缺少refresh_token参数</td>
</tr>
<tr>
<td>41004</td>
<td>缺少secret参数</td>
</tr>
<tr>
<td>41005</td>
<td>缺少多媒体文件数据</td>
</tr>
<tr>
<td>41006</td>
<td>缺少media_id参数</td>
</tr>
<tr>
<td>41007</td>
<td>无效的ssocode</td>
</tr>
<tr>
<td>41008</td>
<td>缺少oauth</td>
</tr>
<tr>
<td>41009</td>
<td>缺少UserID</td>
</tr>
<tr>
<td>41010</td>
<td>缺少url</td>
</tr>
<tr>
<td>41011</td>
<td>缺少agentid</td>
</tr>
<tr>
<td>41012</td>
<td>缺少应用头像mediaid</td>
</tr>
<tr>
<td>41013</td>
<td>缺少应用名字</td>
</tr>
<tr>
<td>41014</td>
<td>缺少应用描述</td>
</tr>
<tr>
<td>41015</td>
<td>缺少Content</td>
</tr>
<tr>
<td>41016</td>
<td>缺少标题</td>
</tr>
<tr>
<td>41021</td>
<td>缺少suitekey</td>
</tr>
<tr>
<td>41022</td>
<td>缺少suitetoken</td>
</tr>
<tr>
<td>41023</td>
<td>缺少suiteticket</td>
</tr>
<tr>
<td>41024</td>
<td>缺少suitesecret</td>
</tr>
<tr>
<td>41025</td>
<td>缺少permanent_code（永久授权码）</td>
</tr>
<tr>
<td>41026</td>
<td>缺少tmp_auth_code（临时授权码）</td>
</tr>
<tr>
<td>41027</td>
<td>需要授权企业的corpid参数</td>
</tr>
<tr>
<td>41030</td>
<td>企业未对该套件授权</td>
</tr>
<tr>
<td>41031</td>
<td>auth_corpid和permanent_code不匹配</td>
</tr>
<tr>
<td>41100</td>
<td>时间参数不合法</td>
</tr>
<tr>
<td>41101</td>
<td>数据内容过长</td>
</tr>
<tr>
<td>41102</td>
<td>参数值过大</td>
</tr>
<tr>
<td>42001</td>
<td>access_token超时</td>
</tr>
<tr>
<td>42002</td>
<td>refresh_token超时</td>
</tr>
<tr>
<td>42003</td>
<td>oauth_code超时</td>
</tr>
<tr>
<td>42007</td>
<td>预授权码失效</td>
</tr>
<tr>
<td>42008</td>
<td>临时授权码失效</td>
</tr>
<tr>
<td>42009</td>
<td>suitetoken失效</td>
</tr>
<tr>
<td>43001</td>
<td>需要GET请求</td>
</tr>
<tr>
<td>43002</td>
<td>需要POST请求</td>
</tr>
<tr>
<td>43003</td>
<td>需要HTTPS</td>
</tr>
<tr>
<td>43004</td>
<td>无效的HTTP HEADER Content-Type</td>
</tr>
<tr>
<td>43005</td>
<td>需要Content-Type为application/json;charset=UTF-8</td>
</tr>
<tr>
<td>43007</td>
<td>需要授权</td>
</tr>
<tr>
<td>43008</td>
<td>参数需要multipart类型</td>
</tr>
<tr>
<td>43009</td>
<td>post参数需要json类型</td>
</tr>
<tr>
<td>43010</td>
<td>需要处于回调模式</td>
</tr>
<tr>
<td>43011</td>
<td>需要企业授权</td>
</tr>
<tr>
<td>44001</td>
<td>多媒体文件为空</td>
</tr>
<tr>
<td>44002</td>
<td>POST的数据包为空</td>
</tr>
<tr>
<td>44003</td>
<td>图文消息内容为空</td>
</tr>
<tr>
<td>44004</td>
<td>文本消息内容为空</td>
</tr>
<tr>
<td>45001</td>
<td>多媒体文件大小超过限制</td>
</tr>
<tr>
<td>45002</td>
<td>消息内容超过限制</td>
</tr>
<tr>
<td>45003</td>
<td>标题字段超过限制</td>
</tr>
<tr>
<td>45004</td>
<td>描述字段超过限制</td>
</tr>
<tr>
<td>45005</td>
<td>链接字段超过限制</td>
</tr>
<tr>
<td>45006</td>
<td>图片链接字段超过限制</td>
</tr>
<tr>
<td>45007</td>
<td>语音播放时间超过限制</td>
</tr>
<tr>
<td>45008</td>
<td>图文消息超过限制</td>
</tr>
<tr>
<td>45009</td>
<td>接口调用超过限制</td>
</tr>
<tr>
<td>45016</td>
<td>系统分组，不允许修改</td>
</tr>
<tr>
<td>45017</td>
<td>分组名字过长</td>
</tr>
<tr>
<td>45018</td>
<td>分组数量超过上限</td>
</tr>
<tr>
<td>45024</td>
<td>账号数量超过上限</td>
</tr>
<tr>
<td>46001</td>
<td>不存在媒体数据</td>
</tr>
<tr>
<td>46004</td>
<td>不存在的员工</td>
</tr>
<tr>
<td>47001</td>
<td>解析JSON/XML内容错误</td>
</tr>
<tr>
<td>48002</td>
<td>Api禁用</td>
</tr>
<tr>
<td>48003</td>
<td>suitetoken无效</td>
</tr>
<tr>
<td>48004</td>
<td>授权关系无效</td>
</tr>
<tr>
<td>49000</td>
<td>缺少chatid</td>
</tr>
<tr>
<td>49001</td>
<td>绑定的微应用超过个数限制</td>
</tr>
<tr>
<td>49002</td>
<td>一个群只能被一个ISV套件绑定一次</td>
</tr>
<tr>
<td>49003</td>
<td>操作者必须为群主</td>
</tr>
<tr>
<td>49004</td>
<td>添加成员列表和删除成员列表不能有交集</td>
</tr>
<tr>
<td>49005</td>
<td>群人数超过人数限制</td>
</tr>
<tr>
<td>49006</td>
<td>群成员列表必须包含群主</td>
</tr>
<tr>
<td>50001</td>
<td>redirect_uri未授权</td>
</tr>
<tr>
<td>50002</td>
<td>员工不在权限范围</td>
</tr>
<tr>
<td>50003</td>
<td>应用已停用</td>
</tr>
<tr>
<td>50005</td>
<td>企业已禁用</td>
</tr>
<tr>
<td>51000</td>
<td>跳转的域名未授权</td>
</tr>
<tr>
<td>51001</td>
<td>跳转的corpid未授权</td>
</tr>
<tr>
<td>51002</td>
<td>跳转请求不是来自钉钉客户端</td>
</tr>
<tr>
<td>51003</td>
<td>跳转找不到用户信息</td>
</tr>
<tr>
<td>51004</td>
<td>跳转找不到用户的企业信息</td>
</tr>
<tr>
<td>51005</td>
<td>跳转用户不是企业管理员</td>
</tr>
<tr>
<td>51006</td>
<td>跳转生成code失败</td>
</tr>
<tr>
<td>51007</td>
<td>跳转获取用户企业身份失败</td>
</tr>
<tr>
<td>51008</td>
<td>跳转url解码失败</td>
</tr>
<tr>
<td>51009</td>
<td>要跳转的地址不是标准url</td>
</tr>
<tr>
<td>52010</td>
<td>无效的corpid</td>
</tr>
<tr>
<td>52011</td>
<td>jsapi ticket 读取失败</td>
</tr>
<tr>
<td>52012</td>
<td>jsapi 签名生成失败</td>
</tr>
<tr>
<td>52013</td>
<td>签名校验失败</td>
</tr>
<tr>
<td>52014</td>
<td>无效的url参数</td>
</tr>
<tr>
<td>52015</td>
<td>无效的随机字符串参数</td>
</tr>
<tr>
<td>52016</td>
<td>无效的签名参数</td>
</tr>
<tr>
<td>52017</td>
<td>无效的jsapi列表参数</td>
</tr>
<tr>
<td>52018</td>
<td>无效的时间戳</td>
</tr>
<tr>
<td>52019</td>
<td>无效的agentid</td>
</tr>
<tr>
<td>60001</td>
<td>不合法的部门名称</td>
</tr>
<tr>
<td>60002</td>
<td>部门层级深度超过限制</td>
</tr>
<tr>
<td>60003</td>
<td>部门不存在</td>
</tr>
<tr>
<td>60004</td>
<td>父亲部门不存在</td>
</tr>
<tr>
<td>60005</td>
<td>不允许删除有成员的部门</td>
</tr>
<tr>
<td>60006</td>
<td>不允许删除有子部门的部门</td>
</tr>
<tr>
<td>60007</td>
<td>不允许删除根部门</td>
</tr>
<tr>
<td>60008</td>
<td>父部门下该部门名称已存在</td>
</tr>
<tr>
<td>60009</td>
<td>部门名称含有非法字符</td>
</tr>
<tr>
<td>60010</td>
<td>部门存在循环关系</td>
</tr>
<tr>
<td>60011</td>
<td>管理员权限不足，（user/department/agent）无权限</td>
</tr>
<tr>
<td>60012</td>
<td>不允许删除默认应用</td>
</tr>
<tr>
<td>60013</td>
<td>不允许关闭应用</td>
</tr>
<tr>
<td>60014</td>
<td>不允许开启应用</td>
</tr>
<tr>
<td>60015</td>
<td>不允许修改默认应用可见范围</td>
</tr>
<tr>
<td>60016</td>
<td>部门id已经存在</td>
</tr>
<tr>
<td>60017</td>
<td>不允许设置企业</td>
</tr>
<tr>
<td>60018</td>
<td>不允许更新根部门</td>
</tr>
<tr>
<td>60019</td>
<td>从部门查询人员失败</td>
</tr>
<tr>
<td>60020</td>
<td>访问ip不在白名单之中</td>
</tr>
<tr>
<td>60102</td>
<td>UserID在公司中已存在</td>
</tr>
<tr>
<td>60103</td>
<td>手机号码不合法</td>
</tr>
<tr>
<td>60104</td>
<td>手机号码在公司中已存在</td>
</tr>
<tr>
<td>60105</td>
<td>邮箱不合法</td>
</tr>
<tr>
<td>60106</td>
<td>邮箱已存在</td>
</tr>
<tr>
<td>60110</td>
<td>部门个数超出限制</td>
</tr>
<tr>
<td>60111</td>
<td>UserID不存在</td>
</tr>
<tr>
<td>60112</td>
<td>用户name不合法</td>
</tr>
<tr>
<td>60113</td>
<td>身份认证信息（手机/邮箱）不能同时为空</td>
</tr>
<tr>
<td>60114</td>
<td>性别不合法</td>
</tr>
<tr>
<td>60118</td>
<td>用户无有效邀请字段（邮箱，手机号）</td>
</tr>
<tr>
<td>60119</td>
<td>不合法的position</td>
</tr>
<tr>
<td>60120</td>
<td>用户已禁用</td>
</tr>
<tr>
<td>60121</td>
<td>找不到该用户</td>
</tr>
<tr>
<td>60122</td>
<td>不合法的extattr</td>
</tr>
<tr>
<td>60123</td>
<td>不合法的jobnumber</td>
</tr>
<tr>
<td>70001</td>
<td>企业不存在或者已经被解散</td>
</tr>
<tr>
<td>70002</td>
<td>获取套件下的微应用失败</td>
</tr>
<tr>
<td>70003</td>
<td>agentid对应微应用不存在</td>
</tr>
<tr>
<td>70004</td>
<td>企业下没有对应该agentid的微应用</td>
</tr>
<tr>
<td>70005</td>
<td>ISV激活套件失败</td>
</tr>
<tr>
<td>71006</td>
<td>回调地址已经存在</td>
</tr>
<tr>
<td>71007</td>
<td>回调地址已不存在</td>
</tr>
<tr>
<td>71008</td>
<td>回调call_back_tag必须在指定的call_back_tag列表中</td>
</tr>
<tr>
<td>71009</td>
<td>返回文本非success</td>
</tr>
<tr>
<td>71010</td>
<td>POST的JSON数据不包含所需要的参数字段或包含的参数格式非法</td>
</tr>
<tr>
<td>71011</td>
<td>传入的url参数不是合法的url格式</td>
</tr>
<tr>
<td>71012</td>
<td>url地址访问异常,错误原因为:%s</td>
</tr>
<tr>
<td>71013</td>
<td>此域名或IP不能注册或者接收回调事件</td>
</tr>
<tr>
<td>80001</td>
<td>可信域名没有IPC备案，后续将不能在该域名下正常使用jssdk</td>
</tr>
<tr>
<td>90001</td>
<td>您的服务器调用钉钉开放平台所有接口的请求都被暂时禁用了</td>
</tr>
<tr>
<td>90002</td>
<td>您的服务器调用钉钉开放平台当前接口的所有请求都被暂时禁用了</td>
</tr>
<tr>
<td>90003</td>
<td>您的企业调用钉钉开放平台所有接口的请求都被暂时禁用了,仅对企业自己的Accesstoken有效</td>
</tr>
<tr>
<td>90004</td>
<td>您当前使用的CorpId及CorpSecret被暂时禁用了,仅对企业自己的Accesstoken有效</td>
</tr>
<tr>
<td>90005</td>
<td>您的企业调用当前接口次数过多,请求被暂时禁用了,仅对企业自己的Accesstoken有效</td>
</tr>
<tr>
<td>90006</td>
<td>您当前使用的CorpId及CorpSecret调用当前接口次数过多,请求被暂时禁用了,仅对企业自己的Accesstoken有效</td>
</tr>
<tr>
<td>90007</td>
<td>您当前要调用的企业的接口次数过多,对该企业的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90008</td>
<td>您当前要调用的企业的当前接口次数过多,对此企业下该接口的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90009</td>
<td>您调用企业接口超过了限制,对所有企业的所有接口的请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90010</td>
<td>您调用企业当前接口超过了限制,对所有企业的该接口的请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90011</td>
<td>您的套件调用企业接口超过了限制,该套件的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90012</td>
<td>您的套件调用企业当前接口超过了限制,该套件对此接口的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90013</td>
<td>您的套件调用当前企业的接口超过了限制,该套件对此企业的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90014</td>
<td>您的套件调用企业当前接口超过了限制,该套件对此企业该接口的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>900001</td>
<td>加密明文文本非法</td>
</tr>
<tr>
<td>900002</td>
<td>加密时间戳参数非法</td>
</tr>
<tr>
<td>900003</td>
<td>加密随机字符串参数非法</td>
</tr>
<tr>
<td>900004</td>
<td>不合法的aeskey</td>
</tr>
<tr>
<td>900005</td>
<td>签名不匹配</td>
</tr>
<tr>
<td>900006</td>
<td>计算签名错误</td>
</tr>
<tr>
<td>900007</td>
<td>计算加密文字错误</td>
</tr>
<tr>
<td>900008</td>
<td>计算解密文字错误</td>
</tr>
<tr>
<td>900009</td>
<td>计算解密文字长度不匹配</td>
</tr>
<tr>
<td>900010</td>
<td>计算解密文字suitekey或者corpid不匹配</td>
</tr>
</tbody></table>

<h2 id="demo">Demo</h2>

<p>提供了使用Java、PHP、Nodejs 接入钉钉开放平台API的代码示例，和在线调试工具</p>

<p>下面的代码示例展示了一些常用API的使用方式，在运行下面的示例前请先获取CorpID和CorpSecret，并按照示例下的说明配置到合适的位置。</p>

<h3 id="调试工具">调试工具</h3>

<p><a href="https://debug.dingtalk.com"><font color=red >钉钉服务端API调试工具</font></a></p>

<h3 id="java版本">Java版本</h3>
<pre class="highlight javascript"><code> <span class="kr">public</span> <span class="kr">class</span> <span class="nx">Env</span> <span class="p">{</span>
  <span class="kr">public</span> <span class="kr">static</span> <span class="kr">final</span> <span class="nb">String</span> <span class="nx">OAPI_HOST</span> <span class="o">=</span> <span class="s2">"https://oapi.dingtalk.com"</span><span class="p">;</span>
    <span class="kr">public</span> <span class="kr">static</span> <span class="kr">final</span> <span class="nb">String</span> <span class="nx">CORP_ID</span> <span class="o">=</span> <span class="s2">"corpid"</span><span class="p">;</span>
    <span class="kr">public</span> <span class="kr">static</span> <span class="kr">final</span> <span class="nb">String</span> <span class="nx">SECRET</span> <span class="o">=</span> <span class="s2">"secret"</span><span class="p">;</span>
 <span class="p">}</span>

</code></pre>

<p>1.将您的CorpID和CorpSecret配置在Env.java文件</p>

<p>2.启动您的服务器，如果配置正确，则会成功启动。</p>

<p><a href="https://github.com/injekt/openapi-demo-java"><font color=red >Demo地址：</font></a>
<a href="https://github.com/injekt/openapi-demo-java"><font color=red >https://github.com/injekt/openapi-demo-java</font></a></p>

<h3 id="php版本">PHP版本</h3>
<pre class="highlight javascript"><code> <span class="nx">define</span><span class="p">(</span><span class="s2">"OAPI_HOST"</span><span class="p">,</span> <span class="s2">"https://oapi.dingtalk.com"</span><span class="p">);</span>
 <span class="nx">define</span><span class="p">(</span><span class="s2">"CORPID"</span><span class="p">,</span> <span class="s2">""</span><span class="p">);</span>
 <span class="nx">define</span><span class="p">(</span><span class="s2">"SECRET"</span><span class="p">,</span> <span class="s2">""</span><span class="p">);</span>
</code></pre>

<p>1.将您的CorpID和CorpSecret配置在env.php文件</p>

<p>2.启动您的服务器，如果配置正确，则会成功启动。</p>

<p><a href="https://github.com/injekt/openapi-demo-php"><font color=red >Demo地址：</font></a>
<a href="https://github.com/injekt/openapi-demo-php"><font color=red >https://github.com/injekt/openapi-demo-php</font></a></p>

<h3 id="node-js版本">Node.js版本</h3>
<pre class="highlight javascript"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">secret</span><span class="p">:</span> <span class="s1">''</span>
<span class="p">};</span>
</code></pre>

<p>1.将您的CorpID和CorpSecret配置在env.js文件</p>

<p>2.启动您的服务器，如果配置正确，则会成功启动。</p>

<p><a href="https://github.com/injekt/openapi-demo-nodejs"><font color=red >Demo地址：</font></a>
<a href="https://github.com/injekt/openapi-demo-nodejs"><font color=red >https://github.com/injekt/openapi-demo-nodejs</font></a></p>

          <h1 id="客户端开发文档">客户端开发文档</h1>

<p>微应用是 钉钉 为连接企业办公打造的移动入口，通过微应用你可以将企业的业务审批，内部系统，生成，协作，管理，上下游沟通连接到钉钉，更简单和低成本实现企业移动化； 结合钉钉的基础通信能力，让企业应用更活跃，员工更高效，移动化成本更低。</p>

<p>而客户端开发文档将为微应用提供调用原生控件的能力，带给微应用接近原生代码的体验。</p>

<h2 id="demo和调试工具">Demo和调试工具</h2>

<p>我们提供了Demo和调试工具给您的开发提供方便，如果对调用参数有疑问，请使用调试工具。对jsapi用法有疑问，可查看Demo.</p>

<p><a href="http://wsdebug.dingtalk.com/"><font color=red >调试工具</font></a>:<a href="http://wsdebug.dingtalk.com">http://wsdebug.dingtalk.com</a>
打开左边的超链接后，手机扫描二维码，然后在PC页面上配置jsapi参数，点击执行手机就会给予相应反馈</p>

<p><a href="http://h5.m.laiwang.com/home/ding.html"><font color=red >jsapi使用样例地址</font></a>:<a href="http://h5.m.laiwang.com/home/ding.html">http://h5.m.laiwang.com/home/ding.html</a></p>

<p><a href="https://github.com/outlookxie/app-todolist"><font color=red >微应用Demo地址</font></a>:<a href="https://github.com/outlookxie/app-todolist">https://github.com/outlookxie/app-todolist</a></p>

<h2 id="通用">通用</h2>

<h3 id="页面引入js文件">页面引入js文件</h3>

<p>js文件版本在添加升级功能时地址会变化，如有需要（比如要使用新增的js-api）,请随时关注地址变更。但是旧版本js文件也将一直可用。</p>

<p><code class="prettyprint">http://g.alicdn.com/ilw/ding/0.6.6/scripts/dingtalk.js</code></p>

<p>或者</p>

<p><code class="prettyprint">https://g.alicdn.com/ilw/ding/0.6.6/scripts/dingtalk.js</code></p>

<h3 id="全局变量、命名空间">全局变量、命名空间</h3>

<p>直接引入dingtalk.js会得到一个全局变量<code class="prettyprint">dd</code>，支持amd、cmd引入方式</p>

<p>全局变量dd，命名空间：设备(dd.device)、业务(dd.biz)</p>

<h3 id="权限验证配置-beta">权限验证配置(beta)</h3>

<p>钉钉JS API安全验证，只有经过安全验证的微应用才能调用安全级别较高的API。</p>

<p>获取JS-API权限验证使用的签名的方法请参考附录-<a href="#js-api权限签名算法"><font color=red >JS-API权限签名算法</font></a></p>

<p><a href="https://github.com/injekt/jsapi-demo"><font color=red >jsapi权限验证配置demo&ndash;node.js版本</font></a></p>

<p><a href="https://github.com/injekt/openapi-demo-java"><font color=red >jsapi权限验证配置demo&ndash;java版本</font></a></p>

<p><a href="https://github.com/injekt/openapi-demo-php"><font color=red >jsapi权限验证配置demo&ndash;php版本</font></a></p>
<pre class="highlight javascript"><code> <span class="nx">dd</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">agentId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，微应用ID</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span><span class="c1">//必填，企业ID</span>
    <span class="na">timeStamp</span><span class="p">:</span> <span class="p">,</span> <span class="c1">// 必填，生成签名的时间戳</span>
    <span class="na">nonceStr</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，生成签名的随机串</span>
    <span class="na">signature</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，签名</span>
    <span class="na">jsApiList</span><span class="p">:</span> <span class="p">[</span><span class="s1">'device.notification.alert'</span><span class="p">,</span> <span class="s1">'device.notification.confirm'</span><span class="p">]</span> <span class="c1">// 必填，需要使用的jsapi列表</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>agentId</td>
<td>String</td>
<td>是</td>
<td>微应用ID，普通企业可以通过OA后台的微应用－设置查看agentID，ISV需要通过调用授权成功后的get_auth_info获取授权方的agentid</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>是</td>
<td>企业ID</td>
</tr>
<tr>
<td>timeStamp</td>
<td>String</td>
<td>是</td>
<td>生成签名的时间戳</td>
</tr>
<tr>
<td>nonceStr</td>
<td>String</td>
<td>是</td>
<td>生成签名的随机串</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>是</td>
<td>签名</td>
</tr>
<tr>
<td>jsApiList</td>
<td>Array</td>
<td>是</td>
<td>需要调用的jsapi列表</td>
</tr>
</tbody></table>

<h3 id="通过ready接口处理成功验证">通过ready接口处理成功验证</h3>

<p>dd.ready参数为回调函数，在环境准备就绪时触发，jsapi的调用需要保证在该回调函数触发后调用，否则无效。</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="p">;</span>
<span class="p">});</span>
</code></pre>

<h3 id="通过error接口处理失败验证">通过error接口处理失败验证</h3>

<p>config信息验证失败会执行error函数，错误信息可以在返回的error参数中参看</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
    <span class="p">;</span>
<span class="p">});</span>
</code></pre>

<h3 id="接口约定">接口约定</h3>

<ul>
<li>所有接口都为异步</li>
<li>接受一个object类型的参数</li>
<li>成功回调 onSuccess</li>
<li>失败回调 onFail</li>
</ul>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="err">命名空间</span><span class="p">.</span><span class="err">功能</span><span class="p">.</span><span class="err">方法</span><span class="p">({</span>
    <span class="err">参数</span><span class="mi">1</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="err">参数</span><span class="mi">2</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//成功回调</span>
    <span class="cm">/*
    {
        //所有返回信息都输出在这里
    }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//失败回调</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h2 id="容器">容器</h2>

<p>dd.runtime</p>

<h3 id="获取容器信息">获取容器信息</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">info</span><span class="p">({</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*{
        ability: '0.0.2' //容器版本，用来标识JSAPI能力，可根据该版本来决定能否使用jsapi
    }*/</span>
    <span class="p">}</span>
    <span class="nl">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>

<span class="p">})</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>ability</td>
<td>容器版本，用来标识JSAPI能力，可根据该版本来决定能否使用jsapi</td>
</tr>
</tbody></table>

<h3 id="获取免登授权码">获取免登授权码</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">permission</span><span class="p">.</span><span class="nx">requestAuthCode</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s2">"corpid"</span><span class="p">,</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*{
        code: 'hYLK98jkf0m' //string authCode
    }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>

<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>是</td>
<td>企业ID</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>授权码</td>
</tr>
</tbody></table>

<!--### 请求jsapi

0.0.5

```javascript
dd.runtime.permission.requestJsApis({
    corpId: '', //企业ID
    timeStamp: '', //生成签名的时间戳
    nonceStr: '', //生成签名的随机串
    signature: '', //签名
    jsApiList: [], //需要调用的jsapi列表
    onSuccess: function(result) {
    /*{
        jsApilist: [] //array[string] authJsApiList
    }*/
    }
})
```
##### 参数说明

参数 | 参数类型 | 必须 | 说明
----- | ------- | ------- | ------
corpId | String | 是 | 企业ID
timeStamp | String | 是 | 生成签名的时间戳
nonceStr | String | 是 | 生成签名的随机串
signature | String | 是 | 签名
jsApiList | array[string] | 是 | 需要调用的jsapi列表

##### 返回说明

参数 | 说明
---- | -----
jsApilist | 授权的JsApi列表
-->

<h2 id="设备">设备</h2>

<p>dd.device</p>

<h3 id="基础信息">基础信息</h3>

<h3 id="获取通用唯一识别码">获取通用唯一识别码</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">base</span><span class="p">.</span><span class="nx">getUUID</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            uuid: '3udbhg98ddlljokkkl' //
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>uuid</td>
<td>通用唯一识别码</td>
</tr>
</tbody></table>

<h3 id="获取热点接入信息">获取热点接入信息</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">base</span><span class="p">.</span><span class="nx">getInterface</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            ssid: 'alibaba-inc',
            macIp: '3c:12:aa:09'
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>ssid</td>
<td>热点ssid</td>
</tr>
<tr>
<td>macIp</td>
<td>热点mac地址</td>
</tr>
</tbody></table>

<h2 id="启动器">启动器</h2>

<p>dd.device</p>

<h3 id="检测应用是否安装">检测应用是否安装</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">launcher</span><span class="p">.</span><span class="nx">checkInstalledApps</span><span class="p">({</span>
    <span class="na">apps</span><span class="p">:</span> <span class="p">[</span><span class="s1">'taobao'</span><span class="p">,</span> <span class="s1">'tmall'</span><span class="p">],</span> <span class="c1">//iOS:应用scheme;Android:应用包名</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            installed: ['taobao', 'tmall'] //iOS:应用scheme;Android:应用包名
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>apps</td>
<td>Array[String]</td>
<td>iOS:应用scheme;Android:应用包名</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>installed</td>
<td>安装过的应用列表</td>
</tr>
</tbody></table>

<h3 id="启动第三方应用">启动第三方应用</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">launcher</span><span class="p">.</span><span class="nx">launchApp</span><span class="p">({</span>
    <span class="na">app</span><span class="p">:</span> <span class="s1">'taobao'</span><span class="p">,</span> <span class="c1">//iOS:应用scheme;Android:应用包名</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            result: true //true 唤起成功 false 唤起失败
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>app</td>
<td>String</td>
<td>iOS:应用scheme;Android:应用包名</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>值为true说明唤起成功，值为false说明唤起失败</td>
</tr>
</tbody></table>

<h3 id="获取当前网络类型">获取当前网络类型</h3>

<p>0.0.2</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">getNetworkType</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            result: 'wifi' // result值: wifi 2g 3g 4g unknown none   none表示离线
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>result值: wifi、2g、3g、4g、unknown、none，none表示离线</td>
</tr>
</tbody></table>

<h3 id="事件">事件</h3>

<p>支持事件： pause、resume、backbutton(android)</p>
<pre class="highlight plaintext"><code>//退到后台(webview)
document.addEventListener('pause', function(e) {
    e.preventDefault();
    console.log('事件：pause')
}, false);

//唤醒(webview)
document.addEventListener('resume', function(e) {
    e.preventDefault();
    console.log('事件：resume')
}, false);


//返回按钮(android)
document.addEventListener('backbutton', function(e) {
    e.preventDefault();
    dd.device.notification.alert({
        message: '哎呀，你不小心点到返回键啦!',
        title: '...警告...'
    });
}, false);
</code></pre>

<h2 id="弹窗">弹窗</h2>

<p>dd.device</p>

<h3 id="alert">alert</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">alert</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"亲爱的"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"提示"</span><span class="p">,</span><span class="c1">//可传空</span>
    <span class="na">buttonName</span><span class="p">:</span> <span class="s2">"收到"</span><span class="p">,</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/*回调*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://gw.alicdn.com/tps/TB1.3UPJpXXXXbEXVXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息内容</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>弹窗标题</td>
</tr>
<tr>
<td>buttonName</td>
<td>String</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h3 id="confirm">confirm</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">confirm</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"你爱我吗"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"提示"</span><span class="p">,</span>
    <span class="na">buttonLabels</span><span class="p">:</span> <span class="p">[</span><span class="s1">'爱'</span><span class="p">,</span> <span class="s1">'不爱'</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            buttonIndex: 0 //被点击按钮的索引值，Number类型，从0开始
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1cL.KJpXXXXXJaXXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息说明</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number类型，从0开始</td>
</tr>
</tbody></table>

<h3 id="prompt">prompt</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">prompt</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"再说一遍？"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"提示"</span><span class="p">,</span>
    <span class="na">buttonLabels</span><span class="p">:</span> <span class="p">[</span><span class="s1">'继续'</span><span class="p">,</span> <span class="s1">'不玩了'</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            buttonIndex: 0, //被点击按钮的索引值，Number类型，从0开始
            value: '' //输入的值
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1lZZJJpXXXXazaXXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息内容</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number类型，从0开始</td>
</tr>
<tr>
<td>value</td>
<td>输入的值</td>
</tr>
</tbody></table>

<h3 id="vibrate">vibrate</h3>

<p>震动</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">({</span>
    <span class="na">duration</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="c1">//震动时间，android可配置 iOS忽略</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>duration</td>
<td>Number</td>
<td>震动时间，android可配置 iOS忽略</td>
</tr>
</tbody></table>

<h3 id="showpreloader">showPreloader</h3>

<p>（显示浮层，请和hidePreloader配对使用）</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">showPreloader</span><span class="p">({</span>
    <span class="na">text</span><span class="p">:</span> <span class="s2">"使劲加载中.."</span><span class="p">,</span> <span class="c1">//loading显示的字符，空表示不显示文字</span>
    <span class="na">showIcon</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">//是否显示icon，默认true</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB17bBXJFXXXXb3XXXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>String</td>
<td>loading显示的字符，空表示不显示文字</td>
</tr>
<tr>
<td>showIcon</td>
<td>Boolean</td>
<td>是否显示icon，默认true</td>
</tr>
</tbody></table>

<h3 id="hidepreloader">hidePreloader</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">hidePreloader</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h3 id="toast">toast</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">toast</span><span class="p">({</span>
    <span class="na">icon</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//icon样式，有success和error，默认为空 0.0.2</span>
    <span class="na">text</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//提示信息</span>
    <span class="na">duration</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//显示持续时间，单位秒，默认按系统规范[android只有两种(&lt;=2s &gt;2s)]</span>
    <span class="na">delay</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//延迟显示，单位秒，默认0</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1jjdJKVXXXXXbXpXXXXXXXXXX-200-356.jpg" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>icon</td>
<td>Boolean</td>
<td>icon样式，有success和error，默认为空 0.0.2</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>提示信息</td>
</tr>
<tr>
<td>duration</td>
<td>Number</td>
<td>显示持续时间，单位秒，默认按系统规范[android只有两种(&lt;=2s &gt;2s)]</td>
</tr>
<tr>
<td>delay</td>
<td>Number</td>
<td>延迟显示，单位秒，默认0</td>
</tr>
</tbody></table>

<h3 id="actionsheet">actionsheet</h3>

<p>单选列表</p>

<p>0.0.2</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">actionSheet</span><span class="p">({</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"谁是最棒哒？"</span><span class="p">,</span> <span class="c1">//标题</span>
    <span class="na">cancelButton</span><span class="p">:</span> <span class="s1">'取消'</span><span class="p">,</span> <span class="c1">//取消按钮文本</span>
    <span class="na">otherButtons</span><span class="p">:</span> <span class="p">[</span><span class="s2">"孙悟空"</span><span class="p">,</span><span class="s2">"猪八戒"</span><span class="p">,</span><span class="s2">"唐僧"</span><span class="p">,</span><span class="s2">"沙和尚"</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            buttonIndex: 0 //被点击按钮的索引值，Number，从0开始, 取消按钮为-1
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1jn70JpXXXXXEXFXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>cancelButton</td>
<td>String</td>
<td>取消按钮文本</td>
</tr>
<tr>
<td>otherButtons</td>
<td>Array[String]</td>
<td>其他按钮列表</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number，从0开始, 取消按钮为-1</td>
</tr>
</tbody></table>

<h3 id="modal">modal</h3>

<p>modal弹浮层 </p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">modal</span><span class="p">({</span>
    <span class="na">image</span><span class="p">:</span><span class="s2">"http://gw.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg_200x200.jpg"</span><span class="p">,</span> <span class="c1">// 标题图片地址</span>
    <span class="na">title</span><span class="p">:</span><span class="s2">"2.4版本更新"</span><span class="p">,</span> <span class="c1">//标题</span>
    <span class="na">content</span><span class="p">:</span><span class="s2">"1.功能更新2.功能更新;"</span><span class="p">,</span> <span class="c1">//文本内容</span>
    <span class="na">buttonLabels</span><span class="p">:[</span><span class="s2">"了解更多"</span><span class="p">,</span><span class="s2">"知道了"</span><span class="p">],</span><span class="c1">// 最多两个按钮，至少有一个按钮。</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            buttonIndex: 0 //被点击按钮的索引值，Number，从0开始
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1M1MKJpXXXXadaXXXXXXXXXXX-720-1280.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>image</td>
<td>String</td>
<td>图片地址</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>content</td>
<td>String</td>
<td>文本内容</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>其他按钮列表</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number，从0开始</td>
</tr>
</tbody></table>

<h2 id="地图">地图</h2>

<p>dd.device</p>

<h3 id="获取当前地理位置">获取当前地理位置</h3>

<p>钉钉Android2.1及之前版本返回的数据会多嵌套一层location字段,2.2版本会改成和钉钉iOS客户端一致，请注意，建议对返回的数据先判断存在location，做向后兼容处理。</p>

<p>目前androidJSAPI返回的坐标是高德坐标，ios是标准坐标，如果服务端调用的是高德API，则需要对ios返回的经纬度做下处理，详细请见<a href="http://lbsbbs.amap.com/forum.php?mod=viewthread&amp;tid=724&amp;page=2"><font color=red >http://lbsbbs.amap.com/forum.php?mod=viewthread&amp;tid=724&amp;page=2</font></a>。坐标转换API <a href="http://lbs.amap.com/api/javascript-api/example/p/1602-2/"><font color=red >http://lbs.amap.com/api/javascript-api/example/p/1602-2/</font></a></p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span>
    <span class="na">targetAccuracy</span> <span class="p">:</span> <span class="nb">Number</span><span class="p">,</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            longitude : Number,
            latitude : Number,
            accuracy : Number,
            isWifiEnabled : Boolean,
            isGpsEnabled : Boolean,
            isFromMock : Boolean,
            provider : wifi|lbs|gps,
            accuracy : Number,
            isMobileEnabled : Boolean,
            errorMessage : String,
            errorCode : Number
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>targetAccuracy</td>
<td>Number</td>
<td>期望定位精度半径（单位米），定位结果尽量满足该参数要求，但是不一定能保证小于该误差</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>longitude</td>
<td>经度</td>
</tr>
<tr>
<td>latitude</td>
<td>纬度</td>
</tr>
<tr>
<td>accuracy</td>
<td>实际的定位精度半径（单位米）</td>
</tr>
<tr>
<td>isWifiEnabled</td>
<td>wifi设置是否开启，不保证已连接上</td>
</tr>
<tr>
<td>isGpsEnabled</td>
<td>gps设置是否开启，不保证已经连接上</td>
</tr>
<tr>
<td>isFromMock</td>
<td>定位返回的经纬度是否是模拟的结果</td>
</tr>
<tr>
<td>provider</td>
<td>我们使用的是混合定位，具体定位提供者有wifi/lbs/gps&quot; 这三种</td>
</tr>
<tr>
<td>isMobileEnabled</td>
<td>移动网络是设置是否开启，不保证已经连接上</td>
</tr>
<tr>
<td>errorMessage</td>
<td>对错误码的描述</td>
</tr>
<tr>
<td>errorCode</td>
<td>错误码</td>
</tr>
</tbody></table>

<!--

### 搜索
0.0.6

```javascript
dd.biz.map.search({
  scope: Number, //定位范围
  extraInfo: {
      prompt: "提示信息"
  }
  onSuccess: function(data) {
  /* data结构
      {
      "province": ""//省
      "provinceCode": "" //省份编码
      "city": "" //城市
      "cityCode": "" //城市编码
      "adCode": "" // POI的行政区划代码
      "adName": "" // POI的行政区划名称
      "distance": "" //获取POI距离中心点的距离
      "postCode": "" //返回POI的邮编
      "title": "" //POI的名称
      "snippet": "" //POI的地址
      "longitude": 11.11, //该点经度
      "latitude": 11.11, //该点纬度
      }
  */
  },
  onFail : function(err) {
  }
})
```
##### 参数说明

参数 | 参数类型 | 说明
----- | ----- | -----
scope | Number | 定位范围
extraInfo.prompt | String | 提示信息

##### 返回说明

参数 | 说明
----- | -----
province | 省份
provinceCode | 省份编码
city | 城市
cityCode | 城市编码
adCode | POI的行政区划代码
adName | POI的行政区划名称
distance | 获取POI距离中心点的距离
postCode | 返回POI的邮编
title | POI的名称
snippet | POI的地址
longitude | 该点经度
latitude | 该点纬度

###定位
0.0.6

```javascript
dd.biz.map.locate({
  onSuccess: function(data) {
   /* data结构
      {
      "province": ""//省
      "provinceCode": "" //省份编码
      "city": "" //城市
      "cityCode": "" //城市编码
      "adCode": "" // POI的行政区划代码
      "adName": "" // POI的行政区划名称
      "distance": "" //获取POI距离中心点的距离
      "postCode": "" //返回POI的邮编
      "title": "" //POI的名称
      "snippet": "" //POI的地址
      "longitude": 11.11, //该点经度
      "latitude": 11.11, //该点纬度
      }
  */
  },
  onFail : function(err) {
  }
})
```

##### 返回说明

参数 | 说明
----- | -----
province | 省份
provinceCode | 省份编码
city | 城市
cityCode | 城市编码
adCode | POI的行政区划代码
adName | POI的行政区划名称
distance | 获取POI距离中心点的距离
postCode | 返回POI的邮编
title | POI的名称
snippet | POI的地址
longitude | 该点经度
latitude | 该点纬度

-->

<h2 id="加速器">加速器</h2>

<p>dd.device</p>

<h3 id="摇一摇">摇一摇</h3>

<p>开启监听</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">accelerometer</span><span class="p">.</span><span class="nx">watchShake</span><span class="p">({</span>
    <span class="na">sensitivity</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span><span class="c1">//振动幅度，Number类型，加速度变化超过这个值后触发shake</span>
    <span class="na">frequency</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span><span class="c1">//采样间隔(毫秒)，Number类型，指每隔多长时间对加速度进行一次采样， 然后对比前后变化，判断是否触发shake</span>
    <span class="na">callbackDelay</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span><span class="c1">//触发『摇一摇』后的等待时间(毫秒)，Number类型，防止频繁调用</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>sensitivity</td>
<td>Number</td>
<td>振动幅度，Number类型，加速度变化超过这个值后触发shake</td>
</tr>
<tr>
<td>frequency</td>
<td>Number</td>
<td>采样间隔(毫秒)，Number类型，指每隔多长时间对加速度进行一次采样， 然后对比前后变化，判断是否触发shake</td>
</tr>
<tr>
<td>callbackDelay</td>
<td>Number</td>
<td>触发『摇一摇』后的等待时间(毫秒)，Number类型，防止频繁调用</td>
</tr>
</tbody></table>

<p>清除监听</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">accelerometer</span><span class="p">.</span><span class="nx">clearShake</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/* 调用成功
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h2 id="业务">业务</h2>

<p>dd.biz</p>

<h3 id="打开应用内页面">打开应用内页面</h3>
<pre class="highlight plaintext"><code>dd.biz.util.open({
    name:String,//页面名称
    params:JSONObject,//传参
    onSuccess : function() {
        /**/
    },
    onFail : function(err) {}
});
</code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>页面名称</td>
</tr>
<tr>
<td>params</td>
<td>JSONObject</td>
<td>传参</td>
</tr>
</tbody></table>

<p>目前支持以下页面，具体参数看右边</p>

<p>a.个人资料页</p>
<pre class="highlight plaintext"><code>// 页面名称：
    profile
// 传参：
    id :用户工号 String
    corpId: '' //企业id
</code></pre>

<p>b.聊天页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    chat
// 传参：
    users: ['123'] 用户列表,工号
    corpId: '' //企业id
</code></pre>

<p>c.免费电话页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    call
// 传参：
</code></pre>

<p>d.联系人添加页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    contactAdd
// 传参：
</code></pre>

<p>f.唤起添加好友页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    friendAdd
// 传参：
</code></pre>

<h3 id="分享">分享</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">share</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span><span class="c1">//分享类型，0:全部组件 默认； 1:只能分享到钉钉；2:不能分享，只有刷新按钮</span>
    <span class="na">url</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">content</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">image</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1L6RvKVXXXXa3XFXXXXXXXXXX-200-356.jpg" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>Number</td>
<td>分享类型，0:全部组件默认； 1:只能分享到钉钉；2:不能分享，只有刷新按钮</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>url地址</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>分享标题</td>
</tr>
<tr>
<td>content</td>
<td>String</td>
<td>分享内容</td>
</tr>
<tr>
<td>image</td>
<td>String</td>
<td>分享的图片</td>
</tr>
</tbody></table>

<h3 id="ut打点">ut打点</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">ut</span><span class="p">({</span>
    <span class="na">key</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//打点名</span>
    <span class="na">value</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//打点传值</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>String</td>
<td>打点名</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>打点传值</td>
</tr>
</tbody></table>

<!--### 选取图片[暂不开放]

```javascript
dd.biz.util.chooseImage({
    multiple: false, //是否多选，默认false
    destType: String, //返回格式 DATA_URL(base64编码) FILE_URI(文件路径)，默认FILE_URI
    onSuccess : function(result) {
        /**/
    },
    onFail : function() {}
})
```
-->

<h3 id="上传图片">上传图片</h3>

<p>选择图片+上传，防止恶意上传</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">uploadImage</span><span class="p">({</span>
    <span class="na">multiple</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">//是否多选，默认false</span>
    <span class="na">max</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">//最多可选个数</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        [
          'http://gtms03.alicdn.com/tps/i3/TB1VF6uGFXXXXalaXXXmh5R_VXX-237-236.png'
        ]
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1FhFlKVXXXXbNXVXXXXXXXXXX-200-356.png" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>multiple</td>
<td>Boolean</td>
<td>是否多选，默认false</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>Number为正整数，最多可选个数</td>
</tr>
</tbody></table>

<h3 id="上传图片（仅支持拍照上传）">上传图片（仅支持拍照上传）</h3>

<p>只支持直接拍照上传，即调用这个API之后将直接调起相机界面</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">uploadImageFromCamera</span><span class="p">({</span>
    <span class="na">compression</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="c1">//(是否压缩，默认为true)</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        [
          'http://gtms03.alicdn.com/tps/i3/TB1VF6uGFXXXXalaXXXmh5R_VXX-237-236.png'
        ]
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>compression</td>
<td>Boolean</td>
<td>图片地址列表</td>
</tr>
</tbody></table>

<h3 id="图片浏览器">图片浏览器</h3>

<p>调用此api，将显示一个图片浏览器</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">previewImage</span><span class="p">({</span>
    <span class="na">urls</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">],</span><span class="c1">//图片地址列表</span>
    <span class="na">current</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//当前显示的图片链接</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1UjhmKVXXXXboXVXXXXXXXXXX-200-356.jpg" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>urls</td>
<td>Array[String]</td>
<td>图片地址列表</td>
</tr>
<tr>
<td>current</td>
<td>String</td>
<td>当前显示的图片链接</td>
</tr>
</tbody></table>

<!-- ### 扫码

```javascript
dd.biz.util.qrcode({
    onSuccess : function(result) {
        /*
        {
            text: String
        }
        */
    },
    onFail : function(err) {}
})
```
##### 返回说明
参数 | 说明
----- | ------
text | 扫码的内容 -->

<h3 id="日期选择器">日期选择器</h3>

<p>日期</p>

<p>注意：format只支持android系统规范，即2015-03-31格式为yyyy-MM-dd</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">({</span>
    <span class="na">format</span><span class="p">:</span> <span class="s1">'yyyy-MM-dd'</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="s1">'2015-04-17'</span><span class="p">,</span> <span class="c1">//默认显示日期</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            value: "2015-02-10"
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1bcRLKVXXXXb8XXXXXXXXXXXX-200-356.png" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>format</td>
<td>String</td>
<td>format只支持android系统规范，即2015-03-31格式为yyyy-MM-dd</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>默认显示日期</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>返回选择的日期</td>
</tr>
</tbody></table>

<p>时间</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">timepicker</span><span class="p">({</span>
    <span class="na">format</span><span class="p">:</span> <span class="s1">'HH:mm'</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="s1">'14:00'</span><span class="p">,</span> <span class="c1">//默认显示时间  0.0.3</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            value: "10:00"
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>format</td>
<td>String</td>
<td>时间格式</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>默认显示时间</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>返回选择的时间</td>
</tr>
</tbody></table>

<p>日期+时间</p>

<p>0.0.4</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">datetimepicker</span><span class="p">({</span>
    <span class="na">format</span><span class="p">:</span> <span class="s1">'yyyy-MM-dd HH:mm'</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="s1">'2015-04-17 08:00'</span><span class="p">,</span> <span class="c1">//默认显示</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            value: "2015-06-10 09:50"
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>format</td>
<td>String</td>
<td>日期和时间的格式</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>默认显示的日期和时间</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>返回选择的日期和时间</td>
</tr>
</tbody></table>

<h3 id="下拉控件">下拉控件</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">chosen</span><span class="p">({</span>
    <span class="na">source</span><span class="p">:[{</span>
        <span class="na">key</span><span class="p">:</span> <span class="s1">'选项1'</span><span class="p">,</span> <span class="c1">//显示文本</span>
        <span class="na">value</span><span class="p">:</span> <span class="s1">'123'</span> <span class="c1">//值，</span>
    <span class="p">},{</span>
        <span class="na">key</span><span class="p">:</span> <span class="s1">'选项2'</span><span class="p">,</span>
        <span class="na">value</span><span class="p">:</span> <span class="s1">'234'</span>
    <span class="p">}],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            key: '选项2',
            value: '234'
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB177sWJpXXXXbeXFXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>Array[String]</td>
<td>下拉控件的内容</td>
</tr>
<tr>
<td>key</td>
<td>String</td>
<td>显示文本</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>文本对应的值</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>返回选择的文本</td>
</tr>
<tr>
<td>value</td>
<td>返回选择的值</td>
</tr>
</tbody></table>

<h2 id="会话">会话</h2>

<p>dd.biz</p>

<h3 id="获取会话信息">获取会话信息</h3>

<p>0.0.7</p>

<p>corpid必须是用户所属的企业的corpid</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">pickConversation</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">isConfirm</span><span class="p">:</span><span class="s1">'true'</span><span class="p">,</span> <span class="c1">//是否弹出确认窗口，默认为true</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1cXJPKVXXXXXFXXXXXXXXXXXX-200-356.png" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业ID</td>
</tr>
<tr>
<td>isConfirm</td>
<td>Boolean</td>
<td>是否弹出确认窗口，默认为true</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>cid</td>
<td>会话id</td>
</tr>
<tr>
<td>title</td>
<td>会话标题</td>
</tr>
</tbody></table>

<h3 id="根据corpid选择会话">根据corpid选择会话</h3>

<p>0.0.11</p>

<p>corpid必须是用户所属的企业的corpid</p>

<p>2.6版本新增</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">chooseConversationByCorpId</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">'xxx'</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业ID</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatId</td>
<td>会话id</td>
</tr>
<tr>
<td>title</td>
<td>会话标题</td>
</tr>
</tbody></table>

<h3 id="根据chatid跳转到对应会话">根据chatid跳转到对应会话</h3>

<p>0.0.11</p>

<p>corpid必须是用户所属的企业的corpid</p>

<p>2.6版本新增</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">toConversation</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">'xxx'</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">chatId</span><span class="p">:</span><span class="s1">'xxx'</span><span class="p">,</span><span class="c1">//会话Id</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业ID</td>
</tr>
<tr>
<td>chatId</td>
<td>String</td>
<td>企业ID</td>
</tr>
</tbody></table>

<h5 id="返回说明（无）">返回说明（无）</h5>

<!--### 发送消息

```javascript
dd.biz.chat.sendMessage({
    users : ['100', '101'],//用户列表，工号
    corpId: '', //企业id
    type: 1,//消息类型 1：image  2：link  [暂定和发钉保持一致]
    attachment: {
        images: [''],
    },
    text: String,
    onSuccess : function() {},
    onFail : function() {}
})
```

### 选择会话(群)

类似分享到钉钉的选取页面，只能选一个回话 0.0.3

```javascript
dd.biz.chat.chooseConversation({
    onSuccess : function(data) {
    /*
    {
        id: '123' //会话id
    }
    */
    },
    onFail : function() {}
})
```
#####　返回说明
参数 | 说明
----- | ------
id | 会话id

###获取会话信息

0.0.6

```javascript
dd.biz.chat.getConversationInfo ({
  cid: String, //会话ID
  onSuccess: function(data) {
  /* data结构
      "cid": "1111", //会话ID
      "title": '123', //会话标题
      "avatarIcons": ["http://", ...], //会话的头像数组
      "memberCount": 11, //群聊成员总数
      }
  */
  },
  onFail : function(err) {
  }
})
```
##### 参数说明

参数 | 参数类型 | 说明
----- | ----- | -----
cid | String | 会话ID

##### 返回说明
参数 | 说明
----- | -----
cid | 会话ID
title | 会话标题
avatarIcons | 会话的头像数组
memberCount | 群聊成员总数
-->

<h2 id="ding">Ding</h2>

<p>dd.biz</p>

<h3 id="发钉">发钉</h3>

<h4 id="图片类型">图片类型</h4>

<p>0.0.3</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">ding</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
    <span class="na">users</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span> <span class="s1">'101'</span><span class="p">],</span><span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">type</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">//钉类型 1：image  2：link</span>
    <span class="na">alertType</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="na">alertDate</span><span class="p">:</span> <span class="p">{</span><span class="s2">"format"</span><span class="p">:</span><span class="s2">"yyyy-MM-dd HH:mm"</span><span class="p">,</span><span class="s2">"value"</span><span class="p">:</span><span class="s2">"2015-05-09 08:00"</span><span class="p">},</span>
    <span class="na">attachment</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">images</span><span class="p">:</span> <span class="p">[</span><span class="s1">''</span><span class="p">],</span>
    <span class="p">},</span> <span class="c1">//附件信息</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//消息</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1h_JtKVXXXXbNXFXXXXXXXXXX-200-356.png" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>type</td>
<td>Number</td>
<td>Number为整数。钉类型 1：image，2：link</td>
</tr>
<tr>
<td>alertType</td>
<td>Number</td>
<td>钉提醒类型 0:电话, 1:短信, 2:应用内</td>
</tr>
<tr>
<td>alertDate</td>
<td>Object</td>
<td>钉提醒时间</td>
</tr>
<tr>
<td>attachment</td>
<td>Object</td>
<td>附件信息</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>消息</td>
</tr>
</tbody></table>

<h4 id="link类型">Link类型</h4>

<p>0.0.3</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">ding</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
    <span class="na">users</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span> <span class="s1">'101'</span><span class="p">],</span><span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">type</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">//钉类型 1：image  2：link</span>
    <span class="na">alertType</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="na">alertDate</span><span class="p">:</span> <span class="p">{</span><span class="s2">"format"</span><span class="p">:</span><span class="s2">"yyyy-MM-dd HH:mm"</span><span class="p">,</span><span class="s2">"value"</span><span class="p">:</span><span class="s2">"2015-05-09 08:00"</span><span class="p">},</span>
    <span class="na">attachment</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">image</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">''</span>
    <span class="p">}</span>
    <span class="nl">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//消息</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>type</td>
<td>Number</td>
<td>Number为整数。钉类型 1：image  2：link</td>
</tr>
<tr>
<td>alertType</td>
<td>Number</td>
<td>钉提醒类型 0:电话, 1:短信, 2:应用内</td>
</tr>
<tr>
<td>alertDate</td>
<td>Object</td>
<td>钉提醒时间</td>
</tr>
<tr>
<td>attachment</td>
<td>Object</td>
<td>附件信息</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>消息</td>
</tr>
</tbody></table>

<h2 id="电话">电话</h2>

<p>dd.biz</p>

<h3 id="打电话">打电话</h3>

<p>0.0.3</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">telephone</span><span class="p">.</span><span class="nx">call</span><span class="p">({</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'101'</span><span class="p">,</span> <span class="s1">'102'</span><span class="p">],</span> <span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
</tbody></table>

<h2 id="ui控件">UI控件</h2>

<p>dd.ui</p>

<h3 id="输入框">输入框</h3>

<p>0.0.2</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">plain</span><span class="p">({</span>
    <span class="na">placeholder</span><span class="p">:</span> <span class="s1">'说点什么吧'</span><span class="p">,</span> <span class="c1">//占位符</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//默认填充文本</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            text: String
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1ju0BKVXXXXcrXpXXXXXXXXXX-200-356.png" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>placeholder</td>
<td>String</td>
<td>占位符</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>默认填充文本</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>返回文本</td>
</tr>
</tbody></table>

<h3 id="设置顶部进度条颜色">设置顶部进度条颜色</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progressBar</span><span class="p">.</span><span class="nx">setColors</span><span class="p">({</span>
    <span class="na">colors</span><span class="p">:</span> <span class="p">[],</span> <span class="c1">//array[number] 进度条变化颜色，最多支持4个颜色</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
            true:成功  false:失败
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>colors</td>
<td>array[number]</td>
<td>进度条变化颜色，最多支持4个颜色</td>
</tr>
</tbody></table>

<h3 id="启用下拉刷新">启用下拉刷新</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">pullToRefresh</span><span class="p">.</span><span class="nx">enable</span><span class="p">({</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h3 id="收起下拉loading">收起下拉loading</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">pullToRefresh</span><span class="p">.</span><span class="nx">stop</span><span class="p">()</span>
</code></pre>

<h3 id="禁用下拉刷新">禁用下拉刷新</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">pullToRefresh</span><span class="p">.</span><span class="nx">disable</span><span class="p">()</span>
</code></pre>

<h3 id="启用bounce">启用bounce</h3>

<p>启用iOS webview弹性效果(仅iOS支持) 0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">webViewBounce</span><span class="p">.</span><span class="nx">enable</span><span class="p">()</span>
</code></pre>

<h3 id="禁用bounce">禁用bounce</h3>

<p>禁用iOS webview弹性效果(仅iOS支持) 0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">webViewBounce</span><span class="p">.</span><span class="nx">disable</span><span class="p">()</span>
</code></pre>

<h2 id="扫码">扫码</h2>

<p>dd.biz</p>

<p>0.0.6</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">scan</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//type为qrCode或者barCode</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="cm">/* data结构
        { 'text': String}
      */</span>
    <span class="p">},</span>
   <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
   <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>String</td>
<td>type为qrCode或者barCode</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>扫码内容</td>
</tr>
</tbody></table>

<h2 id="企业通讯录">企业通讯录</h2>

<p>dd.biz</p>

<h3 id="选人">选人</h3>

<p>0.0.6</p>

<p>corpid必须是用户所属的企业的corpid</p>

<p>此接口只能对用户进行选择，若要同时选择部门，请使用“选人，选部门”接口。</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">choose</span><span class="p">({</span>
  <span class="na">startWithDepartmentId</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//-1表示打开的通讯录从自己所在部门开始展示, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</span>
  <span class="na">multiple</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span> <span class="c1">//是否多选： true多选 false单选； 默认true</span>
  <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">,</span> <span class="nb">String</span><span class="p">,</span> <span class="p">...],</span> <span class="c1">//默认选中的用户列表，工号；成功回调中应包含该信息</span>
  <span class="na">corpId</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//企业id</span>
  <span class="na">max</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//人数限制，当multiple为true才生效，可选范围1-1500</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/* data结构
    [{
      "name": "张三", //姓名
      "avatar": "http://g.alicdn.com/avatar/zhangsan.png" //头像图片url，可能为空
      "emplId": '0573', //工号
     },
     ...
    ]
  */</span>
  <span class="p">},</span>
  <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1j_JPKVXXXXXbXXXXXXXXXXXX-200-356.png" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>startWithDepartmentId</td>
<td>Number</td>
<td>-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</td>
</tr>
<tr>
<td>multiple</td>
<td>Boolean</td>
<td>是否多选： true多选，false单选； 默认true</td>
</tr>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>默认选中的用户列表，用户id；成功回调中应包含该信息</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>人数限制，当multiple为true才生效，可选范围1-1500</td>
</tr>
</tbody></table>

<!--
startWithDepartmentId: Number, //-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)
startWithDepartmentId | Number | -1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)
-->

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>姓名</td>
</tr>
<tr>
<td>avatar</td>
<td>头像图片url，可能为空</td>
</tr>
<tr>
<td>emplId</td>
<td>用户id，<a href="#%B7%D6%10X%E6%C5"><font color=red>获取成员详情接口</font></a></td>
</tr>
</tbody></table>

<h3 id="选人，选部门">选人，选部门</h3>

<p>0.0.6</p>

<p>corpid必须是用户所属的企业的corpid</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">complexChoose</span><span class="p">({</span>
  <span class="na">startWithDepartmentId</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</span>
  <span class="na">selectedUsers</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">,</span> <span class="nb">String</span><span class="p">,</span> <span class="p">...],</span> <span class="c1">//预选用户</span>
  <span class="na">corpId</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//企业id</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/* data结构
    {
      "users": [
      {
        "name": "张三", //姓名
        "avatar": "htp://g.alicdn.com/avatar/zhangsan.png" //头像图片url，可能为空
        "emplId": "0573", //工号:
      },
      ...
      ],
      "department": [
      {
        "id": 2,
        "name": "来往事业部",
      },
      ...
      ]
    }
  */</span>
  <span class="p">},</span>
  <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1QCXuKVXXXXbWXFXXXXXXXXXX-750-1334.jpg
" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>startWithDepartmentId</td>
<td>Number</td>
<td>-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</td>
</tr>
<tr>
<td>selectedUsers</td>
<td>Array[String]</td>
<td>预选用户</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
</tbody></table>

<!--隐藏selectedDepartments
selectedDepartments | Array | 预选部门 id必选，name可选
selectedDepartments: [{name: '', id: ''}, ...],//预选部门 id必选，name可选
-->

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>选取的用户</td>
</tr>
<tr>
<td>users.name</td>
<td>姓名</td>
</tr>
<tr>
<td>users.avatar</td>
<td>头像图片url，可能为空</td>
</tr>
</tbody></table>

<p>users.emplId 用户id,<a href="#%B7%D6%10X%E6%C5"><font color=red>获取成员详情接口</font></a>
department | 选取的部门
department.id | 部门id
department.name | 部门名称</p>

<!-- ### 选取

默认展示当前  业通讯录，开发中

```javascript
dd.biz.contact.choose({
    multiple: true, //是否多选： true多选 false单选； 默认true
    users: ['100','101'], //默认选中的用户列表，工号；成功回调中应包含该信息
    corpId: '', //企业id
    max: 50, //人数限制，当multiple为true才生效，可选范围1-1500
    onSuccess : function(result) {
        /*
        [{
            emplId: '0573', //工号
            name: '张三', //姓名
            nickNameCn: '三张', //花名
            mobilePhone: '****', //手机号 后续不再返回该字段
            emailAddr: '***', //邮箱  后期不再返回该字段
            pinyin: 'zhangsan', //姓名拼音
            avatar: 'htp://g.alicdn.com/avatar/zhangsan.png' //头像图片url，可能为空
        }]
        */
    },
    onFail : function(err) {}
});
```

##### 参数说明

参数 | 参数类型 | 说明
----- | ----- | -----
multiple | Boolean | 是否多选： true多选 false单选； 默认true
users | Array[String] | 默认选中的用户列表，工号；成功回调中应包含该信息
corpId | String |  企业id
max | Number| Number为正整数。人数限制，当multiple为true才生效，可选范围1-1500


#####　返回说明

参数 | 说明
------|------
emplID | 是否多选： true多选 false单选； 默认true
name | 姓名
nickNameCn | 花名
mobilePhone | 手机号，后续不再返回该字段
emailAddr | 邮箱，后期不再返回该字段
pinyin | 姓名拼音
avatar | 头像图片url，可能为空 -->

<h3 id="创建企业群聊天">创建企业群聊天</h3>

<p>0.0.4</p>

<p>corpid必须是用户所属的企业的corpid</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">createGroup</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id，可选，配置该参数即在指定企业创建群聊天</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span><span class="s1">'101'</span><span class="p">],</span> <span class="c1">//默认选中的用户工号列表，可选；使用此参数必须指定corpId</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            id: 123   //企业群id
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id，可选，配置该参数即在指定企业创建群聊天</td>
</tr>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>默认选中的用户列表，可选；使用此参数必须指定corpId</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>企业群id</td>
</tr>
</tbody></table>

<!--### 添加好友

```javascript
dd.biz.contact.addFriend({
    onSuccess: function(result) {
        /*{
            id: 123   //企业群id
        }*/
    },
    onFail: function(err) {
    }
})
```
-->

<!--## 用户

### 获取当前用户信息

目前只开放emplId字段

```javascript
dd.biz.user.get({
    onSuccess : function(result) {
        /*
        {
            id: '112', //id
            emplId: '0573' //工号
        }
        */
    },
    onFail : function(err) {}
});
```
-->

<h2 id="导航栏">导航栏</h2>

<p>dd.biz</p>

<h3 id="设置左侧导航按钮">设置左侧导航按钮</h3>

<p>只支持iOS</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setLeft</span><span class="p">({</span>
    <span class="na">show</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span><span class="c1">//控制按钮显示， true 显示， false 隐藏， 默认true</span>
    <span class="na">control</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否控制点击事件，true 控制，false 不控制， 默认false</span>
    <span class="na">showIcon</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否显示icon，true 显示， false 不显示，默认true； 注：具体UI以客户端为准</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span><span class="c1">//控制显示文本，空字符串表示显示默认文本</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>show</td>
<td>Boolean</td>
<td>控制按钮显示， true 显示， false 隐藏， 默认true</td>
</tr>
<tr>
<td>control</td>
<td>Boolean</td>
<td>是否控制点击事件，true 控制，false 不控制， 默认false</td>
</tr>
<tr>
<td>showIcon</td>
<td>Boolean</td>
<td>是否显示icon，true 显示，false 不显示，默认true； 注：具体UI以客户端为准</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>控制显示文本，空字符串表示显示默认文本</td>
</tr>
</tbody></table>

<h3 id="设置右侧导航按钮">设置右侧导航按钮</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setRight</span><span class="p">({</span>
    <span class="na">show</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span><span class="c1">//控制按钮显示， true 显示， false 隐藏， 默认true</span>
    <span class="na">control</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否控制点击事件，true 控制，false 不控制， 默认false</span>
    <span class="na">showIcon</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否显示icon，true 显示， false 不显示，默认true； 注：具体UI以客户端为准</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'发送'</span><span class="p">,</span><span class="c1">//控制显示文本，空字符串表示显示默认文本          </span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>show</td>
<td>Boolean</td>
<td>控制按钮显示， true 显示， false 隐藏， 默认true</td>
</tr>
<tr>
<td>control</td>
<td>Boolean</td>
<td>是否控制点击事件，true 控制，false 不控制， 默认false</td>
</tr>
<tr>
<td>showIcon</td>
<td>Boolean</td>
<td>是否显示icon，true 显示，false 不显示，默认true； 注：具体UI以客户端为准</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>控制显示文本，空字符串表示显示默认文本</td>
</tr>
</tbody></table>

<p>可通过拼接url方式隐藏 showmenu=false</p>

<h3 id="设置标题">设置标题</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setTitle</span><span class="p">({</span>
    <span class="na">title</span> <span class="p">:</span> <span class="s1">'邮箱正文'</span><span class="p">,</span><span class="c1">//控制标题文本，空字符串表示显示默认文本</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*结构
        {
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>String</td>
<td>控制标题文本，空字符串表示显示默认文本</td>
</tr>
</tbody></table>

<h3 id="触发关闭">触发关闭</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">close</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*result结构
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h2 id="附录">附录</h2>

<h3 id="js-api权限签名算法">JS-API权限签名算法</h3>

<p>如果开发者想使用钉钉容器开放的jsapi接口，需要经过以下流程：</p>

<ul>
<li><p>首先需要<a href="#获取jsapi_ticket"><font color=red >获取jsapi_ticket</font></a>。</p></li>
<li><p>然后在web页面加载到钉钉容器时，通过<a href="#页面引入js文件"><font color=red >jsapi权限验证配置接口</font></a>验证可用的jsapi。这个接口使用的参数signature，在下文中有详细的说明。</p></li>
</ul>

<h4 id="1-获取jsapi_ticket">1.获取jsapi_ticket</h4>

<p>jsapi_ticket,是开发者调用钉钉JS接口的临时授权码，其作用主要用于生成签名，这个签名在<a href="http://open.dingtalk.com/#页面引入js文件"><font color=red >jsapi权限验证配置接口</font></a>中使用。</p>

<p>正常的情况下，jsapi_ticket的有效期为7200秒，通过access_token（注意，假如您是ISV开发者，这个access_token需要<a href="#8-获取企业授权的access_token"><font color=red >企业授权的access_token接口</font></a>）来获取。由于频繁刷新jsapi_ticket会导致api调用受限，影响自身业务，开发者必须在自己的服务全局缓存jsapi_ticket。
获取jsapi_ticket，具体可以<a href="#js接口api"><font color=red >参考文档</font></a></p>

<h4 id="2-签名生成算法">2.签名生成算法</h4>

<p>开发者在web页面使用钉钉容器提供的jsapi时，需要验证调用权限，并以参数signature标识合法性</p>

<p>签名生成的规则：</p>

<p>List keyArray = sort(noncestr,timestamp,jsapi_ticket,url);</p>

<p>String str = assemble(keyArray);</p>

<p>signature = sha1(str);</p>

<p>参与签名的字段包括在上文中获取的jsapi_ticket，noncestr（随机字符串，自己随便填写即可）,timestamp（当前时间戳，具体值为当前时间到1970年1月1号的秒数）,url（当前网页的URL，不包含#及其后面部分）。例如：</p>

<ul>
<li>noncestr=Zn4zmLFKD0wzilzM</li>
<li>jsapi_ticket=mS5k98fdkdgDKxkXGEs8LORVREiweeWETE40P37wkidkfksDSKDJFD5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcKIDU8l</li>
<li>timestamp=1414588745</li>
<li>url=http://open.dingtalk.com</li>
</ul>

<p>步骤1. sort()含义为对所有待签名参数按照字段名的ASCII 码从小到大排序（字典序）</p>

<p>步骤2. assemble()含义为根据步骤1中获的参数字段的顺序，使用URL键值对的格式（即key1=value1&amp;key2=value2…）拼接成字符串</p>

<p>步骤2. sha1()的含义为对在步骤2拼接好的字符串进行sha1加密。</p>

<h3 id="图片缩放">图片缩放</h3>

<p>通过JS-API获取的图片都支持缩放，比如图片：</p>

<p><code class="prettyprint">http://gtms02.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg</code></p>

<p>可通过文件名拼接的方法缩放为最大宽高为250x250的尺寸。</p>

<p><code class="prettyprint">http://gtms02.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg_250x250.jpg</code></p>

<p>拼接规则为:文件名+拼接规则；推荐使用以下拼接规则：</p>

<p>80x80 =&gt; _80x80.jpg</p>

<p>120x120 =&gt; _120x120.jpg</p>

<p>250x250 =&gt; _250x250.jpg</p>

<p>310x310 =&gt; _310x310.jpg</p>

<h3 id="容器能力">容器能力</h3>

<p><a href="#alert">device.notification.alert</a></p>

<p><a href="#confirm">device.notification.confirm</a></p>

<p><a href="#prompt">device.notification.prompt</a></p>

<p><a href="#vibrate">device.notification.vibrate</a></p>

<p><a href="#摇一摇">device.accelerometer.watchShake</a></p>

<p><a href="#摇一摇">device.accelerometer.clearShake</a></p>

<p><a href="#打开应用内页面">biz.util.open</a></p>

<p><a href="#分享">biz.util.share</a></p>

<p><a href="#ut打点">biz.util.ut</a></p>

<p><a href="#日期选择器">biz.util.datepicker</a> //android</p>

<p><a href="#日期选择器">biz.util.timepicker</a> //android</p>

<p><a href="#选人">biz.contact.choose</a></p>

<!--
[biz.user.get](#get)
-->

<p><a href="#设置左侧导航按钮">biz.navigation.setLeft</a></p>

<p><a href="#设置右侧导航按钮">biz.navigation.setRight</a></p>

<p><a href="#设置标题">biz.navigation.setTitle</a></p>

<p>// v0.0.1</p>

<p><a href="#toast">device.notification.toast</a></p>

<p><a href="#showpreloader">device.notification.showPreloader</a></p>

<p><a href="#hidepreloader">device.notification.hidePreloader</a></p>

<p><a href="#获取当前地理位置">device.geolocation.get</a></p>

<p><a href="#上传图片">biz.util.uploadImage</a></p>

<p><a href="#图片浏览器">biz.util.previewImage</a></p>

<p>//v0.0.2</p>

<p><a href="#输入框">ui.input.plain</a></p>

<p><a href="#actionsheet">device.notification.actionSheet</a></p>

<p><a href="#获取当前网络类型">device.connection.getNetworkType</a></p>

<p><a href="#获取容器信息">runtime.info</a></p>

<p>//v0.0.3</p>

<p><a href="#发钉">biz.ding.post</a></p>

<p><a href="#打电话">biz.telephone.call</a></p>

<p>//v0.0.4</p>

<p><a href="#创建企业群聊天">biz.contact.createGroup</a></p>

<p><a href="#日期选择器">biz.util.datetimepicker</a></p>

<p>//v0.0.5</p>

<p><a href="#下拉控件">biz.util.chosen</a></p>

<p><a href="#获取通用唯一识别码">device.base.getUUID</a></p>

<p><a href="#获取热点接入信息">device.base.getInterface</a></p>

<p><a href="#检测应用是否安装">device.launcher.checkInstalledApps</a></p>

<p><a href="#启动第三方应用">device.launcher.launchApp</a></p>

<p><a href="#设置顶部进度条颜色">ui.progressBar.setColors</a></p>

<p><a href="#获取免登授权码">runtime.permission.requestAuthCode</a></p>

<p><a href="#启用下拉刷新">ui.pullToRefresh.enable</a></p>

<p><a href="#收起下拉loading">ui.pullToRefresh.stop</a></p>

<p><a href="#禁用下拉刷新">ui.pullToRefresh.disable</a></p>

<p><a href="#启用bounce">ui.webViewBounce.enable</a></p>

<p><a href="#启用bounce">ui.webViewBounce.disable</a></p>

<p><a href="#触发关闭">biz.navigation.close</a></p>

<p>//0.0.6</p>

<p><a href="#扫码">biz.util.scan</a></p>

<p><a href="#选人，选部门">biz.contact.complexChoose</a></p>

<p>//0.0.7</p>

<p><a href="#获取会话信息">biz.chat.pickConversation</a></p>

<p>//0.0.8</p>

<p><a href="#modal">device.notification.modal</a></p>

<p><a href="#上传图片（仅支持拍照上传）">biz.util.uploadImageFromCamera</a></p>

<p>//0.0.11</p>

<p><a href="#根据corpid选择会话">biz.chat.chooseConversationByCorpId</a></p>

<p><a href="#根据chatid跳转到对应会话">biz.chat.toConversation</a></p>

          <h1 id="微应用体验优化">微应用体验优化</h1>

<h2 id="ui规范">UI规范</h2>

<p>对于钉钉中的微应用，要求能符合钉钉整体的UI规范。诸如字体，字号，颜色等。
<img alt="UI" src="https://img.alicdn.com/tps/TB1.yF4KpXXXXcBXpXXXXXXXXXX-601-281.jpg" /></p>

<p><a href="http://yunpan.taobao.com/s/k9w3LeGzmM"><font color=red>UI规范下载</font></a></p>

<h2 id="h5性能优化方案">H5性能优化方案</h2>

<p>对于一个H5的产品，功能无疑很重要，但是性能同样是用户体验中不可或缺的一环。原本H5的渲染性能就不及native的app，如果不把性能优化做起来，将极大地影响用户使用产品的积极性。所以我们提供了一份H5性能优化的方案，<a href="http://ddtalk.github.io/blog/2015/09/07/dingding-first/"><font color=red>地址</font></a>。</p>

<h2 id="微应用性能评测">微应用性能评测</h2>

<p>目前微应用性能评测流程还在优化阶段。<br></p>

<p>微应用的性能测验主要是对微应用的整体性能进行评分，这其中包括但不仅限于首屏打开时间等指标。<br></p>

<p>大概流程如下：<br></p>

<p>1、微应用进行性能评测前首先需要确保我们的测试帐号被加入到将要测验的企业里。目前的测试帐号有以下几个：<font color=blue > 13291824394, 15210137915，15810497158。 </font> <br></p>

<p>2、<a href="http://mqc.aliyun.com/hfive.htm?from=dingtalk">点击打开测验页面</a> <br></p>

<p>3、然后，按照提示，输入要测试的H5应用地址，下一步选择手机即可开始测验。<br></p>

<p>4、测验完成之后，就可以看到测试报告了。测试报告会给出被测试的微应用的整体打分。这个打分机制我们还在不断优化，后续会根据大家的case制定出一套完善的评分机制。测试报告同时会给出被测验的微应用需要优化的地方，开发者可以根据测试报告的优化建议进行相关优化，待优化完成可以再次发起测验流程，并查看报告。<br></p>

<h2 id="cdn">CDN</h2>

<p>钉钉开放平台为常用的js库提供了CDN加速服务，这样做不仅可以为您节省流量，还可以获得更快的访问速度。</p>

<h3 id="backbone">backbone</h3>

<p><a href="http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone-min.js">http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone-min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone.js">http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone.js</a></p>

<h3 id="jquery">jquery</h3>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.min.js">http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.js">http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.min.js">http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.js">http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.js</a></p>

<h3 id="underscore">underscore</h3>

<p><a href="http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore-min.js">http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore-min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore.js">http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore.js</a></p>

<h3 id="zepto">zepto</h3>

<p><a href="http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.min.js">http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.js">http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.js</a></p>

          <h1 id="调试工具">调试工具</h1>

<ul>
<li><p><a href="https://debug.dingtalk.com"><font color=red >钉钉服务端API调试工具</font></a></p></li>
<li><p><a href="https://debug.dingtalk.com/isv.html"><font color=red >ISV接入调试工具</font></a></p></li>
<li><p><a href="http://wsdebug.dingtalk.com/"><font color=red >JSAPI调试工具</font></a>（打开页面后，手机扫描二维码，然后在页面上配置参数，即可调试）</p></li>
</ul>

          <h1 id="团队博客">团队博客</h1>

<p>钉钉开放平台团队建立了一个博客，以提供更加详细的关于钉钉开放平台的信息，帮助钉钉开发者更好的进行开发</p>

<p>如有兴趣，请查看：<a href="http://ddtalk.github.io/blog/"><font color=red>地址</font></a></p>

          <h1 id="faq">FAQ</h1>

<h3 id="q-从哪里可以获得corpid和corpsecret">Q:从哪里可以获得CorpID和CorpSecret?</h3>

<p>A:在钉钉管理后台的微应用设置页面可以获取，详细方法请参见<a href="#获取corpid和corpsecret"><font color=red >《接入指南-获取CorpID和CorpSecret》</font></a>。</p>

<h3 id="q-调用管理通讯录接口返回430004，无效的http-header-content-type如何解决？">Q:调用管理通讯录接口返回430004，无效的HTTP HEADER Content-Type如何解决？</h3>

<p>A:管理通讯录的部分接口采用了POST请求，请求体使用JSON格式，请在HTTP请求头中设置Content-Type:application/json。</p>

<h3 id="q-如何试用套件">Q:如何试用套件</h3>

<p>A:参见<a href="http://download.taobaocdn.com/freedom/31112/pdf/p1a01o2gfr4q811go5fq19i5ni14.pdf"><font color=red >套件试用流程</font></a></p>

<h3 id="q-部署阿里云ssl证书出现问题如何解决？">Q:部署阿里云ssl证书出现问题如何解决？</h3>

<p>A:参见<a href="http://ddtalk.github.io/blog/2015/09/24/dingtalk/"><font color=red >阿里云证书配置-slb（负载均衡）</font></a></p>

<h3 id="q-jsapi权限校验时返回-message-quot-权限校验失败-quot-，errorcode-3">Q:jsapi权限校验时返回{message:&ldquo;权限校验失败&quot;，errorCode:3}</h3>

<p>A:首先检查用来生成签名(signature)的jsapi_ticket是否过期（jsapi_ticket有效期为7200秒，而且当你请求了新的ticket之后，旧的ticket就失效了）。</p>

<p>然后检查生成签名的Url参数，与调用dd.config 所在的url是否一致</p>

<p>可以使用<a href="https://debug.dingtalk.com"><font color=red >调试工具</font></a>来生成jsapi_ticket和signature，并和你实际使用的进行对比。</p>

<h3 id="q-上传文件不成功">Q:上传文件不成功</h3>

<p>A:使用multipart/form-data请求上传文件，需要附加文件标示信息，参数名为media，java示例代码为</p>

<p><code class="prettyprint">
HttpEntity requestEntity =MultipartEntityBuilder.create().addPart(&quot;media&quot;,
new FileBody(file, ContentType.APPLICATION_OCTET_STREAM, file.getName())).build();
</code></p>

<h3 id="q-isv如何在app及后台获取企业及用户相关信息">Q:ISV如何在App及后台获取企业及用户相关信息</h3>

<p>A:微应用主页支持使用$CORPID$模板参数表示corpid，用户访问微应用的时候钉钉将把$CORPID$替换成用户所属企业的corpid，例如http://www.dingtalk.com/index?corpid=$CORPID$。</p>

<p>获取用户信息请参考<a href="#免登服务"><font color=red >免登服务</font></a></p>

<h3 id="q-isv接入回调接口没有suiteticket推送，为什么？">Q:ISV接入回调接口没有suiteticket推送，为什么？</h3>

<p>A:当你注册套件之后，钉钉服务器会向你填写的回调接口推送suite_ticket。接收到推送之后需要返回加密后的字符串“success”,如果不返回，钉钉服务器将连续推送，直到推送次数超过100次，就不再推送。
此时您需要进入<a href="http://console.d.aliyun.com"><font color=red>开发者后台</font></a>，进入套件管理页面，点击『重新推送』按钮，即可重新推送。
<img alt="repush" src="https://img.alicdn.com/tps/TB15j7OJFXXXXckXXXXXXXXXXXX-1121-124.jpg" /></p>

<h3 id="q-isv套件回调url验证有效性失败">Q:ISV套件回调url验证有效性失败</h3>

<p>A:在填写套件回调url的时候，需要ISV填写回调url是可用的。</p>

<p>钉钉服务器通过向回调url推送一条『验证回调URL有效性事件』来判断回调url是否可用，具体流程请参见<a href="#5-回调接口（分为五个回调类型）"><font color=red>回调接口</font></a></p>

<h3 id="q-不存在的临时授权码">Q:不存在的临时授权码</h3>

<p>当您通过临时授权码(tmp_auth_code)和套件token(suite_access_token)去换取永久授权码(permanent_code)之时，需要保证suite_access_token,tmp_auth_code都没有过期。</p>

<h3 id="q-钉钉发送会话消息时候，cid怎么获取">Q:钉钉发送会话消息时候，cid怎么获取?</h3>

<p>A:请查看
<a href="#获取会话信息"><font color=red>jsapi-获取会话信息</font></a>。</p>

<p>使用场景示例:用户在微应用中拉起本地聊天窗口列表(通过调用jsapi-获取会话信息)，选择某一个聊天窗口，微应用将收到钉钉返回的cid，通过这个cid会送会话消息。</p>

<p>如果希望在后台直接发送消息，请查看服务端开发文档-<a href="#发送企业会话消息"><font color=red>发送企业会话消息</font></a>。</p>

<h3 id="q-新增部门和员工信息为中文时，创建不成功">Q:新增部门和员工信息为中文时，创建不成功</h3>

<p>A:请检查编码格式，需要是UTF-8编码</p>

<h3 id="q-使用jsapi返回签名或者ticket获取失败">Q:使用JSAPI返回签名或者Ticket获取失败</h3>

<p>A:JSAPI返回失败主要有两种错误</p>

<p>[<font color=red >错误码:52011</font>] [jsapi ticket 读取失败]</p>

<p>1)确认agentId参数正确传入</p>

<p>2)确认以传入agentId对应的企业身份获取过jsapi_ticket,也就是调用过get_jsapi_ticket方法</p>

<p>3)确认agentId对应的企业身份获取的jsapi_ticket没有过期.即在两个小时的有效期之内</p>

<p>[<font color=red >错误码:52013</font>][签名校验失败]   </p>

<p>1)确认agentId参数正确传入</p>

<p>2)确认获得的jsapi_ticket为最新的,没有其他服务同时调用get_jsapi_ticket方法,导致生成签名的jsapi_ticket过期</p>

<p>3)确认生成jsapi签名正确,可以使用debug工具进行调试https://debug.dingtalk.com/      </p>

<h3 id="q-开发遇到困难怎样反馈给你们">Q:开发遇到困难怎样反馈给你们?</h3>

<p>A:我们目前在阿里云开发者论坛开放了一个<a href="http://bbs.aliyun.com/thread/276.html?spm=5176.7189909.0.0.bq46VP"><font color=red >钉钉开放平台</font></a>模块，你可以按照以下格式发帖到这个模块，我们会定期搜集和解决。</p>

<p>请编辑如下信息，发到论坛，这样便于快速解决问题。</p>

<table><thead>
<tr>
<th>企业完整名称</th>
<th>例如 阿里巴巴</th>
</tr>
</thead><tbody>
<tr>
<td>访问接口的路径</td>
<td>例如 https://oapi.dingtalk.com/gettoken，不需要把token之类的信息附上</td>
</tr>
<tr>
<td>输入参数</td>
<td>需要提供CorpId，不需要提供AccessToken及CorpSecret</td>
</tr>
<tr>
<td>发起请求的服务器的外网IP地址</td>
<td></td>
</tr>
<tr>
<td>发起请求的时间点</td>
<td>例如 2015-6-16 10:03:50</td>
</tr>
<tr>
<td>返回的错误结果</td>
<td>例如 系统繁忙</td>
</tr>
</tbody></table>

          <h1 id="更新日志">更新日志</h1>

<ul>
<li><p>2015.11.19 <a href="#根据corpid选择会话"><font color=red >增加会话JSAPI接口</font></a></p></li>
<li><p>2015.11.19 <a href="#群会话接口（暂未开放）"><font color=red >增加群会话接口</font></a></p></li>
<li><p>2015.11.13 <a href="#oa后台管理员调用免登"><font color=red >增加OA后台管理员免登</font></a></p></li>
<li><p>2015.11.12 <a href="#ding"><font color=red >dd.biz.ding.post 增加参数</font></a></p></li>
<li><p>2015.11.5 <a href="#管理通讯录"><font color=red >通讯录接口增加参数</font></a></p></li>
<li><p>2015.10.16 <a href="#通用"><font color=red >更新客户端文档引入javascript文件版本</font></a></p></li>
<li><p>2015.10.10 <a href="#创建部门"><font color=red >创建部门和更新部门新增参数</font></a></p></li>
<li><p>2015.9.25 <a href="#5-回调接口（分为五个回调类型）"><font color=red >增加验证回调URL有效性事件和套件信息更新事件</font></a></p></li>
<li><p>2015.9.11 <a href="#通讯录变更事件回调接口"><font color=red >增加通讯录事件回调接口</font></a></p></li>
<li><p>2015.9.8 <a href="#%E2%1FZ%A2"><font color=red >增加团队博客</font></a></p></li>
<li><p>2015.9.6 <a href="#jsapi%03%D5%E5w"><font color=red >增加JS-API调试工具</font></a></p></li>
<li><p>2015.9.6 <a href="#上传图片（仅支持拍照上传）"><font color=red >增加biz.util.uploadImageFromCamera接口</font></a></p></li>
<li><p>2015.8.28 <a href="#isv接入调试工具"><font color=red >增加ISV接入调试工具</font></a></p></li>
<li><p>2015.8.25 <a href="#5-回调接口（分为三个回调类型）"><font color=red >增加回调接口加解密库和对应加解密demo</font></a></p></li>
<li><p>2015.8.20 <a href="#钉钉服务端API调试工具"><font color=red >增加钉钉服务端API调试工具</font></a></p></li>
<li><p>2015.8.6 <a href="#合作伙伴接入"><font color=red >增加合作伙伴(ISV服务提供商)接入阿里云的指南</font></a></p></li>
</ul>

      </div>
    </div
  </body>
</html>
