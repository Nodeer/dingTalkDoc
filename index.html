
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>钉钉开放平台</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <link href="stylesheets/nav.css" rel="stylesheet" type="text/css" media="nav" />
    <script src="./javascripts/jquery.min.js" type="text/javascript"></script>
      <script src="javascripts/all_nosearch.js" type="text/javascript"></script>
  </head>

  <body class="index">

	  <div class="navbar-container">
      <nav class="navbar"  id="top-nav">
        <a class="logo-container" href="/">
	      <div class="logo" style="font-family:'Microsoft Yahei','SimHe','SimSun'"></div>
	      </a>
        <ul>
          <li><a href="#概述">概述</a></li>
          <li><a href="#接入指南">接入指南</a></li>
          <li><a href="#服务端开发文档">服务端开发文档<b class="caret"></b></a>
          </li>
          <li><a href="#客户端开发文档">客户端开发文档<b class="caret"></b></a>
          </li>
          <li><a href="#faq">FAQ</a></li>
        </ul>
      </nav>
    </div>





    <a href="#" id="nav-button">
      <span>
        菜单
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="概述">概述</h1>

<p>欢迎您成为钉钉开放平台的开发者。</p>

<p>钉钉是阿里巴巴专为中小企业和团队打造的沟通、协同的多端平台，钉钉开放平台旨在为企业提供更为丰富的办公协同解决方案。通过钉钉开放平台，企业或第三方合作伙伴可以帮助企业快速、低成本的实现高质量的移动微应用，实现生产、管理、协作、运营的移动化。钉钉开放平台依托阿里巴巴多年的技术积累，建立业界一流的开放技术体系，帮助每一位开发者，提升开发效率，降低开发成本与难度。钉钉开放平台能帮助您获得更多的商业机会，服务更多的企业客户，从而不断的提升你的价值。</p>

<p>当您成功注册为开发者，可以通过本文档所描述的接口创建钉钉微应用，为企业实现更多丰富且个性化的企业移动应用。</p>

<p>开发者可以通过以下方式了解更多关于钉钉开放平台的消息：</p>

<ul>
<li><a href="http://bbs.aliyun.com/thread/276.html?spm=5176.7189909.0.0.bq46VP"><font color=red >开发者论坛</font></a></li>
<li>邮件组: open-dingtalk@list.alibaba-inc.com</li>
</ul>

          <h1 id="企业接入指南">企业接入指南</h1>

<p>企业接入指南重点介绍使用钉钉开放平台的开发微应用的流程，帮助企业快速接入钉钉开放平台。该节主要分为四个部分：第一部分介绍企业接入钉钉开放平台的准备工作；第二部介绍如何访问开放平台服务端接口；第三部分介绍钉钉开放平台提供的员工身份验证流程；第四部分介绍发送消息到微应用会话。</p>

<p><br /></p>

<h2 id="开发环境准备">开发环境准备</h2>

<p>开发者在使用钉钉开放平台开发微应用前需做好以下准备：</p>

<ul>
<li>获取钉钉开放平台开发者信息；</li>
<li>服务端环境搭建和域名注册；</li>
<li>开发环境搭建；</li>
</ul>

<p>开发者可以从 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 获取必要的信息用于微应用开发，还可以利用该系统完成微应用配置相关的工作；开发者可以自己搭建服务器也可以购买云主机来搭建自己的服务端环境，开发者需要为自己的微应用注册合法有效的域名并配置在 <a href="https://oa.dingtalk.com/#/microApp/microAppList"><font color=red >应用中心</font></a> ；钉钉开放平台的服务端接口不区分语言和平台，开发者可以使用自己熟悉的技术搭建开发环境来开发微应用。</p>

<p><a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 系统为企业提供了企业通讯录管理、微应用、安全中心、员工数据统计和系统常用设置等功能。</p>

<p><img alt="oa_system.jpg" src="https://img.alicdn.com/tps/TB1b4jcJFXXXXXOXpXXXXXXXXXX-666-421.jpg" /></p>

<p><strong>钉钉管理后台管理员（以下简称钉钉后台管理员）</strong> 在企业通讯录管理页面可以完成企业的组织结构和员工个人信息的添加、删除、查看和修改等操作；在微应用管理页面可以完成添加和删除微应用，获取CorpID和CorpSecret(接入钉钉开放平台的凭证)，查看微应用相关信息，管理微应用的运行状态等。开发者在使用该系统前需要注册成为钉钉后台管理员或者由钉钉后台管理员分配管理员子帐号。</p>

<h2 id="创建微应用">创建微应用</h2>

<p>一、进入 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 页面, 点击 <a href="https://oa.dingtalk.com/register.html?spm=0.0.0.0.dL51oc"><font color=red >企业注册</font></a>；（已经注册可跳过此步骤）</p>

<p><img alt="enterprise_register_entry" src="https://img.alicdn.com/tps/TB14kI8IFXXXXciapXXXXXXXXXX.jpg" /></p>

<p>二、填写注册手机号码和短信验证码；</p>

<p>三、输入企业基本信息和管理员帐号和密码，点击 <em>注册</em> 按钮完成注册过程。</p>

<p><img alt="input_enterprise_info" src="https://img.alicdn.com/tps/TB1bru8JFXXXXXcXFXXXXXXXXXX-1171-807.png" /></p>

<aside class="notice">
通过钉钉移动客户端创建的企业默认没有设置钉钉后台管理员，需要通过以上流程注册管理员帐号。
</aside>

<h3 id="分配管理员子账号：">分配管理员子账号：</h3>

<p>一、登录钉钉后台管理系统，按下图进入安全中心的添加管理员子帐号页面；</p>

<p><img alt="add_sub_manager" src="https://img.alicdn.com/tps/TB1Q3DiJFXXXXbkXXXXXXXXXXXX-1147-377.png" /></p>

<p>二、按下图提示填写子帐号信息</p>

<p><img alt="set_sub_manager_account" src="https://img.alicdn.com/tps/TB16euYJFXXXXcRXFXXXXXXXXXX-601-336.png" /></p>

<p>完成管理员子帐号设置后，子帐号关联的钉钉用户会在钉钉客户端的 <em>钉小秘</em> 会话中收到管理员帐号和初始密码，该钉钉用户可以通过收到的帐号和密码登录 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 进入安全中心对初始密码进行修改。</p>

<h3 id="微应用管理和创建">微应用管理和创建</h3>

<p>登录钉钉管理后台后可以进入 <em>应用中心</em> 页面对微应用进行运行状态管理，进入微应用后台，微应用信息查看与设置，微应用添加和删除等操作。</p>

<p><img alt="enter_microapp_center" src="https://img.alicdn.com/tps/TB1lnfcJFXXXXc6XXXXXXXXXXXX-1110-783.png" /></p>

<p>点击 <em>新增微应用</em> 按钮，按下图填写微应用信息，点击确定后可以新增微应用。</p>

<p><img alt="add_micro_app" src="https://img.alicdn.com/tps/TB1Qe_XJFXXXXalXpXXXXXXXXXX-598-477.png" /></p>

<p><em>首页地址</em> : 以<code class="prettyprint">http://</code>或者<code class="prettyprint">https://</code> 开头的URL，是微应用的首页地址；在移动设备上打开微应用Tab页，点击微应用列表中的微应用将访问这个URL指向的页面。</p>

<p><em>后台地址</em> : 以<code class="prettyprint">http://</code>或者<code class="prettyprint">https://</code> 开头的URL，是微应用的后台管理页面地址；配置后台地址后可以通过应用中心页面进入到微应用的管理后台。</p>

<aside class="notice">
<b>首页地址</b> 的URL域名务必保证真实有效，否则会导致钉钉用户无法正常使用微应用。
</aside>

<p>每个微应用都有 <em>设置</em> 选项，点击后进入微应用的设置页面，开发者可以在这里修改微应用的常用信息设置</p>

<p><img alt="get_micro_app_agentID" src="https://img.alicdn.com/tps/TB1N490JFXXXXceXFXXXXXXXXXX-602-524.png" /></p>

<p>开发者在应用中心创建微应用后，如上图所示可获取到微应用的AgentID，AgentID可用于发送企业会话消息等场景。</p>

<p>开发者完成以上准备工作后就可以进入开发阶段。</p>

<p><br /></p>

<p>创建成功之后将会在手机的工作tab上显示出来</p>

<p><img alt="createMi" src="https://img.alicdn.com/tps/TB1xStVKpXXXXbjXFXXXXXXXXXX-361-640.jpg" /></p>

<h2 id="使用免登服务">使用免登服务</h2>

<p>假如在进入微应用的时候需要获取当前用户的信息，可以使用免登服务，实现账户打通。详细文档请参阅<a href="#免登服务"><font color=red >免登服务</font></a>。</p>

<p><br /></p>

<h2 id="调用平台接口">调用平台接口</h2>

<p>开发者在调用钉钉开放平台接口时需要附加AccessToken，AccessToken可以通过CorpID和CorpSecret获取。</p>

<h3 id="获取corpid和corpsecret">获取CorpID和CorpSecret</h3>

<p>CorpID是企业的唯一标识，获取CorpID和CorpSecret的步骤如下:</p>

<p>一、使用管理员帐号登录 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> ；</p>

<p>二、选择顶部菜单 <strong>微应用</strong> 进入微应用页面，在左侧菜单选择 <strong>微应用设置</strong> 进入微应用设置页；</p>

<p>三、在微应用设置页面底部点击 <strong>获取</strong> 按钮即可获取CorpID和CorpSecret。</p>

<p><img alt="get_scecret_corpId" src="https://img.alicdn.com/tps/TB1xStVKpXXXXbjXFXXXXXXXXXX-361-640.jpg" /></p>

<aside class="notice">
钉钉开放平台提供了获取和修改企业(团队)的组织结构信息、人员信息等功能，所以请妥善保管CorpID和CorpSecret，避免外泄影响企业信息安全。
</aside>

<h3 id="获取accesstoken">获取AccessToken</h3>

<p>开发者在调用开放平台接口前需要通过CorpID和CorpSecret获取AccessToken。获取AccessToken的方法是向 <code class="prettyprint">https://oapi.dingtalk.com/gettoken?corpid=id&amp;corpsecret=secrect</code> GET请求。</p>

<p>开发者获取AccessToken后便可以调用开放平台其他接口。</p>

<p>以获取部门列表接口为例，获取部门列表接口为：</p>

<p><code class="prettyprint">oapi.dingtalk.com/department/list</code></p>

<p>在请求该接口时，需要将获取的AccessToken作为请求参数拼装到URL中：</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/list?access_token=ACCESS_TOKEN</code></p>

<p>更多关于AccessToken的信息请参考<a href="#建立连接"><font color=red >《服务端开发文档-建立连接》</font></a>一节。</p>

<p><br /></p>

<h2 id="发送企业会话消息">发送企业会话消息</h2>

<p>用户可以在企业会话中查看微应用发送的消息，开发者可以通过发送消息接口将消息发送到企业会话中。</p>

<p><img alt="send_micro_app_message" src="https://img.alicdn.com/tps/TB1X.m6JFXXXXX0XFXXXXXXXXXX-1089-652.jpg" /></p>

<p>调用消息发送接口时需要使用<code class="prettyprint">HTTPS</code>协议，发送的数据包为<code class="prettyprint">JSON</code>格式。目前钉钉开放平台支持文本、图片、声音、文件、链接、办公消息等消息类型。</p>

<h3 id="示例程序">示例程序</h3>

<p>在<a href="#demo"><font color=red >《Open API - 代码示例》</font></a>中有发送消息的代码演示，开发者可以下载参考。</p>

<p>如果在使用开放平台中遇到困难请浏览<a href="#faq"><font color=red >《常见问题》</font></a>一节，若仍不能解决请按概述中的提供的反馈方式联系我们。</p>

          <h1 id="isv接入指南">ISV接入指南</h1>

<p>钉钉开放平台提供了<strong>企业通讯录管理、文件管理、发送企业会话消息</strong>等功能，接口使用可以参考<a href="#服务端开发文档"><font color=red >服务端开发文档</font></a>；</p>

<p>我们定制了微应用专用的运行容器，提供了一组可以调用<strong>钉钉的本地能力和业务逻辑</strong>的JS接口，开发者可以通过这些接口使用钉钉的本地能力或者钉钉的业务逻辑，降低开发成本，提高微应用在移动客户端的体验。接口使用可以参考<a href="#客户端开发文档"><font color=red >客户端开发文档</font></a>。</p>

<p>该指南主要介绍了企业和ISV（服务提供商）如何接入钉钉开放平台，其中涉及到接入过程中使用的工具、与钉钉开放平台相关的概念和接入钉钉开放平台的一些实践方法，以帮助开发者快速开发自己的微应用。</p>

<h2 id="接入准备">接入准备</h2>

<p>开发者在使用钉钉开放平台开发微应用前需做好以下准备：</p>

<ul>
<li>注册钉钉企业；</li>
<li>服务端环境搭建和域名注册；</li>
<li>开发环境搭建；</li>
</ul>

<h3 id="注册钉钉企业账号">注册钉钉企业账号</h3>

<p>一、进入 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 页面, 点击 <a href="https://oa.dingtalk.com/register.html?spm=0.0.0.0.dL51oc"><font color=red >企业注册</font></a>；（已经注册可跳过此步骤）</p>

<p><img alt="enterprise_register_entry" src="https://img.alicdn.com/tps/TB14kI8IFXXXXciapXXXXXXXXXX.jpg" /></p>

<p>二、填写注册手机号码和短信验证码；</p>

<p>三、输入企业基本信息和管理员帐号和密码，点击 <em>注册</em> 按钮完成注册过程。</p>

<p><img alt="input_enterprise_info" src="https://img.alicdn.com/tps/TB1bru8JFXXXXXcXFXXXXXXXXXX-1171-807.png" /></p>

<aside class="notice">
通过钉钉移动客户端创建的企业默认没有设置钉钉后台管理员，需要通过以上流程注册管理员帐号。
</aside>

<h4 id="分配管理员子账号：">分配管理员子账号：</h4>

<p>一、登录钉钉后台管理系统，按下图进入安全中心的添加管理员子帐号页面；</p>

<p><img alt="add_sub_manager" src="https://img.alicdn.com/tps/TB1Q3DiJFXXXXbkXXXXXXXXXXXX-1147-377.png" /></p>

<p>二、按下图提示填写子帐号信息</p>

<p><img alt="set_sub_manager_account" src="https://img.alicdn.com/tps/TB16euYJFXXXXcRXFXXXXXXXXXX-601-336.png" /></p>

<p>完成管理员子帐号设置后，子帐号关联的钉钉用户会在钉钉客户端的 <em>钉小秘</em> 会话中收到管理员帐号和初始密码，该钉钉用户可以通过收到的帐号和密码登录 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 进入安全中心对初始密码进行修改。</p>

<h3 id="服务端环境搭建和域名注册">服务端环境搭建和域名注册</h3>

<p>开发者可以自己搭建服务器也可以购买云主机来搭建自己的服务端环境，开发者需要为自己的微应用注册合法有效的域名</p>

<h3 id="开发环境搭建">开发环境搭建</h3>

<p>钉钉开放平台的服务端接口不区分语言和平台，开发者可以使用自己熟悉的技术搭建开发环境来开发微应用</p>

<p>至此，您已经完成了准备工作。</p>

<p>假如你是企业用户，要为自己的公司开发微应用，查看<a href="#企业接入"><font color=red >企业接入</font></a>。</p>

<p>假如你是ISV(服务提供商)，作为第三方要给其他公司提供微应用，先查看<a href="#isv接入"><font color=red >ISV接入</font></a>。</p>

<h2 id="isv接入整体流程">ISV接入整体流程</h2>

<p><img alt="ISV process" src="https://img.alicdn.com/tps/TB1fDX4LXXXXXa2XpXXXXXXXXXX-1009-367.png" /></p>

<h3 id="isv接入说明">ISV接入说明</h3>

<p>ISV接入钉钉后有2种选择：</p>

<ul>
<li><p>套件通过钉钉应用中心推广（精品套件），符合接入<a href="#isv接入整体流程"><font color=red>整体流程</font></a>中的要求，并满足<a href="#标准规范"><font color=red>标准规范</font></a>中的要求，需要通过钉钉应用中心推广必须与钉钉进行商务洽谈，商务洽谈联系方式：<a href="#商务洽谈"><font color=red>商务洽谈</font></a></p></li>
<li><p>套件通过ISV线下推广，可以通过2种方式进行操：</p></li>
</ul>

<p>1.通过企业接入的方式，为企业单独进行接入</p>

<p>2.通过钉钉快速部署进行实施，详细内容见<a href="#钉钉快速部署指南"><font color=red>钉钉快速部署指南</font></a>中的描述。使用此方式需满足<a href="#标准规范"><font color=red>标准规范</font></a>中的要求，钉钉团队会进行质量验收，其它项由ISV自己负责，如果接收到用户的投诉，钉钉保留对ISV的处罚权利</p>

<h3 id="商务洽谈">商务洽谈</h3>

<p>ISV联系钉钉ISV接入接口人进行合作洽谈，更多信息请通过联系方式：angle.lixy@alibaba-inc.com 进行</p>

<h3 id="钉钉快速部署指南">钉钉快速部署指南</h3>

<h4 id="isv接入准备">ISV接入准备</h4>

<p>1.ISV使用快速部署必须先实现<a href="#isv套件对企业独立部署方案"><font color=red>ISV套件对企业独立部署方案</font></a></p>

<p>2.ISV需要在云市场提交商品审核，套件上架流程详见：<a href="#套件上架操作流程"><font color=red>套件上架流程</font></a></p>

<p>3.ISV在接入之前需要通过联系钉钉ISV接入接口人获取ISV企业邀请码，联系方式：angle.lixy@alibaba-inc.com</p>

<p>4.填写“ISV线下快速部署申请表”，发送到open-dingtalk@list.alibaba-inc.com申请， 审核通过后，钉钉小二会发送链接&amp;二维码给ISV, ISV可以生成H5页面，分享给用户扫码或者点击下载<a href="http://download.taobaocdn.com/freedom/30712/xls/p1a7c2m1e71q9e8me125a118d1npe4.xls"><font color=red>ISV线下快速部署申请表</font></a></p>

<p><img alt="Application Form" src="https://img.alicdn.com/tps/TB1c3uBLXXXXXaNXXXXXXXXXXXX-802-571.png" /></p>

<p>填写说明：</p>

<table><thead>
<tr>
<th>栏位</th>
<th>填写要求</th>
</tr>
</thead><tbody>
<tr>
<td>服务商名称</td>
<td>必填，阿里云市场注册的服务商全名</td>
</tr>
<tr>
<td>套件名称</td>
<td>必填，ISV提交商品审核的套件全称，套件上架流程详见<a href="#套件上架操作流程"><font color=red>套件上架流程</font></a></td>
</tr>
<tr>
<td>邀请码</td>
<td>必填，钉钉ISV接入接口人分配的ISV企业邀请码</td>
</tr>
<tr>
<td>申请快速部署原因</td>
<td>必填，需要申明使用此方案的原因、使用场景信息</td>
</tr>
<tr>
<td>是否有现场实施人员</td>
<td>必填，是否有现场实施人员支持，如没有，注明通过什么方式分享二维码</td>
</tr>
<tr>
<td>通讯录导入方式</td>
<td>必填，选择isv引入的企业用户通过哪种方式维护通讯录，如：由企业管理员通过钉钉OA后台导入（），通过钉钉手机端创建团队；ISV现有系统通过钉钉接口导入等</td>
</tr>
<tr>
<td>是否申请自定义手机“工作”tab界面</td>
<td>必填，钉钉手机端的工作界面可以为ISV定义：手机工作界面   1. Banner：ISV通过发布带图片公告的形式，实现banner页效果 2. 套件排序置顶 3. 手机工作界面tab名称定义为ISV套件名称，例如由工作改为“XXX”</td>
</tr>
<tr>
<td>申请定义手机“工作”tab界面原因</td>
<td>不必填，咨询钉钉ISV接入接口人</td>
</tr>
<tr>
<td>是否验证应用序列号</td>
<td>必填，应用序列号由ISV生成并颁发给客户，以证明客户具备线下开通微应用的正版权益；该步骤是否必须可以配置。举例： ISV 通过自有渠道，售卖了一套微应用给客户A，客户A扫码可以快速创建团队并开通应用，如果该二维码分享给了B，B也可以通过扫码开通应用，而B实际并未支付费用，为避免此问题，ISV可以发给A客户唯一的序列号，A客户扫码后，必须输入序列号并得到ISV验证，才可开通应用</td>
</tr>
<tr>
<td>套件icon</td>
<td>必填，引导页面需要套件icon，规格120*120，圆角，请在“套件icon”sheet页进行上传</td>
</tr>
<tr>
<td>手机“工作”tab命名</td>
<td>如需申请“工作”tab名称自定义，则必填，“工作”tab名称可以重命名，支持4个汉字</td>
</tr>
<tr>
<td>公告</td>
<td>如需申请“工作”tab界面自定义，则必填，工作界面的banner通过发布带图片公告的形式展现，需要填写发送公告所在企业的corp_id和公告标题；公告路径：https://app.dingtalk.com/#/app/blackboard/create，图片推荐尺寸： 640*380</td>
</tr>
<tr>
<td>是否需要团队链接,用于发送邀请</td>
<td>必填，开通微应用时，程序会自动生成团队链接发给ISV，ISV得到团队链接可以通过邮件或者短信发送邀请，如需团队链接，请注明邀请方式</td>
</tr>
</tbody></table>

<p>5.如果需要定义不同的任务或者其他特殊需求，请提前在开发阶段，向接口的钉钉小二提出产品需求（任务：见产品主体流程中描述的开通步骤，每个步骤称为一个任务）</p>

<h4 id="产品主体流程">产品主体流程</h4>

<p><img alt="ksbs_process" src="https://img.alicdn.com/tps/TB1xcWaLXXXXXcIXVXXXXXXXXXX-863-585.png" /></p>

<p>实施步骤：</p>

<ol>
<li>安装钉钉，并且完成注册，请使用以下二维码和链接，让客户扫码，打开下载钉钉地址：
http://s.dingtalk.com/market/dingtalk/download.php?lwfrom=20151223115042450</li>
</ol>

<p><img alt="DD_QRcode" src="https://img.alicdn.com/tps/TB1HeydLXXXXXaJXVXXXXXXXXXX-584-584.png" /></p>

<p>2.提交快速部署后，钉钉工作人员会通过邮件，发送套件二维码给ISV, 客户通过钉钉手机端上的扫码工具，扫描进入快速部署引导页</p>

<p><img alt="DD_ksbs1" src="https://img.alicdn.com/tps/TB1n7qhLXXXXXXhXVXXXXXXXXXX-427-640.png" /></p>

<p>3.创建团队：配置可以选择创建1人团队（大于等于1人），或多人团队（大于等于6人），</p>

<p>➢1人团队：适合人数较多团队，需要通过钉钉OA管理后台表格导入，或者</p>

<p>➢多人团队：适合人数较少团队，便于在钉钉手机端上，创建团队</p>

<p><img alt="DD_ksbs2" src="https://img.alicdn.com/tps/TB17wWoLXXXXXcTXpXXXXXXXXXX-394-652.png" /></p>

<p>4.开通微应用：分为3步：：输入应用序列号－立即授权－使用范围设置</p>

<p>4.1  输入应用序列号： 应用序列号由ISV生成并颁发给客户，以证明客户具备线下开通微应用的正版权益；该步骤是否必须可以配置</p>

<p>➢ISV通过openapi /service/get_auth_info 获取授权信息，应用序列号即在返回数据中</p>

<p>➢/service/get_auth_info接口具体信息请参考 <a href="#6-获取企业授权的授权数据"><font color=red>获取企业授权的授权数据</font></a></p>

<p><img alt="DD_ksbs3" src="https://img.alicdn.com/tps/TB18Hx9LXXXXXbeaXXXXXXXXXXX-427-706.png" /></p>

<p>4.2：立即授权</p>

<p><img alt="DD_ksbs4" src="https://img.alicdn.com/tps/TB1Ic9CLXXXXXaxXXXXXXXXXXXX-438-720.png" /></p>

<p>4.3：设置使用范围，设置微应用哪些员工可以使用</p>

<p><img alt="DD_ksbs5" src="https://img.alicdn.com/tps/TB1iV5nLXXXXXcaXpXXXXXXXXXX-449-780.png" /></p>

<p>4.4 开始使用， 用户点击“开始使用”可以进入手机端工作界面页</p>

<p><img alt="DD_ksbs6" src="https://img.alicdn.com/tps/TB190CBLXXXXXa.XXXXXXXXXXXX-450-729.png" />
<img alt="DD_ksbs7" src="https://img.alicdn.com/tps/TB17ceELXXXXXXtXXXXXXXXXXXX-504-702.png" /></p>

<p>4.5  开通授权后，isv可获取团队邀请链接，团队邀请链接处理逻辑</p>

<p>➢isv通过openapi /service/get_auth_info 获取授权信息，团队邀请链接即在返回数据中</p>

<p>➢/service/get_auth_info接口具体信息请参考<a href="#6-获取企业授权的授权数据"><font color=red>获取企业授权的授权数据</font></a></p>

<h2 id="注册钉钉开发者">注册钉钉开发者</h2>

<h3 id="描述（description）">描述（Description）</h3>

<p>阿里云用户登录后，在通过实名认证的情况下，填写相关信息，完成开发者的身份申请。</p>

<h3 id="前置条件（pre-conditions）">前置条件（Pre-Conditions）</h3>

<p>申请者首先是阿里云用户</p>

<h3 id="基本流程（basic-flow）">基本流程（Basic Flow）</h3>

<h4 id="a-点击进入控制台，进行登录。">a. 点击进入<a href="http://console.d.aliyun.com"><font color=red >控制台</font></a>，进行登录。</h4>

<h4 id="b-登录阿里云账号">b. 登录阿里云账号</h4>

<h4 id="c-进行实名认证（已经实名认证过的开发者直接看g-步骤）">c. 进行实名认证（已经实名认证过的开发者直接看g.步骤）</h4>

<p>用户未通过实名认证，需要实名认证后，才能申请开发者，流程如下：</p>

<h4 id="d-点击“立即认证”">d. 点击“立即认证”</h4>

<p><img alt="lijirz" src="https://img.alicdn.com/tps/TB1PUwmIVXXXXbbXXXXXXXXXXXX-866-305.png" /></p>

<h4 id="e-新开窗口跳转到阿里云认证页面">e. 新开窗口跳转到阿里云认证页面</h4>

<p><img alt="shimingrz" src="https://img.alicdn.com/tps/TB1lv3iIVXXXXa6XpXXXXXXXXXX-866-412.png" /></p>

<h4 id="f-实名认证通过，在弹窗点击“立即刷新”按钮">f. 实名认证通过，在弹窗点击“立即刷新”按钮</h4>

<p><img alt="zhengzairz" src="https://img.alicdn.com/tps/TB11m_VIVXXXXaqapXXXXXXXXXX-866-334.png" /></p>

<h4 id="g-显示已通过实名认证">g. 显示已通过实名认证</h4>

<p><img alt="shiming" src="https://img.alicdn.com/tps/TB1C3T6IVXXXXXWaXXXXXXXXXXX-866-335.png" /></p>

<h4 id="h-选择开发应用类型为“钉钉企业类型”，填入“钉钉企业账号”">h. 选择开发应用类型为“钉钉企业类型”，填入“钉钉企业账号”</h4>

<h5 id="数据项说明">数据项说明</h5>

<table><thead>
<tr>
<th>字段</th>
<th>属性</th>
</tr>
</thead><tbody>
<tr>
<td>开发者介绍</td>
<td>100字</td>
</tr>
<tr>
<td>开发应用类型</td>
<td>选择“钉钉企业账号”</td>
</tr>
<tr>
<td>钉钉企业账号</td>
<td>4-11位小写英文字符、数字、下划线</td>
</tr>
<tr>
<td>账号密码</td>
<td>必须为6位以上数字、大小写字母的组合</td>
</tr>
</tbody></table>

<h4 id="i-显示申请开发者成功">i. 显示申请开发者成功</h4>

<h2 id="创建套件-amp-微应用">创建套件&amp;微应用</h2>

<h3 id="1-创建套件">1: 创建套件</h3>

<h4 id="1-1-描述（description）">1.1 描述（Description）</h4>

<p>在开发钉钉应用前，首先要创建一个套件，套件可以包含一组应用，并对这组应用统一进行权限管理。</p>

<h4 id="1-2-前置条件（pre-conditions）">1.2 前置条件（Pre-Conditions）</h4>

<p>阿里云用户成功申请开发者</p>

<h4 id="1-3-基本流程（basic-flow）">1.3 基本流程（Basic Flow）</h4>

<h5 id="a-钉钉应用菜单-套件列表，点击“创建套件”">a.钉钉应用菜单-套件列表，点击“创建套件”</h5>

<p><img alt="createtj" src="https://img.alicdn.com/tps/TB1fyqYJFXXXXcXXVXXXXXXXXXX-1346-479.jpg" /></p>

<h5 id="b．填写创建套件表单">b．填写创建套件表单</h5>

<p><img alt="createtjbd" src="https://img.alicdn.com/tps/TB1Az_EJFXXXXb3XFXXXXXXXXXX-678-539.jpg" /></p>

<h5 id="数据项说明：">数据项说明：</h5>

<table><thead>
<tr>
<th>字段</th>
<th>属性</th>
</tr>
</thead><tbody>
<tr>
<td>套件Logo</td>
<td>上传大小不超过1M，长宽等比且范围在50px至200px之间的png格式图片</td>
</tr>
<tr>
<td>回调URL</td>
<td>以http://开头，系统将会把此套件的SuiteTicket，临时授权码以及授权变更事件推送给此URL，详细请看<a href="#2-回调接口（分为五个回调类型）"><font color=red >回调接口</font></a></td>
</tr>
<tr>
<td>Token</td>
<td>可任意填写，用于生成签名，校验回调请求的合法性。本套件下相关应用产生的回调消息都使用该值来解密。</td>
</tr>
<tr>
<td>数据加密密钥</td>
<td>回调消息加解密参数，是AES密钥的Base64编码，用于解密回调消息内容对应的密文。本套件下相关应用产生的回调消息都使用该值来解密。</td>
</tr>
<tr>
<td>IP白名单</td>
<td>调用钉钉API时的合法IP列表，多个IP请以“,”隔开，如IP有变化，请立即更新</td>
</tr>
<tr>
<td>部署方式</td>
<td>选择ACE，系统接下来将自动开通基于ACE的开发环境，选择其他则需要自行准备开发环境</td>
</tr>
<tr>
<td>当前状态</td>
<td>对于需要公开售卖的套件，只有处于已完成状态，才可进入售卖流程</td>
</tr>
</tbody></table>

<p><strong>当您注册套件时，钉钉服务器为了避免无效推送，将会验证回调url的有效性，对回调url推送&quot;验证回调URL有效性事件&ldquo;，收到推送后您需要做正确的处理，才能成功创建套件。详细处理步骤请查看<a href="#2-回调接口（分为五个回调类型）"><font color=red >回调接口</font></a>和&quot;验证回调URL有效性事件&quot;。</strong></p>

<h5 id="c-点击“确定”按钮进入套件列">c.点击“确定”按钮进入套件列</h5>

<p>在这里可以查看套件详细信息，比如套件Key（suite_key），套件secret(suite_secret)</p>

<h3 id="2-创建微应用">2: 创建微应用</h3>

<h4 id="2-1-描述（description）">2.1 描述（Description）</h4>

<p>开发者编辑套件基本信息，创建微应用。</p>

<h4 id="2-2-前置条件（pre-conditions）">2.2 前置条件（Pre-Conditions）</h4>

<p>阿里云用户，申请成为开发者，套件列表点击“管理”操作</p>

<h4 id="2-3-基本流程（basic-flow）">2.3 基本流程（Basic Flow）</h4>

<h5 id="a-查看套件基本信息">a 查看套件基本信息</h5>

<h5 id="b-点击“创建微应用按钮”">b 点击“创建微应用按钮”</h5>

<p><img alt="createmini1" src="https://img.alicdn.com/tps/TB19X14JFXXXXc3XFXXXXXXXXXX-1164-326.jpg" /></p>

<h5 id="c-添加创建微应用表单，点击“确定”按钮">c 添加创建微应用表单，点击“确定”按钮</h5>

<p><img alt="createmini2" src="https://img.alicdn.com/tps/TB1G0nnJFXXXXa8XXXXXXXXXXXX-705-649.jpg" /></p>

<h5 id="需要提供的数据项：">需要提供的数据项：</h5>

<table><thead>
<tr>
<th>字段</th>
<th>属性</th>
</tr>
</thead><tbody>
<tr>
<td>名称</td>
<td>应用的名称，2-16个字。</td>
</tr>
<tr>
<td>图标</td>
<td>上传大小不超过1M，长宽等比且范围在50px至200px之间的png格式图片</td>
</tr>
<tr>
<td>应用描述</td>
<td>描述该应用的功能与特色，4-120个字内</td>
</tr>
<tr>
<td>主页地址</td>
<td>以http://开头，用于接收托管企业应用的用户消息，URL支持使用$CORPID$模板参数表示corpid，用户访问应用的时候将把$CORPID$替换成用户所属企业的corpid，例如http://www.dingtalk.com/index?corpid=$CORPID$</td>
</tr>
<tr>
<td>权限设置</td>
<td>多选</td>
</tr>
<tr>
<td>接口权限</td>
<td>多选</td>
</tr>
</tbody></table>

<h5 id="d-微应用列表添加一行记录">d 微应用列表添加一行记录</h5>

<p><img alt="createmini3" src="https://img.alicdn.com/tps/TB1V7DoJFXXXXarXXXXXXXXXXXX-1164-440.jpg" /></p>

<h3 id="3-注册测试企业">3: 注册测试企业</h3>

<h4 id="3-1-描述（description）">3.1.描述（Description）</h4>

<p>钉钉套件在开发过程中，需要在钉钉移动端上登录绑定了相关企业的钉钉帐号来进行调试。在此之前，需要开发者对注册的测试企业&quot;发起授权所有套件&quot;，之后钉钉服务器会向您填写的回调url<a href="##2-回调接口（分为五个回调类型）"><font color=red>推送临时授权码</font></a>，您需要通过临时授权码一步一步到<a href="#7-激活授权套件"><font color=red>激活授权套件</font></a>，才能让测试企业的微应用列表出现您开发的微应用。</p>

<h4 id="3-2-前置条件（pre-conditions）">3.2.前置条件（Pre-Conditions）</h4>

<p>阿里云用户成功申请开发者</p>

<h4 id="3-3-基本流程（basic-flow）">3.3.基本流程（Basic Flow）</h4>

<h6 id="a-钉钉应用菜单—开发环境列表，点击“注册测试企业”">a.钉钉应用菜单—开发环境列表，点击“注册测试企业”</h6>

<p><img alt="signintest1" src="https://img.alicdn.com/tps/TB1VBWRJVXXXXXGaXXXXXXXXXXX-1022-78.jpg" /></p>

<h5 id="b-填写企业相关信息">b.填写企业相关信息</h5>

<p><img alt="signintest2" src="https://img.alicdn.com/tps/TB1p1H3IVXXXXX8aXXXXXXXXXXX-729-447.png" /></p>

<h5 id="c-点击“确定”后列表增加一行记录">c.点击“确定”后列表增加一行记录</h5>

<p><img alt="signintest3" src="https://img.alicdn.com/tps/TB1pvqVJVXXXXahXVXXXXXXXXXX-1029-343.jpg" /></p>

<h5 id="d-点击“模拟测试企业发起授权所有套件”，弹窗提示微应用开通成功">d.点击“模拟测试企业发起授权所有套件”，弹窗提示微应用开通成功</h5>

<p>注意：只有在微应用注册的回调接口能够接收推送，才能成功开通微应用，具体详情查看<a href="#5-回调接口（分为五个回调类型）"><font color=red>回调接口</font></a></p>

<p><img alt="signintest4" src="https://img.alicdn.com/tps/TB1B2njJVXXXXaEXXXXXXXXXXXX-1048-158.jpg" /></p>

<h5 id="e-点击“登录管理”跳转钉钉登录后台">e.点击“登录管理”跳转钉钉登录后台</h5>

<p><img alt="signintest5" src="https://img.alicdn.com/tps/TB1lEKUJVXXXXaSXVXXXXXXXXXX-1048-158.jpg" /></p>

<p><img alt="signintest6" src="https://img.alicdn.com/tps/TB1snUfIVXXXXbSXpXXXXXXXXXX-866-456.png" /></p>

<h2 id="isv接入开发指南">ISV接入开发指南</h2>

<h3 id="1-isv接口调用整体流程">1: ISV接口调用整体流程</h3>

<p>欢迎成为钉钉微应用的服务提供商！
通过接入钉钉ISV的应用授权接口，可以快速发布自己的微应用套件，引导企业客户自动开通微应用，将自己的服务快速触达到自己的目标客户！
钉钉的应用授权方案包含以下两个场景：</p>

<h4 id="isv注册应用">ISV注册应用</h4>

<p>你，作为ISV若要使用此方案，只需在阿里云上注册成为第三方服务提供商，在ISV接入后台创建应用套件，并在应用套件中配置好相应的应用。
本方案所说的应用套件，是第三方应用授权的主体，它可以包含多个第三方所提供的同一类型的应用。目前一个第三方最多可以注册五个应用套件，一个应用套件最多可以包含五个应用。</p>

<h4 id="企业管理员授权应用">企业管理员授权应用</h4>

<p>企业的管理员在钉钉企业后台的微应用列表中浏览你的应用套件后，即可发起一键授权，系统将展示微应用的第三方授权页面，管理员根据授权页面的引导，确认授权内容，完成授权操作。
授权完成之后，企业就可使用ISV服务提供商所提供的应用服务了。一切将变得简单自然。以下是详细的接口调用时序图
<img alt="Mou icon" src="https://img.alicdn.com/tps/TB1RhMGJXXXXXXdXVXXXXXXXXXX-876-659.jpg" /></p>

<h3 id="2-回调接口（分为五个回调类型）">2: 回调接口（分为五个回调类型）</h3>

<h4 id="使用场景">使用场景</h4>

<p>在使用回调接口之前您需要了解的是，</p>

<p>首先要拿到您创建套件时填写的&quot;回调URL&quot;，&quot;Token&quot;，&quot;数据加密密钥(ENCODING_AES_KEY)&quot;，</p>

<ul>
<li><p>回调URL:服务提供商接收推送请求的协议和地址</p></li>
<li><p>Token:服务提供商在注册时任意填写的，用来生成signature，用来和回调参数中的signature比对，校验消息的合法性</p></li>
<li><p>数据加密密钥(ENCODING_AES_KEY):用于消息体的加解密。</p></li>
</ul>

<p>钉钉服务器会向服务提供商申请时填写的套件回调URL定时推送SuiteTicket，以及临时授权码和授权设置变更。</p>

<p>假设您提供的回调URL是</p>

<p><code class="prettyprint">https://127.0.0.1/suite/receive</code></p>

<p>那么在钉钉服务器每一次访问回调URL的时候
将请求(下面链接中的signature,timestamp,nonce的值只是示例，并不代表真实返回的值):</p>

<p><code class="prettyprint">https://127.0.0.1/suite/receive?signature=111108bb8e6dbce3c9671d6fdb69d15066227608
&amp;timestamp=1783610513&amp;nonce=380320111</code></p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>回调数据的格式如右所示：</p>

<p>其中的encrypt字段是经过加密的消息体，encrypt经过一系列解密步骤后，才能产生下面所说的“POST数据解密后示例”，服务提供商可以直接使用钉钉提供的库进行解密的处理。</p>

<p>除此之外，在接收到推送之后，<strong>需要返回相应的加密字符串（代表了你收到了推送）</strong>，如果ISV未能成功返回，钉钉服务器将持续推送下去，达到100次后将不再推送。</p>

<p>&quot;Talk is cheap, show me the code.&quot;所以我们也为开发者提供了加解密的demo，目前提供Java/PHP等语言版本。
加解密库和demo的下载：<a href="#加解密库和demo下载"><font color=red >加解密库和demo下载</font></a></p>

<p>本地调试：<a href="#调试工具"><font color=red >如何本地进行调试？</font></a></p>

<p>如有需要，可以查看具体加解密步骤：<a href="#12-加解密方案"><font color=red >查看</font></a></p>

<h4 id="接口说明">接口说明</h4>

<h4 id="a-验证回调url有效性事件">a.<font color=red >验证回调URL有效性事件</font></h4>

<p>此事件的推送会发生在注册套件，点击下图按钮之时。注意，若未能成功验证回调URL有效性，套件将不能被创建。</p>

<p><img alt="verifyurl" src="https://img.alicdn.com/tps/TB1RuHzJFXXXXahXVXXXXXXXXXX-615-100.jpg" /></p>
<pre class="highlight plaintext"><code>dingTalkEncryptor = new DingTalkEncryptor(Env.TOKEN, Env.ENCODING_AES_KEY, Env.CREATE_SUITE_KEY);//套件在创建中，使用默认的SUITE_KEY进行加解密

</code></pre>

<p>此时，由于套件尚未创建成功，还未生成套件的SUITE_KEY，所以在解密post数据的时候，需要使用默认的Env.CREATE_SUITE_KEY（默认值为&quot;suite4xxxxxxxxxxxxxxx&quot;）来解密，以java-demo代码为例（Env为Demo中配置文件），如右。</p>

<p>待成功处理『验证回调URL有效性事件』事件，套件创建成功之后，就不能再使用默认的SUITE_KEY了，需要使用套件本身的SUITE_KEY，所以需要在Env.java中配置SUITE_KEY，然后重新部署代码,此时将用下面的语句进行加解密。</p>

<p><code class="prettyprint">dingTalkEncryptor = new DingTalkEncryptor(Env.TOKEN, Env.ENCODING_AES_KEY, Env.SUITE_KEY);//套件创建成功后，使用套件本身的SUITE_KEY进行加解密</code></p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">

  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="s2">"check_create_suite_url"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Random"</span><span class="p">:</span><span class="s2">"brdkKLMW"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TestSuiteKey"</span><span class="p">:</span><span class="s2">"suite4xxxxxxxxxxxxxxx"</span><span class="w">

</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>Random</td>
<td>随机字符串</td>
</tr>
<tr>
<td>EventType</td>
<td>check_create_suite_url</td>
</tr>
<tr>
<td>TestSuiteKey</td>
<td>校验的SuiteKey</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密后&quot;Random&quot;字段的json数据，比如对于上面的示例，需要返回的即是加密后的&quot;brdkKLMW&quot;字符串。</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;Random&quot;字段的加密字符串</td>
</tr>
</tbody></table>

<h4 id="b-定时推送ticket">b: 定时推送Ticket</h4>

<p>服务器会向服务提供商申请时填写的套件事件接收 URL定时（二十分钟）推送ticket：</p>

<p>服务提供商在收到ticket推送后务必返回经过加密的字符串&quot;success&quot;的json数据</p>

<p>如果不返回，钉钉服务器将连续推送，直到推送次数超过100次，就不再推送。倘若您希望钉钉服务器重新推送，需要进入<a href="http://console.d.aliyun.com"><font color=red>开发者后台</font></a>，进入套件管理页面，点击『重新推送』按钮，即可重新推送。
<img alt="repush" src="https://img.alicdn.com/tps/TB15j7OJFXXXXckXXXXXXXXXXXX-1121-124.jpg" /></p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suitexxxxxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suite_ticket "</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234456</span><span class="p">,</span><span class="w">
  </span><span class="nt">"SuiteTicket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"adsadsad"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>EventType</td>
<td>suite_ticket</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>SuiteTicket</td>
<td>Ticket内容</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h4 id="c-回调向isv推送临时授权码">c:回调向ISV推送临时授权码</h4>

<p>当授权方（即授权企业）在微应用管理端的授权管理中，向服务提供商的应用套件授权了访问权限，钉钉服务器会向服务提供商的套件事件接收 URL（创建套件时填写）推送临时授权码，</p>

<p>比如在<a href="http://console.d.aliyun.com"><font color=red>钉钉开发者后台</font></a>中，模拟测试企业发起授权，钉钉服务器就会向回调url推送测试企业的临时授权码</p>

<p><img alt="shouqun" src="https://img.alicdn.com/tps/TB1rZerKpXXXXX8XXXXXXXXXXXX-720-124.jpg" /></p>

<p>收到临时授权码之后请按照步骤换取永久授权码，并将永久授权码存下来。</p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suitexxxxxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">" tmp_auth_code"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234456</span><span class="p">,</span><span class="w">
  </span><span class="nt">"AuthCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"adads"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>字段说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>EventType</td>
<td>tmp_auth_code</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>AuthCode</td>
<td>临时授权码</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h4 id="d-回调向isv推送授权变更消息">d:回调向ISV推送授权变更消息</h4>

<p>当授权方（即授权企业）在微应用管理端中，修改了对套件的授权托管后，钉钉服务器会向服务提供商的套件事件接收 URL（创建套件时填写）推送授权变更消息。注意，推送的授权变更信息并不包括企业用户具体做了什么修改，所以收到推送之后,</p>

<p><strong>ISV需要通过调用<a href="#10-获取企业的应用信息"><font color=red >获取企业的应用信息</font></a>接口</strong>，获取接口返回值其中的&quot;close&quot;参数，才能得知微应用在企业用户做了授权变更之后的状态，有三种状态码，分别为0，1，2.含义如下：</p>

<ul>
<li>0:禁用（例如企业用户在OA后台禁用了微应用）</li>
<li>1:正常 (例如企业用户在禁用之后又启用了微应用)</li>
<li>2:待激活 (企业已经进行了授权，但是ISV还未为企业激活应用)</li>
</ul>

<p>再根据具体状态做具体操作。比如状态为2，就需要ISV为企业进行激活授权套件的操作。</p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"suitexxxxxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">" change_auth"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234456</span><span class="p">,</span><span class="w">
  </span><span class="nt">"AuthCorpId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxxx"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>字段说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>EventType</td>
<td>change_auth</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>AuthCorpId</td>
<td>授权方企业的corpid</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h4 id="e-quot-套件信息更新-quot-事件">e.&quot;套件信息更新&quot;事件</h4>

<p>此事件的推送会发生在更新套件信息的时候。</p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="s2">"check_update_suite_url"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Random"</span><span class="p">:</span><span class="s2">"Aedr5LMW"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TestSuiteKey"</span><span class="p">:</span><span class="s2">"suited6db0pze8yao1b1y"</span><span class="w">

</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>服务提供商在收到&quot;套件信息更新&quot;事件推送后务必返回经过加密后&quot;Random&quot;字段，比如对于右边的示例，需要返回的即是加密后的&quot;Aedr5LMW&quot;字符串。</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>Random</td>
<td>随机字符串</td>
</tr>
<tr>
<td>EventType</td>
<td>check_update_suite_url</td>
</tr>
<tr>
<td>TestSuiteKey</td>
<td>校验的SuiteKey(此处为套件的SuiteKey)</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密后&quot;Random&quot;字段的json数据，比如对于上面的示例，需要返回的即是加密后的&quot;Aedr5LMW&quot;字符串。</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;Random&quot;字段的加密字符串</td>
</tr>
</tbody></table>

<h4 id="f-quot-解除授权-quot-事件">f.&quot;解除授权&quot;事件</h4>

<p>此事件的推送会发生在企业解除套件授权的时候。</p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"EventType"</span><span class="p">:</span><span class="s2">"suite_relieve"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"SuiteKey"</span><span class="p">:</span><span class="s2">"suited6db0pze8yao1b1y"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="s2">"12351458245"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"AuthCorpId"</span><span class="p">:</span><span class="s2">"ding4583267d28sd61"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>服务提供商在收到&quot;解除授权&quot;事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据。</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SuiteKey</td>
<td>应用套件的SuiteKey</td>
</tr>
<tr>
<td>EventType</td>
<td>suite_relieve</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>AuthCorpId</td>
<td>授权方企业的corpid</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到&quot;解除授权&quot;事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据。</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="s2">"Random"</span><span class="err">字段的加密数据</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&quot;success&quot;字段的加密字符串</td>
</tr>
</tbody></table>

<h3 id="3-获取套件访问token（suite_access_token）">3: 获取套件访问Token（suite_access_token）</h3>

<h4 id="使用场景">使用场景</h4>

<p>该API用于获取应用套件令牌（suite_access_token）</p>

<h4 id="接口说明">接口说明</h4>

<p>接口调用请求说明
https请求方式: POST
https://oapi.dingtalk.com/service/get_suite_token</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"suite_key"</span><span class="p">:</span><span class="s2">"key_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_ticket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ticket_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_key</td>
<td>应用套件的key</td>
</tr>
<tr>
<td>suite_secret</td>
<td>应用套件secret</td>
</tr>
<tr>
<td>suite_ticket</td>
<td>钉钉后台推送的ticket</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"suite_access_token"</span><span class="p">:</span><span class="s2">"61W3mEpU66027wgNZ_MhGHNQDHnFATkDa9-2llqrMBjUwxRSNPbVsMmyD-yq8wZETSoE5NQgecigDrSHkPtIYA"</span><span class="p">,</span><span class="w">  </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="mi">7200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_access_token</td>
<td>应用套件access_token</td>
</tr>
<tr>
<td>expires_in</td>
<td>有效期</td>
</tr>
</tbody></table>

<h3 id="4-获取企业的永久授权码">4: 获取企业的永久授权码</h3>

<h4 id="使用场景">使用场景</h4>

<p>该API用于使用临时授权码换取授权方的永久授权码，并换取授权信息、企业access_token。得到永久授权码之后请将永久授权码存储下来。</p>

<p>注：临时授权码使用一次后即失效</p>

<h4 id="接口说明">接口说明</h4>

<p>接口调用请求说明
https请求方式: POST
https://oapi.dingtalk.com/service/get_permanent_code?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"tmp_auth_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">" value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>tmp_auth_code</td>
<td>回调接口（tmp_auth_code）获取的临时授权码</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"auth_corp_info"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"corpid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxx"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>permanent_code</td>
<td>永久授权码</td>
</tr>
<tr>
<td>auth_corp_info</td>
<td>授权方企业信息</td>
</tr>
<tr>
<td>corpid</td>
<td>授权方企业id</td>
</tr>
<tr>
<td>corp_name</td>
<td>授权方企业名称</td>
</tr>
</tbody></table>

<h3 id="5-获取企业授权的access_token">5:获取企业授权的access_token</h3>

<h4 id="使用场景">使用场景</h4>

<p>服务提供商在取得企业的永久授权码并完成对企业应用的设置之后，便可以开始通过调用企业接口来运营这些应用。其中，调用企业接口所需的access_token获取方法如下接口说明。</p>

<h4 id="接口说明">接口说明</h4>

<p>接口调用请求说明</p>

<p>https请求方式: POST
https://oapi.dingtalk.com/service/get_corp_token?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"code_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，通过get_permanent_code获取</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">7200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>授权方（企业）access_token</td>
</tr>
<tr>
<td>expires_in</td>
<td>授权方（企业）access_token超时时间</td>
</tr>
</tbody></table>

<h3 id="6-获取企业授权的授权数据">6: 获取企业授权的授权数据</h3>

<h4 id="使用场景">使用场景</h4>

<p>该API用于通过永久授权码换取授权信息。 永久授权码的获取，是通过临时授权码使用get_permanent_code 接口获取到的permanent_code。</p>

<h4 id="接口说明">接口说明</h4>

<p>接口调用请求说明</p>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/get_auth_info?suite_access_token=xxxx</p>

<p>//注意，是suite_access_token，不是授权方（企业）的access_token</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="s2">"code_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"suite_key"</span><span class="p">:</span><span class="s2">"key_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_key</td>
<td>应用套件key</td>
</tr>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，通过get_permanent_code获取</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"auth_corp_info"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"corp_logo_url"</span><span class="p">:</span><span class="s2">"http://xxxx.png"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="s2">"corpid"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"industry"</span><span class="p">:</span><span class="s2">"互联网"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"invite_code"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1001"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"auth_user_info"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"userId"</span><span class="p">:</span><span class="s2">""</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"auth_info"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"agent"</span><span class="p">:[{</span><span class="w">
            </span><span class="nt">"agent_name"</span><span class="p">:</span><span class="s2">"aaaa"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"appid"</span><span class="p">:</span><span class="mi">-3</span><span class="p">,</span><span class="w">
            </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="s2">"http://aaaaaa.com"</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="p">,{</span><span class="w">
            </span><span class="nt">"agent_name"</span><span class="p">:</span><span class="s2">"bbbb"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w">
            </span><span class="nt">"appid"</span><span class="p">:</span><span class="mi">-2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="s2">"http://vvvvvv.com"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
    </span><span class="p">},</span><span class="w">
          </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>auth_corp_info</td>
<td>授权方企业信息</td>
</tr>
<tr>
<td>corpid</td>
<td>授权方企业id</td>
</tr>
<tr>
<td>invite_code</td>
<td>表示邀请码，只有填写过且是ISV自己邀请码的数据才会返回,否则值为空字符串</td>
</tr>
<tr>
<td>industry</td>
<td>表示企业所属行业</td>
</tr>
<tr>
<td>corp_name</td>
<td>授权方企业名称</td>
</tr>
<tr>
<td>auth_user_info</td>
<td>授权方管理员信息</td>
</tr>
<tr>
<td>mobile</td>
<td>管理员电话</td>
</tr>
<tr>
<td>name</td>
<td>管理员名字</td>
</tr>
<tr>
<td>corp_logo_url</td>
<td>企业logo</td>
</tr>
<tr>
<td>auth_info</td>
<td>授权信息</td>
</tr>
<tr>
<td>agent</td>
<td>授权的应用信息</td>
</tr>
<tr>
<td>agentid</td>
<td>授权方应用id</td>
</tr>
<tr>
<td>agent_name</td>
<td>授权方应用名字</td>
</tr>
<tr>
<td>logo_url</td>
<td>授权方应用头像</td>
</tr>
<tr>
<td>appid</td>
<td>服务商套件中的对应应用id</td>
</tr>
</tbody></table>

<h3 id="7-获取企业的应用信息">7:获取企业的应用信息</h3>

<h4 id="使用场景">使用场景</h4>

<p>该API用于获取已授权开通的企业的某个应用的基本信息，包括LOGO,名称，描述等,信息接口调用请求说明</p>

<h4 id="接口说明">接口说明</h4>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/get_agent?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">   </span><span class="nt">"suite_key"</span><span class="p">:</span><span class="s2">"key_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="s2">"code_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">541</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_key</td>
<td>应用套件key</td>
</tr>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，从get_permanent_code接口中获取</td>
</tr>
<tr>
<td>agentid</td>
<td>授权方应用id</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"agentid"</span><span class="p">:</span><span class="mi">541</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"公告"</span><span class="p">,</span><span class="w">    
    </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="s2">"http://xxxxxxx/png"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"企业重要消息"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"close"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>结果参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>agentid</td>
<td>授权方企业应用id</td>
</tr>
<tr>
<td>name</td>
<td>授权方企业应用名称</td>
</tr>
<tr>
<td>logo_url</td>
<td>授权方企业应用头像</td>
</tr>
<tr>
<td>description</td>
<td>授权方企业应用详情</td>
</tr>
<tr>
<td>close</td>
<td>授权方企业应用是否被禁用（0:禁用  1:正常  2:待激活 ）</td>
</tr>
</tbody></table>

<h3 id="8-激活授权套件">8:激活授权套件</h3>

<h4 id="使用场景">使用场景</h4>

<p>该API适用于当企业用户授权开通套件时ISV套件进行调用，用于激活授权方企业的套件微应用。如果ISV未调用此接口，则企业用户无法使用ISV套件</p>

<h4 id="接口说明">接口说明</h4>

<p>信息接口调用请求说明</p>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/activate_suite?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"suite_key"</span><span class="p">:</span><span class="s2">"key_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"auth_corpid_value"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"permanent_code"</span><span class="p">:</span><span class="s2">"permanent_code"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>suite_key</td>
<td>应用套件key</td>
</tr>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>permanent_code</td>
<td>永久授权码，从get_permanent_code接口中获取</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="9-解除授权套件">9: 解除授权套件</h3>

<h4 id="使用场景">使用场景</h4>

<p>当ISV想重新模拟测试企业发起授权套件，需要先进行解除对套件的授权。</p>

<h4 id="操作说明">操作说明</h4>

<p>解除授权需要进入进入测试企业OA后台&ndash;微应用进行操作，如图：</p>

<p><img alt="deleteSuite" src="https://img.alicdn.com/tps/TB1GpUAKVXXXXckaXXXXXXXXXXX-858-302.jpg" /></p>

<h3 id="10-isv为授权方的企业单独设置ip白名单">10: ISV为授权方的企业单独设置IP白名单</h3>

<h4 id="使用场景">使用场景</h4>

<p>该API用于ISV为企业独立部署场景，在ISV为企业进行独立部署软件系统时，由于是独立机房环境，每套系统是不同的IP地址，ISV可以通过此API为授权套件企业设置IP白名单,设置成功后，套件中的微应用可以调用钉钉开放平台接口服务。</p>

<h4 id="接口说明">接口说明</h4>

<p>https请求方式: POST</p>

<p>https://oapi.dingtalk.com/service/set_corp_ipwhitelist?suite_access_token=xxxx</p>

<p>POST数据示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">   
    </span><span class="nt">"auth_corpid"</span><span class="p">:</span><span class="s2">"dingabcdefgxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ip_whitelist"</span><span class="p">:[</span><span class="s2">"1.2.3.4"</span><span class="p">,</span><span class="s2">"5.6.*.*"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>请求参数说明</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>auth_corpid</td>
<td>授权方corpid</td>
</tr>
<tr>
<td>ip_whitelist</td>
<td>要为其设置的IP白名单,格式支持IP段,用星号表示,如【5.6.*.*】,代表从【5.6.0.*】到【5.6.255.*】的任意IP,在第三段设为星号时,将忽略第四段的值,注意:仅支持后两段设置为星号</td>
</tr>
</tbody></table>

<p>返回结果示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="消息体签名">消息体签名</h3>

<p>为了验证调用者的合法性，钉钉在回调url中增加了消息签名，以参数signature标识，企业需要验证此参数的正确性后再解密。</p>

<p>验证步骤：</p>

<ol>
<li><p>企业计算签名：dev_msg_signature=sha1(sort(token、timestamp、nonce、msg_encrypt))。sort的含义是将参数按照字母字典排序，然后从小到大拼接成一个字符串</p></li>
<li><p>比较dev_msg_signature和回调接口中推送的字段signature是否相等，相等则表示验证通过</p></li>
</ol>

<h5 id="加解密方案说明">加解密方案说明</h5>

<p>开启回调模式时，有以下术语需要了解：</p>

<ol>
<li><p>signature是签名，用于验证调用者的合法性。具体算法见以下&#39;消息体签名&#39;章节</p></li>
<li><p>EncodingAESKey：注册套件提供的数据加密密钥。用于消息体的加密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取，是AESKey的Base64编码。解码后即为32字节长的AESKey</p></li>
<li><p>AESKey=Base64_Decode(EncodingAESKey + “=”)，是AES算法的密钥，长度为32字节。AES采用CBC模式，数据采用PKCS#7填充；IV初始向量大小为16字节，取AESKey前16字节。具体详见：http://tools.ietf.org/html/rfc2315</p></li>
<li><p>msg为消息体明文，格式为JSON</p></li>
<li><p>钉钉服务器会把msg消息体明文编码成encrypt，encrypt = Base64_Encode(AES_Encrypt[random(16B) + msg_len(4B) + msg + $key])，是对明文消息msg加密处理后的Base64编码。其中random为16字节的随机字符串；msg_len为4字节的msg长度，网络字节序；msg为消息体明文；$key对于ISV开发来说，填写对应的suitekey，$key对于普通企业开发，填写企业的Corpid。
最终传给回调者的是encrypt，字段名为encrypt。</p></li>
</ol>

<h6 id="对明文msg加密的过程如下：">对明文msg加密的过程如下：</h6>

<p>msg_encrypt = Base64_Encode( AES_Encrypt[random(16B) + msg_len(4B) + msg + $key] )
AES加密的buf由16个字节的随机字符串、4个字节的msg长度、明文msg和$key组成。其中msg_len为msg的字节数，网络字节序；</p>

<ul>
<li>$key对于ISV来说，填写对应的suitekey</li>
<li>$key对于普通企业开发，填写企业的Corpid</li>
</ul>

<h5 id="对应于加密方案，解密方案如下：">对应于加密方案，解密方案如下：</h5>

<ul>
<li>取出返回的JSON中的encrypt字段。</li>
<li>对密文BASE64解码：aes_msg=Base64_Decode(encrypt)</li>
<li>使用AESKey做AES解密：rand_msg=AES_Decrypt(aes_msg)</li>
<li>验证解密后$key、msg_len</li>
<li>去掉rand_msg头部的16个随机字节，4个字节的msg_len,和尾部的$CorpID即为最终的消息体原文msg</li>
</ul>

<h3 id="加解密库和demo下载">加解密库和demo下载</h3>

<h4 id="java库和demo">Java库和demo</h4>

<p>首先，您需要做以下准备工作</p>

<p>1.请开发者使用jdk1.6或以上版本，针对加解密包中使用的org.apache.commons.codec.binary.Base64，须导入jar包commons-codec-1.10(或comm ons-codec-1.9等其他版本)，在java-demo的WebContent/WEB_INF/lib目录中我们也提供了commons-codec-1.10.jar。</p>

<p>官方下载地址：<a href="http://commons.apache.org/proper/commons-codec/download_codec.cgi">http://commons.apache.org/proper/commons-codec/download_codec.cgi</a></p>

<p>2.异常java.security.InvalidKeyException:illegal Key Size和『计算解密文字错误』的解决方案：</p>

<p>在官方网站下载JCE无限制权限策略文件
JDK6的下载地址：<a href="http://www.oracle.com/technetwork/java/javase/downloads/jce-6-download-429243.html">http://www.oracle.com/technetwork/java/javase/downloads/jce-6-download-429243.html</a></p>

<p>JDK7的下载地址：<a href="http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html">http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html</a></p>

<p>下载后解压，可以看到local_policy.jar和US_export_policy.jar以及readme.txt。如果安装的是JRE，将两个jar文件放到%JRE_HOME% \lib\security目录下覆盖原来的文件，如果安装的是JDK，将两个jar文件放到%JDK_HOME%\jre\lib\security目录下覆盖原来文件。</p>

<p>库地址：<a href="https://github.com/injekt/openapi-demo-java/tree/master/src/com/alibaba/dingtalk/openapi/demo/utils/aes">https://github.com/injekt/openapi-demo-java/tree/master/src/com/alibaba/dingtalk/openapi/demo/utils/aes</a></p>

<p>demo地址：<a href="https://github.com/injekt/openapi-demo-java/blob/master/src/com/alibaba/dingtalk/openapi/servlet">https://github.com/injekt/openapi-demo-java/blob/master/src/com/alibaba/dingtalk/openapi/servlet</a></p>

<h4 id="php库和demo">php库和demo</h4>

<p>库地址：<a href="https://github.com/injekt/openapi-demo-php/tree/master/crypto">https://github.com/injekt/openapi-demo-php/tree/master/crypto</a></p>

<p>demo地址：<a href="https://github.com/injekt/openapi-demo-php/blob/master/receive.php">https://github.com/injekt/openapi-demo-php/blob/master/receive.php</a></p>

<h4 id="c-库和demo">C#库和demo</h4>

<p>库地址：<a href="https://github.com/ian-cuc/suite-demo-c-/tree/master/API">https://github.com/ian-cuc/suite-demo-c-/tree/master/API</a></p>

<p>demo地址：<a href="https://github.com/ian-cuc/suite-demo-c-/blob/master/receive.ashx.cs">https://github.com/ian-cuc/suite-demo-c-/blob/master/receive.ashx.cs</a></p>

<h3 id="调试工具">调试工具</h3>

<p>回调接口本地调试方案：由于回调接口需要在外网环境接收钉钉服务器的推送，假如开发者暂时没有外网地址，需要在本地调试回调接口的加解密方案，可以在本地环境构造推送。具体构造参数示例：</p>

<p>URL后面带的参数：signature=5a65ceeef9aab2d149439f82dc191dd6c5cbe2c0&amp;timestamp=1445827045067&amp;nonce=nEXhMP4r</p>

<p>Post参数：
<code class="prettyprint">
{&quot;encrypt&quot;:&quot;1a3NBxmCFwkCJvfoQ7WhJHB+iX3qHPsc9JbaDznE1i03peOk1LaOQoRz3+nlyGNhwmwJ3vDMG+OzrHMeiZI7gTRWVdUBmfxjZ8Ej23JVYa9VrYeJ5as7XM/ZpulX8NEQis44w53h1qAgnC3PRzM7Zc/D6Ibr0rgUathB6zRHP8PYrfgnNOS9PhSBdHlegK+AGGanfwjXuQ9+0pZcy0w9lQ==&quot;
}
</code>
Token：123456</p>

<p>数据加密密钥(ENCODING_AES_KEY)：4g5j64qlyl3zvetqxz5jiocdr586fn2zvjpa8zls3ij</p>

<p>suitekey：suite4xxxxxxxxxxxxxxx</p>

<p>ISV接入相关接口调试：<a href="https://debug.dingtalk.com/isv.html"><font color=red >ISV接入调试工具</font></a></p>

<h2 id="套件上架操作流程">套件上架操作流程</h2>

<h3 id="1-云市场介绍">1. 云市场介绍</h3>

<ul>
<li>1.1 背景介绍</li>
</ul>

<p>钉钉应用当前依托云市场提供商品管理、交易管理的能力，为钉钉企业提供应用必须通过云市场进行商品相关的操作。</p>

<ul>
<li>1.2 概念定义</li>
</ul>

<table><thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>服务商</td>
<td>云市场中的卖家，提供钉钉应用</td>
</tr>
<tr>
<td>服务商入驻</td>
<td>申请成为云市场卖家的过程，需要填写信息并审核</td>
</tr>
<tr>
<td>保证金</td>
<td>在云市场的卖家需要缴纳一定金额的保证金，保障服务水平和商品质量</td>
</tr>
<tr>
<td>市场</td>
<td>云市场将商品进行管理、展示、交易</td>
</tr>
<tr>
<td>商品</td>
<td>在云市场中进行售卖的应用</td>
</tr>
<tr>
<td>商品类型</td>
<td>对商品的划分，影响商品展示属性和生产过程，当前只需关注钉钉类商品</td>
</tr>
<tr>
<td>商品接入</td>
<td>部分商品由云市场进行生产，因此需要先将商品的生产信息提交到云市场进行接入</td>
</tr>
<tr>
<td>订单</td>
<td>通过订单来完成商品购买的过程</td>
</tr>
<tr>
<td>业务</td>
<td>订单生成的订单实例即业务，通过业务完成商品生产和交付的过程</td>
</tr>
<tr>
<td>云市场API</td>
<td>云市场生产时可以调用服务商提供的API，服务商完成一定的生产工作后返回结果给云市场</td>
</tr>
</tbody></table>

<ul>
<li>1.2 整体流程
<img alt="wholeProcess" src="https://img.alicdn.com/tps/TB10Q8lLXXXXXbaaXXXXXXXXXXX-826-1279.png" /></li>
</ul>

<h3 id="2-如何入驻云市场">2.如何入驻云市场</h3>

<p>入驻云市场您需要完成以下步骤 申请入驻 -&gt; 补充供应商资料 -&gt; 提交店铺资料 -&gt; 支付保证金</p>

<ul>
<li>2.1 申请入驻</li>
</ul>

<p>您可以通过<a href="http://market.aliyun.com/supplierApply"><font color=red>申请入驻</font></a>
查看入驻条件和提交入驻申请。</p>

<p>云市场分为软件市场、服务市场和建站市场，不同的市场有不同的入驻条件，入驻市场后您可以在该市场发布商品。</p>

<p>您首次入驻时，需要选择需要入驻的市场(钉钉类商品选择 软件市场)，填写信息后提交审核。
当您已经入驻某个市场后，可以从此页面入驻其他市场，此时不需要重新填写资料，直接提交审核即可。</p>

<p>您提交入驻申请后，云市场小二将会联系您。</p>

<ul>
<li>2.2 补充供应商资料</li>
</ul>

<p>入驻成功后，您可以访问<a href="http://msp.aliyun.com/"><font color=red>服务商平台</font></a>进行操作。
请在左侧菜单中点击”服务商信息”，进入服务商信息维护页面。
[<font color=red>注意，供应商名称、淘宝账号、支付宝账号填写后无法修改，请慎重填写！淘宝账号、支付宝账号必须是关联关系</font>]</p>

<ul>
<li>2.3 提交店铺资料</li>
</ul>

<p>访问<a href="http://msp.aliyun.com/"><font color=red>服务商平台</font></a>，在左侧菜单中点击”店铺管理”提交店铺资料。每个服务商拥有自己的店铺，例如：http://market.aliyun.com/store/771374.html 后续我们会开放对店铺首页进行装修的功能</p>

<ul>
<li>2.4 支付保证金
为了更好地保障阿里云用户及钉钉的权益，提升云市场服务商的服务水平和商品质量。发布钉钉商品前，其服务商需缴纳保证金；如果服务商未缴纳保证金，其名下的商品不得上架售卖</li>
</ul>

<table><thead>
<tr>
<th>分类</th>
<th>保证金金额</th>
</tr>
</thead><tbody>
<tr>
<td>A、免费应用</td>
<td>5万元</td>
</tr>
<tr>
<td>B、收费应用</td>
<td></td>
</tr>
<tr>
<td>累计交易额 0＜X≤500（万元）</td>
<td>10万</td>
</tr>
<tr>
<td>累计交易额 500＜X≤1000（万元）</td>
<td>50万</td>
</tr>
<tr>
<td>累计交易额 1000万元以上</td>
<td>100万</td>
</tr>
</tbody></table>

<p>保证金需按照上述表格中的规定进行缴纳。</p>

<p>保证金缴纳方式：
服务商签订《云市场服务商入驻协议》后，将指定金额的保证金汇款到阿里云账户，收到保证金后，联系钉钉运营小二，确认后阿里云会开具保证金收据并邮寄给服务商。</p>

<p>阿里云账户：</p>

<p>开户银行： 招商银行杭州分行高新支行</p>

<p>开户名称： 阿里云计算有限公司</p>

<p>帐号： 5719 0549 3610 900</p>

<h3 id="3-如何进行商品管理">3. 如何进行商品管理</h3>

<ul>
<li>3.1 提交商品审核</li>
</ul>

<p>1.请在发布商品页面选择钉钉类商品。</p>

<p>2.填写应用钉钉类商品的接入信息。
<img alt="submitProduct" src="https://img.alicdn.com/tps/TB1HvdzLXXXXXbLXFXXXXXXXXXX-865-283.png" />
a)商品名称：请填写您的商品名称，此信息将作为商品名称直接展示给客户。</p>

<p>b)选择套件：系统会提供从开发者平台读取到的您的钉钉套件，您可以选择一个套件作为售卖的商品。</p>

<p>c)主页地址：当您选择钉钉套件后，系统会自动读取，您不需要填写此地址。</p>

<p>d)生产系统接口地址：您可以在此处录入您的生产系统接口地址，当客户购买您的商品后，云市场会调用此链接通知您的系统，以便您通过系统处理客户的请求。</p>

<p>e)源代码地址：请您填写您的软件的源代码地址以便我们进行安全扫描，此项为非必填内容。</p>

<p>f)填写完成后，请点击”下一步”进入商品基础信息填写页面</p>

<p>3.填写钉钉类商品的基础信息。
<img alt="submitProduct1" src="https://img.alicdn.com/tps/TB1A_XoLXXXXXXZaXXXXXXXXXXX-865-363.png" />
<img alt="submitProduct2" src="https://img.alicdn.com/tps/TB1lTduLXXXXXakXVXXXXXXXXXX-865-396.png" />
<img alt="submitProduct3" src="https://img.alicdn.com/tps/TB1gE4sLXXXXXbrXVXXXXXXXXXX-865-199.png" />
a)商品图片：请上传商品列表页面和商品详情页面展示的商品图片。推荐图片大小为160*120像素。</p>

<p>b)商品介绍：请填写您的商品简介，此信息将在云市场的商品列表页面进行展示，建议字数控制在100字以内。</p>

<p>c)商品详情：请填写您商品的详细介绍信息，此信息将在商品详情页面进行展示，建议尽量详情得描述您的商品。</p>

<p>d)成功案例：可以填写您的商品的成功案例，此信息将在商品详情页面进行展示，可以不填写。</p>

<p>e)app展示图片：您可以上传在app端展示的商品图片。</p>

<p>f)填写完成后，请点击”下一步”进入商品业务信息填写页面。</p>

<p>4.填写钉钉类商品的业务信息。
<img alt="submitProductBiz" src="https://img.alicdn.com/tps/TB1PMNHLXXXXXb8XpXXXXXXXXXX-865-210.png" /></p>

<p>a)商品所属类目：请填写您将商品放在哪个类目下，此选项会影响用户搜索商品时在哪个类目下进行展现。同时，当您选择类目后，系统会显示该类目的商品特有的一些属性，您可以根据实际情况填写属性信息，如果您的商品不包含该属性也可以不进行填写。</p>

<p>b)填写完成后，请点击”下一步”进入商品销售信息填写页面。</p>

<p>5.填写钉钉类商品的销售信息。
<img alt="submitProductSel1" src="https://img.alicdn.com/tps/TB1vcJHLXXXXXb0XpXXXXXXXXXX-865-305.png" />
<img alt="submitProductSel2" src="https://img.alicdn.com/tps/TB1cbFjLXXXXXcSaXXXXXXXXXXX-844-303.png" />
a)售卖方式：钉钉类商品支持按次售卖或按周期售卖。</p>

<p>b)商品版本名称：请填写售卖的版本名称，在商品页面会显示在上图红框处的位置。一个商品可添加多个版本并设置不同价格。</p>

<p>c)商品定价：<br>
如果选择按次售卖，则请设置商品单次价格。<br>
如果选择按周期售卖，则需要设置允许订购的周期，新购价格，续费价格。新购、续费价格以单月为基价，不同订购周期的价格为基价*订购周期的月份数。如果需要设置优惠，请联系小二操作。</p>

<p>d)填写完成后，请点击”提交”。提交后商品会进入审核流程。</p>

<p>6.钉钉类商品Sku Code</p>

<p>如果您的钉钉类商品需要版本对应的Sku Code，请提交商品信息后，在商品列表页面点击”管理”。进入商品详情页面后，点击”销售信息”tab，在下图位置可以查看版本对应的Sku Code。
<img src="https://img.alicdn.com/tps/TB1Ts0RLXXXXXbgXXXXXXXXXXXX-865-460.png"  alt="图片名称" align=right /></p>

<ul>
<li>3.2 查看商品</li>
</ul>

<p>您可以在<a href="http://msp.aliyun.com/commodity/manage/index"><font color=red>服务商平台</font></a>左侧菜单中商品管理查看您的商品。
您可以通过商品的上架状态和审核状态对商品进行筛选，并且可以通过列表进入商品详情页面进行商品管理。
<img alt="viewProduct" src="https://img.alicdn.com/tps/TB1R44FLXXXXXc1XpXXXXXXXXXX-865-284.png" /></p>

<ul>
<li>3.3 查看审核</li>
</ul>

<p>提交商品后，小二会针对商品进行审核。
商品审核分为两个阶段：商品接入审核、商品售卖信息审核。</p>

<p>商品接入审核：
小二会先对商品的接入信息进行审核，如果审核通过，则开始进行售卖信息审核。如果接入信息审核驳回，您可以在商品列表中看到商品审核状态为驳回，并且查看驳回原因。您可以编辑商品信息，重新提交审核。</p>

<p>商品售卖信息审核：
完成商品接入审核后，小二会进行商品售卖信息的审核。
如果售卖信息审核驳回，您可以在商品列表中看到商品审核状态为驳回，并且查看驳回原因。
您可以编辑商品的售卖信息，重新提交审核。(此时不能修改商品接入信息。)
如果售卖信息审核通过，商品会自动上架。</p>

<ul>
<li>3.4 编辑商品</li>
</ul>

<p>您的商品审核通过上架后，您可以在商品详情页面编辑商品信息。
<img alt="updateProduct" src="https://img.alicdn.com/tps/TB1y4FVLXXXXXXfXXXXXXXXXXXX-865-179.png" />
切换不同的tab页面，点击”编辑”按钮进入编辑状态。
商品的接入信息修改后，需要小二重新进行审核。审核通过后，会将显示给用户的信息自动更新。
商品的基本信息、业务信息和销售信息修改后，不需要经过小二审核，会直接影响前台展示的内容。</p>

<ul>
<li>3.5 下架商品</li>
</ul>

<p>如果您的商品已经上架，需要进行下架，请联系小二进行操作。
您的商品下架后，您可以在商品列表中点击”继续发布”，重新提交审核。</p>

<h3 id="4-如何进行交易管理">4. 如何进行交易管理</h3>

<ul>
<li>4.1 订单管理</li>
</ul>

<p>您可以在<a href="http://msp.aliyun.com/order/order_list.htm"><font color=red>服务商平台</font></a>左侧菜单中交易管理-订单管理查看订单信息
<img alt="orderManage" src="https://img.alicdn.com/tps/TB1wvXFLXXXXXc8XpXXXXXXXXXX-465-387.png" /></p>

<p>您可以通过订单ID、客户ID、订单状态等条件查询订单。在”操作”栏，点击”查看”可以查看订单详细信息。
<img alt="orderManage1" src="https://img.alicdn.com/tps/TB1fI4yLXXXXXc_XFXXXXXXXXXX-865-396.png" /></p>

<p>在订单还未支付前，可以点击”订单改价”修改订单的支付价格。在支付价格中填入金额，填写修改原因，点击”提交”，可以将订单的支付价格修改为您填写的金额。
<img alt="orderManage2" src="https://img.alicdn.com/tps/TB1GetsLXXXXXbJXVXXXXXXXXXX-865-257.png" />
在订单支付后，可以点击”关联业务”查看订单生成的业务实例。您也可以从业务管理菜单中直接查看业务信息。</p>

<ul>
<li>4.2 业务管理</li>
</ul>

<p>您可以在<a href="http://msp.aliyun.com/orderbiz/order_biz_list.htm"><font color=red>服务商平台</font></a>左侧菜单中交易管理-业务管理查看业务信息
<img alt="bizManage" src="https://img.alicdn.com/tps/TB1eUhwLXXXXXXQXVXXXXXXXXXX-865-376.png" />
您可以通过业务ID、客户ID、业务状态等条件查询业务。在”操作”栏，点击”查看”可以查看业务详细信息。
在业务详细信息中，可以在”补充页面信息”栏中填写您对业务的备注，并且在列表页面可以根据这个信息进行搜索。
<img alt="bizStatusManage" src="https://img.alicdn.com/tps/TB1yXXNLXXXXXXKXpXXXXXXXXXX-865-144.png" />
钉钉类商品的业务状态</p>

<p>开通中</p>

<p>已开通</p>

<p>已过期</p>

<p>已关闭</p>

<p>对于钉钉类型商品，如果状态是开通中，可以点击”开通应用”来手动开通。
<img src="https://img.alicdn.com/tps/TB1ynxtLXXXXXa1XVXXXXXXXXXX-865-133.png"  alt="图片名称" align=right /></p>

<ul>
<li>4.3 退款管理</li>
</ul>

<p>您可以在<a href="http://msp.aliyun.com/refund/refund_record_list.htm"><font color=red>服务商平台</font></a>左侧菜单中交易管理-退款管理查看退款信息。
<img alt="refundManage" src="https://img.alicdn.com/tps/TB1zoJJLXXXXXaeXpXXXXXXXXXX-865-250.png" />
用户购买的商品，在交易担保期内，可以享受不满意全额退款。详细规则请参考http://help.aliyun.com/knowledge_detail/6555340.html</p>

<p>用户申请退款后，您可以在退款管理中查看到退款申请。
您可以通过申请人、退款状态等条件查询退款申请。在”操作”栏，点击”查看”可以查看退款详细信息。</p>

<p>退款状态:</p>

<p>审核中： 用户提交退款申请，需要服务商进行审核</p>

<p>已取消：用户取消了提交的退款申请</p>

<p>退款中：服务商同意退款申请，系统进行退款中</p>

<p>退款成功：已经成功进行退款</p>

<p>审核不通过：服务商驳回了用户的退款申请</p>

<p>审核中的退款申请，您可以在退款申请的详情页面进行审核通过或者审核驳回。
如果您不处理用户的退款申请，3个自然日后系统会自动通过退款申请。</p>

<ul>
<li>4.4 评价管理</li>
</ul>

<p>您可以在<a href="http://msp.aliyun.com/orderrate/index.htm"><font color=red>服务商平台</font></a>左侧菜单中买家评价管理查看和回复用户对商品的评价。
<img alt="evaluateManage" src="https://img.alicdn.com/tps/TB17JxrLXXXXXcPXVXXXXXXXXXX-865-383.png" />
您可以通过客户ID、商品名称、回复状态等条件查询用户回复。
用户可以对交易进行一次初评和一次追评，您可以分别针对初评和追评进行回复。用户的评价信息和您的回复都会显示在商品详情下方。</p>

<ul>
<li>4.5 客户管理</li>
</ul>

<p>您可以在<a href="http://msp.aliyun.com/orderrate/index.htm"><font color=red>服务商平台</font></a>左侧菜单中客户管理查看购买了您商品的客户。
<img alt="customersManage" src="https://img.alicdn.com/tps/TB1kHlULXXXXXX8XXXXXXXXXXXX-865-360.png" />
您可以通过客户ID、客户名称、联系方式来查找客户。在操作栏点击”关联产品”可以查看这个客户购买的业务。</p>

<h3 id="5-如何生产商品">5. 如何生产商品</h3>

<p>钉钉类型的商品的生产过程：
商品类型 | 生产/服务过程
&mdash;&mdash; | &mdash;&ndash; 
钉钉类商品  | 需要先通过钉钉验收，审核上架后，用户购买商品进行授权开通，ISV应用接收授权信息后立即开通</p>

<ul>
<li>5.1 ISV接入API</li>
</ul>

<p>ISV通过接入API实现用户购买、续费、商品过期信息的处理，通过购买时云市场传入的corpid与钉钉企业进行关联，实现开通时的企业绑定；通过续费接口实现对钉钉企业商品有效期的管理；通过商品过期接口实现对应用内企业数据的导出、备份等操作</p>

<p>接口调试工具：http://msp.aliyun.com/isvDoc  ISV需要使用用MSP的帐号登陆进行调试</p>

<p>接口说明：<a href="http://gongdan.oss-cn-hangzhou.aliyuncs.com/market/%E4%BA%91%E5%B8%82%E5%9C%BA%E5%95%86%E5%93%81%E6%8E%A5%E5%85%A5%E6%96%87%E6%A1%A3.zip?spm=5176.776672277.0.0.EFfNfS&amp;file=%E4%BA%91%E5%B8%82%E5%9C%BA%E5%95%86%E5%93%81%E6%8E%A5%E5%85%A5%E6%96%87%E6%A1%A3.zip"><font color=red>云市场商品接入API文档</font></a></p>

<h3 id="6-线下操作">6. 线下操作</h3>

<ul>
<li>6.1 结算收款
次月底前阿里云为ISV结算上月全部交易额</li>
<li>6.2 开据发票
ISV开全额发票给企业用户</li>
<li>6.3 线下退款
ISV可与企业用户协商进行线下退款</li>
</ul>

<h3 id="7-用户授权">7.  用户授权</h3>

<p>当企业管理员通过云市场完成套件购买后，通过钉钉授权功能进行钉钉套件授权开通，具体授权开通流程见：
<a href="#企业管理员授权应用"><font color=red >企业管理员授权应用</font></a></p>

<h2 id="isv通用技术方案">ISV通用技术方案</h2>

<h3 id="isv套件对企业独立部署方案">ISV套件对企业独立部署方案</h3>

<h4 id="背景：">背景：</h4>

<p>在面向企业级软件领域，ISV提供企业的软件系统分2种形态：1，SAAS应用软件；2，独立部署的软件系统；钉钉的C＋＋战略立足于与ISV合作伙伴一起为企业提供专业的、安全的移动办公解决方案，因此需要解决SAAS应用软件和ISV独立部署软件系统与钉钉结合的版本可以快速部署，降低整体方案的推广与实施成本。</p>

<h4 id="概述：">概述：</h4>

<p>本方案对于ISV软件与钉钉的结合版本通过统一的授权模型实现可对任意企业客户统一实施钉钉＋X的版本，由钉钉根据ISV提供的套件相关信息统一生成二维码，企业用户通过二维码下载钉钉、注册钉钉企业、对套件进行授权后使用。
技术实现说明：（此处只针对独立部署的场景进行描述，SAAS类系统见<a href="#ISV接入开发指南"><font color=red >ISV接入开发指南</font></a>）</p>

<h4 id="系统实现：">系统实现：</h4>

<h5 id="名词解释：">名词解释：</h5>

<p>ISV套件授权系统：ISV用于与钉钉开放平台进行授权的独立系统，部署在阿里云的通用授权服务</p>

<p>ISV独立部署应用系统：ISV为企业独立部署的软件系统</p>

<h5 id="实现流程说明：">实现流程说明：</h5>

<p>1，    ISV开发完成套件并获取钉钉颁发的二维码</p>

<p>2，    ISV为企业进行独立软件部署完成</p>

<p>3，    企业扫码注册成功后输入ISV系统的关联码（如：序列号、企业ID等）用于钉钉企业与ISV系统用户进行关联</p>

<p>4，    企业进行套件使用授权</p>

<p>a)  ISV套件授权系统通过钉钉开放平台完成授权，参考钉钉isv（服务提供商）应用授权和接口说明</p>

<p>b)  ISV套件授权系统通过钉钉开放平台接口获取企业输入的关联码与ISV独立部署系统进行关联</p>

<p>c)  ISV套件授权系统调用钉钉开放平台接口完成企业独立部署软件IP白名单设置，参考为授权方的企业单独设置ip白名单</p>

<p>d)  ISV套件授权系统获取企业永久授权码并进行存储</p>

<ul>
<li><p>方案一：ISV将获取到的永久授权码回传至独立部署的应用系统，独立部署应用系统通过授权码直接调用钉钉开放平台API</p></li>
<li><p>方案二：ISV独立部署应用数据请求先发送至ISV套件服务器，ISV套件服务器使用授权码调用钉钉开放平台API</p></li>
</ul>

<p>5，    完成授权开始使用</p>

<h5 id="系统交互图：">系统交互图：</h5>

<p><img alt="system_design" src="https://img.alicdn.com/tps/TB1TgCgLXXXXXXqXVXXXXXXXXXX-802-514.png" /></p>

<h3 id="isv用户账号绑定方案">ISV用户账号绑定方案</h3>

<h4 id="背景：">背景：</h4>

<p>在ISV开发钉钉套件时，存在2个独立账号体系，为提升用户的体验，需要对2个独立账号体系进行账号绑定，目前的账号分为3种情况：</p>

<p>1，只存在于ISV系统中的用户</p>

<p>2，只存在于钉钉系统中的用户</p>

<p>3，在钉钉与ISV系统中同时存在的用户</p>

<h4 id="概述：">概述：</h4>

<p>本方案用于ISV软件与钉钉的结合版本用户账号绑定的场景</p>

<h4 id="系统实现：">系统实现：</h4>

<p>1，只存在于ISV系统中的用户：</p>

<p>通过邀请码注册的企业可以调用钉钉开放平台的通讯录接口，具有通讯录维护的权限，通过接口直接同步企业组织结构及人员信息到钉钉</p>

<p>1.1 有手机号码：</p>

<p>通过钉钉开放平台接口同步企业及用户数据，ISV系统采用钉钉userid进行账号绑定</p>

<p>1.2 有邮箱：</p>

<p>采用快速部署方式，企业创建成功后通过钉钉接口获取加入团队链接，邮件通知企业员工进行加入，ISV系统采用钉钉userid进行账号绑定</p>

<p>2，只存在于钉钉系统中的用户：</p>

<p>ISV在企业授权时通过钉钉接口获取组织结构与人员信息，通过钉钉userid与ISV用户信息进行关联实现绑定</p>

<p>3，在钉钉与ISV系统中同时存在的用户：</p>

<p>ISV需以钉钉通讯录为准进行账号同步与绑定，与只存在于钉钉系统中的用户采用相同的处理方式，产品上可以实现让用户显示绑定已有ISV系统账号，通过免登获取钉钉userid进行系统账号绑定</p>

          <h1 id="标准规范">标准规范</h1>

<h2 id="成为isv的必要条件">成为ISV的必要条件</h2>

<p>开发者在成为钉钉应用服务商时需要满足以下条件：</p>

<ul>
<li>1，ISV必须注册钉钉企业并通过认证；</li>
<li>2，ISV必须注册阿里云账号并通过企业认证；</li>
</ul>

<p>开发者可以从 <a href="https://oa.dingtalk.com"><font color=red >钉钉管理后台</font></a> 进行注册／认证／登录钉钉企业管理后台
开发者可以通过<a href="http://console.d.aliyun.com"><font color=red >控制台</font></a>，进行注册／认证／登录开发者平台</p>

<h2 id="产品标准">产品标准</h2>

<h3 id="套件／微应用命名规范：">套件／微应用命名规范：</h3>

<p>1.不能使用通用名词命名，包括拼音谐音，如墨迹天气、滴滴打车，不能命名为天气，打车
2.不能带有钉钉，阿里，淘宝，等阿里巴巴关联产品和企业文字
3.应用不得包含虚假、欺骗或误导的陈述，或是使用的名称与其他应用类似
4.命名必须符合开发者相关协议条款,不得带有影射竞争对手，触犯法律和道德的文字
5.命名不能重名，一旦应用审核通过，则不允许同名应用提交申请
6.应用的名字、描述和截图与应用内容相关
7.应用不得包括符号，和任何“beta”、“demo”、“trial”或“test”版本的应用
8.建议不超过6个汉字</p>

<h3 id="场景化与钉钉统一通讯能力结合，比如消息，会话，钉，通讯录，群等如：">场景化与钉钉统一通讯能力结合，比如消息，会话，钉，通讯录，群等如：</h3>

<p><img alt="product_scene1" src="https://img.alicdn.com/tps/TB1FUmiLXXXXXauXFXXXXXXXXXX-431-613.png" />
<img alt="product_scene2" src="https://img.alicdn.com/tps/TB1EgabLXXXXXXIXVXXXXXXXXXX-467-556.png" /></p>

<h3 id="需要在钉钉上形成完整的业务闭环，用户可以在钉钉手机端上解决完整的业务刚需">需要在钉钉上形成完整的业务闭环，用户可以在钉钉手机端上解决完整的业务刚需</h3>

<h3 id="需要按照钉钉ui规范进行产品设计，请下载">需要按照钉钉UI规范进行产品设计，<a href="http://download.taobaocdn.com/freedom/30563/compress/p1a5tl8v1d1fk91l9l15cu1vnp54l4.zip"><font color=red >请下载</font></a></h3>

<p><img alt="product_UI" src="https://img.alicdn.com/tps/TB18eWkLXXXXXcnXpXXXXXXXXXX-528-223.png" /></p>

<h3 id="如果已有原生app，-建议isv在钉钉版本上保留原生app的核心价值，并积极实现和原生app相同或更好的用户体验">如果已有原生APP， 建议ISV在钉钉版本上保留原生APP的核心价值，并积极实现和原生APP相同或更好的用户体验</h3>

<h3 id="降低用户使用门槛，原则上不出现任何注册功能，必须实现移动端应用无需注册，直接开通使用和免登，如有pc版，需要实现pc端的免登，但此功能非开始共创和灰度的必要条件，可以后续迭代完善">降低用户使用门槛，原则上不出现任何注册功能，必须实现移动端应用无需注册，直接开通使用和免登，如有PC版，需要实现PC端的免登，但此功能非开始共创和灰度的必要条件，可以后续迭代完善</h3>

<p><img alt="product_use" src="https://img.alicdn.com/tps/TB1ZNx3LXXXXXaIaXXXXXXXXXXX-644-575.png" /></p>

<h3 id="钉钉不会以任何方式提供客户的联系方式（包括手机，固定电话等），isv产品设计上也不能误导客户提供联系方式，如业务需要，则必须向客户明确说明，联系方式的真实使用目的，范围和场景，并让客户自行选择是否提供联系方式">钉钉不会以任何方式提供客户的联系方式（包括手机，固定电话等），ISV产品设计上也不能误导客户提供联系方式，如业务需要，则必须向客户明确说明，联系方式的真实使用目的，范围和场景，并让客户自行选择是否提供联系方式</h3>

<p><img alt="product_ feedback" src="https://img.alicdn.com/tps/TB17mSwLXXXXXXeXXXXXXXXXXXX-419-505.png" /></p>

<h3 id="商品上架前，提供产品的下一阶段的迭代计划；例如：">商品上架前，提供产品的下一阶段的迭代计划；例如：</h3>

<p><img alt="product_plan" src="https://img.alicdn.com/tps/TB17mSwLXXXXXXeXXXXXXXXXXXX-419-505.png" /></p>

<h2 id="技术标准">技术标准</h2>

<h3 id="质量标准">质量标准</h3>

<h4 id="tc验收标准：覆盖率大于等于95">TC验收标准：覆盖率大于等于95%</h4>

<ul>
<li>必要的输入：ISV提供《TC文档》，《需求规格说明书》</li>
<li>TC中必须包含但不限于场景要求：</li>
</ul>

<p>1.输入框必须校验：长度限制，特殊字符控制</p>

<p>2.网络情况：WiFi，2G，3G，4G</p>

<p>3.机型适配：见《附录3 适配机型列表》</p>

<p>4.钉钉版本适配：包含对钉钉版本支持的说明</p>

<p>5.图片：尺寸限制，大小限制</p>

<p>6.多端：PC与移动关联的功能场景 </p>

<h4 id="测试验收评分标准：验收评分必须大于90分验收通过，小于则不通过（一个版本验收不超过2次）">测试验收评分标准：验收评分必须大于90分验收通过，小于则不通过（一个版本验收不超过2次）</h4>

<ul>
<li>必要的输入：ISV提供《测试报告》，《bug列表》</li>
<li>评分细则（详细说明见《附录1 质量评分细则说明》）：
1.Blocker：功能主流程无法走通（验收不通过）</li>
</ul>

<p>2.Critical：系统无法执行、崩溃或严重资源不足、应用模块无法启动或异常退出、无法测试、造成系统不稳定。（验收不通过）</p>

<p>3.Major：部分非祝流程功能存在严重缺陷，但不会影响到系统稳定性（扣7分）</p>

<p>4.Minor：界面、性能缺陷（扣2分）</p>

<p>5.Trivial：易用性问题（扣1分）</p>

<h4 id="应用线上质量标准：">应用线上质量标准：</h4>

<p>1.ISV需按照《附录2线上故障定义表》 中的故障等级定义解决线上问题</p>

<p>2.P1/P2类bug 处理 原则当天发现当天解决不得过夜</p>

<p>3.P3类bug 处理 原则不得超过3天</p>

<p>4.P4类bug 处理 原则可在下个迭代发布中解决</p>

<h3 id="性能标准">性能标准</h3>

<h4 id="页面大小">页面大小</h4>

<p>首屏页面大小小于200k </p>

<h4 id="加载时间">加载时间</h4>

<p>首屏加载时间小于2s </p>

<h4 id="微应用性能检测">微应用性能检测</h4>

<p>使用钉钉官方提供的微应用性能检测工具，检测评分大于90分,评分工具地址：http://mqc.aliyun.com/hfive.htm?from=dingtalk；您需要使用阿里云帐号进行登陆</p>

<h3 id="安全标准">安全标准</h3>

<h4 id="应用服务安全标准：">应用服务安全标准：</h4>

<p>1.应用必须部署在阿里云（适用范围：SAAS类应用适用；独立部署应用不做此限制）</p>

<p>2.开启云盾全部防御功能，开启云监控，实时监控线上服务状况保障7*24小时防控</p>

<h4 id="代码安全标准：">代码安全标准：</h4>

<p>1.符合<a href="http://download.taobaocdn.com/freedom/30563/compress/p1a5tl8v1f1n1b1a4hk6vbl01nnv5.zip"><font color=red >《钉钉开放平台编码规范》</font></a></p>

<p>2.通过钉钉官方安全扫描</p>

<h3 id="数据采集标准">数据采集标准</h3>

<h4 id="数据指标：">数据指标：</h4>

<p>1.操作用户数：指每日在应用内重要按钮有操作行为的去重用户数</p>

<p>2.操作企业数：指每日在应用内重要按钮有操作行为的用户所在企业去重统计数</p>

<p>3.重要按钮：</p>

<p>1).重要的TAB页面切换，比如 应用有5个浏览页面，每次切换页面需要记录一个操作</p>

<p>2).向服务端有数据上传的点击，比如 表单保存，提交数据，页面修改，新增内容，上传图片等</p>

<h2 id="运营标准">运营标准</h2>

<h3 id="新用户引导">新用户引导</h3>

<p>如：</p>

<p><img alt="operation_newuser" src="https://img.alicdn.com/tps/TB1BEuXLXXXXXbtXVXXXXXXXXXX-337-392.png" /></p>

<h3 id="版本更新用户引导">版本更新用户引导</h3>

<p>如：</p>

<p><img alt="operation_newrelease" src="https://img.alicdn.com/tps/TB1.9KrLXXXXXXCXpXXXXXXXXXX-375-434.png" /></p>

<h3 id="用户反馈">用户反馈</h3>

<p>在应用中需要有方便用户反馈的入口，并确保可以及时给用户反馈，例如：
<img alt="operation_feedback" src="https://img.alicdn.com/tps/TB11uirLXXXXXXGXpXXXXXXXXXX-375-617.png" /></p>

<h3 id="用户使用手册">用户使用手册</h3>

<p>简单应用仅需提供H5使用手册，复杂并涉及到管理后台配置及操作的，需要提供PC端及H5使用手册。可参考钉钉现有体验站，或提供图文、视频等应用使用说明，方便用户参看或企业内传阅。参考<a href="http://download.taobaocdn.com/freedom/30563/compress/p1a5tl8v1libr132t1khc1gvi1nhr8.zip"><font color=red >《钉钉体验站模板及提交规范》</font></a>；例如：</p>

<p><img alt="operation_usemanual" src="https://img.alicdn.com/tps/TB1Zjh7LXXXXXcrXVXXXXXXXXXX-393-550.png" /></p>

<h2 id="上架（应用中心）标准">上架（应用中心）标准</h2>

<h3 id="服务提供商资质审核标准">服务提供商资质审核标准</h3>

<p>1、符合国家相关法律、法规规定，拥有正规的公司资质,具有15人以上的技术及客服团队;</p>

<p>2、拥有一年以上的该行业的服务经验;</p>

<p>3、可提供不少于5*8小时的客服在线服务;</p>

<p>4、提供的应用均以钉钉产品为使用场景;</p>

<p>5、接受《云市场服务商入驻协议 》以及 《云市场平台服务协议 》并按照协议相互约束的条款开展业务合作;</p>

<p>6、接受阿里云云市场的相关协议及管理规范；</p>

<h3 id="保证金规则">保证金规则</h3>

<table><thead>
<tr>
<th>分类</th>
<th>保证金金额</th>
</tr>
</thead><tbody>
<tr>
<td>A、免费应用</td>
<td>5万元</td>
</tr>
<tr>
<td>B、收费应用</td>
<td></td>
</tr>
<tr>
<td>累计交易额 0＜X≤500（万元）</td>
<td>10万</td>
</tr>
<tr>
<td>累计交易额 500＜X≤1000（万元）</td>
<td>50万</td>
</tr>
<tr>
<td>累计交易额 1000万元以上</td>
<td>100万</td>
</tr>
</tbody></table>

<h3 id="应用收费规则">应用收费规则</h3>

<p>支持按次售卖或按周期售卖</p>

<p>1.如果选择按次售卖，则请设置商品单次价格。免费商品价格设置0元，联系小二进行操作设置</p>

<p>2.如果选择按周期售卖，则需要设置允许订购的周期，新购价格，续费价格。新购、续费价格以单月为基价，不同订购周期的价格为基价*订购周期的月份数。如果需要设置优惠，请联系小二操作</p>

<h3 id="结算方式">结算方式</h3>

<h4 id="按月结算">按月结算</h4>

<p>次月底前阿里云为ISV结算上月全部交易额</p>

<h4 id="开票方式">开票方式</h4>

<p>ISV开全额发票给企业用户</p>

<p>1.分成：2016年3月份之前不进行分成，分成之后，分成部分的发票由阿里云为ISV进行开票</p>

<h2 id="附录1：质量评分细则说明">附录1：质量评分细则说明</h2>

<p>1） Blocker：阻碍开发或测试工作的问题。（这个测试人员通常很少遇到）（验收不通过）</p>

<p>2） Critical：系统无法执行、崩溃或严重资源不足、应用模块无法启动或异常退出、无法测试、造成系统不稳定。（验收不通过）
         具体为：</p>

<p>○ 严重花屏</p>

<p>○ 内存泄漏</p>

<p>○ 用户数据丢失或破坏</p>

<p>○ 系统崩溃/死机/冻结</p>

<p>○ 模块无法启动或异常退出</p>

<p>○ 严重的数值计算错误</p>

<p>○ 功能设计与需求严重不符</p>

<p>○ 用户权限问题</p>

<p>○ 安全问题</p>

<p>○ 其它导致无法测试的错误</p>

<p>3） Major：非祝流程功能存在严重缺陷，但不会影响到系统稳定性（验收不通过）
         具体为：</p>

<p>○功能未实现</p>

<p>○ 功能错误</p>

<p>○ 系统刷新错误</p>

<p>○ 语音或数据通讯错误</p>

<p>○ 轻微的数值计算错误</p>

<p>○ 系统所提供的功能或服务受明显的影响</p>

<p>4） Minor：界面、性能缺陷（扣2分）
         具体为：</p>

<p>○ 操作界面错误（包括数据窗口内列名定义、含义是否一致）</p>

<p>○ 边界条件下错误</p>

<p>○ 提示信息错误（包括未给出信息、信息提示错误等）</p>

<p>○ 长时间操作无进度提示</p>

<p>○ 系统未优化（性能问题）</p>

<p>○ 光标跳转设置不好，鼠标（光标）定位错误</p>

<p>5） Trivial：易用性及建议性问题（扣1分）
    具体为：</p>

<p>○ 界面格式等不规范</p>

<p>○ 辅助说明描述不清楚</p>

<p>○ 操作时未给用户提示</p>

<p>○ 可输入区域和只读区域没有明显的区分标志</p>

<p>○ 个别不影响产品理解的错别字</p>

<p>○ 文字排列不整齐等一些小问题</p>

<p>○ 建议</p>

<h2 id="附录2-线上故障定义表">附录2:线上故障定义表</h2>

<p><img alt="fault_list" src="https://img.alicdn.com/tps/TB1mWJ.LXXXXXbHXVXXXXXXXXXX-632-486.png" /></p>

<h2 id="附录3-适配机型列表">附录3:适配机型列表</h2>

<p>Android：（Android4.1及以上版本）</p>

<p>1、htc  x920e</p>

<ol>
<li><p>LG G2 A8</p></li>
<li><p>Coolpad A6</p></li>
<li><p>huawei g3</p></li>
<li><p>Moto G</p></li>
</ol>

<p>6、OPPO U705T Android 4.1.1</p>

<p>7、三星 s4 I9500 Android4.2.2</p>

<p>8、华为H60-L02</p>

<p>9、华为H30-L01</p>

<p>10、nexus 5 A10 5.1.1</p>

<p>11、coolpad 8720 Android 4.3</p>

<p>12、nexus 4</p>

<p>13、魅族MX4 Android 4.4.2</p>

<p>14、魅族MX4 Pro Android 4.4.4</p>

<p>15、三星Note 3 Android 4.3</p>

<p>16、Oppo813t 小屏</p>

<p>17、vivo S9t Android 4.1.2</p>

<p>18、三星GT-N7100 Android 4.1.2</p>

<p>19、魅族 M1 note   Android 4.4.4</p>

<p>20、华为Mate 7 5.1.1</p>

<p>21、联想A820t Android 4.1.2</p>

<p>iPhone：（IOS 7及以上版本）</p>

<p>iPhone 4s </p>

<p>iPhone 5 </p>

<p>iPhone 5c</p>

<p>iPhone 5s</p>

<p>iPhone6</p>

<p>iPhone 6plus </p>

<p>iPhone 6s</p>

          <h1 id="免登服务">免登服务</h1>

<p>通过免登服务，在企业微应用的H5中，无需重复输入用户名和密码，可以通过身份认证获取当前使用钉钉的用户身份及相关信息。</p>

<p>具体流程为：</p>

<p>1.获取CODE(免登授权码)，获取CODE的方式有两种，一种是调用js-api接口（推荐），一种是使用标准OAUTH2.0 HTTP 302跳转的方式。</p>

<p>2.通过CODE换取用户身份。</p>

<p>通过CODE获取用户身份会有一定的时间开销。对于频繁获取用户身份的场景，建议采用如下方案：</p>

<ol>
<li>用户跳转到企业页面时，企业校验是否有代表用户身份的cookie，此cookie由企业生成</li>
<li>如果没有获取到cookie，调用免登服务，获取用户身份后，由企业生成代表用户身份的cookie</li>
<li>根据cookie获取用户身份，进入相应的页面</li>
</ol>

<h2 id="手机客户端微应用中调用免登">手机客户端微应用中调用免登</h2>

<h3 id="使用js-api-推荐使用">使用JS-API(推荐使用)</h3>

<p>步骤一：首先需要获取当前用户的corpid。ISV开发者请在微应用主页地址使用$CORPID$模板参数表示corpid，用户访问微应用的时候钉钉服务器将把$CORPID$替换成用户所属企业的corpid，例如原本的主页地址是http://www.dingtalk.com/index，则能获取用户corpid的主页地址为http://www.dingtalk.com/index?corpid=$CORPID$</p>

<p>步骤二：使用钉钉js-api提供的<a href="#获取免登授权码"><font color=red >获取免登授权码</font></a>接口获取CODE</p>

<p>步骤二：<a href="#通过code换取用户身份"><font color=red >通过CODE换取身份</font></a></p>

<p>demo地址:<a href="https://github.com/injekt/openapi-demo-php/blob/master/public/javascripts/demo.js"><font color=red >https://github.com/injekt/openapi-demo-php/blob/master/public/javascripts/demo.js</font></a></p>

<h3 id="使用标准oauth2-0">使用标准OAUTH2.0</h3>

<p><a href="#http://tools.ietf.org/html/rfc6749"><font color=red >什么是OAUTH2.0</font></a></p>

<p>步骤一：企业在后台构造一个连接，通过HTTP 302跳转方式，让用户访问钉钉开放平台授权网址，构造的地址如下:</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/connect/oauth2/authorize?appid=CORPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE</code></p>

<p>其中REDIRECT_URI为企业H5地址，钉钉开放平台授权服务器如果判断当前用户属于当前企业时，会再次通过HTTP 302跳转回企业应用的H5地址(即REDIRECT_URI)，并在H5的URL后面追加参数code=CODE&amp;state=STATE,即</p>

<p><code class="prettyprint">REDIRECT_URI?code=CODE&amp;state=abcd1234</code></p>

<p>步骤二：企业在后台解析code参数，获取CODE</p>

<p>步骤三：<a href="#通过code换取用户身份"><font color=red >通过CODE换取身份</font></a></p>

<aside class="notice">
有安全限制，REDIRECT_URI域名必须包含在企业所有的微应用域名内,否则会提示无权访问页面，微应用请到钉钉oa后台->选择微应用菜单->微应用中心，添加微应用
</aside>

<h2 id="钉钉pc版微应用中调用免登">钉钉PC版微应用中调用免登</h2>

<h3 id="使用js-api-推荐使用">使用JS-API(推荐使用)</h3>

<p>步骤一：首先需要获取当前用户的corpid。ISV开发者请在微应用主页地址使用$CORPID$模板参数表示corpid，用户访问微应用的时候钉钉服务器将把$CORPID$替换成用户所属企业的corpid，例如原本的主页地址是http://www.dingtalk.com/index，则能获取用户corpid的主页地址为http://www.dingtalk.com/index?corpid=$CORPID$</p>

<p>步骤二：使用钉钉js-api提供的<a href="#pc版获取免登授权码"><font color=red >PC版获取免登授权码</font></a>接口获取CODE</p>

<p>步骤二：<a href="#通过code换取用户身份"><font color=red >通过CODE换取身份</font></a></p>

<p>demo： 可参考手机客户端免登demo，但全局变量dd替换成DingTalkPC</p>

<h3 id="使用标准oauth2-0">使用标准OAUTH2.0</h3>

<p><a href="#http://tools.ietf.org/html/rfc6749"><font color=red >什么是OAUTH2.0</font></a></p>

<p>步骤一：企业在后台构造一个连接，通过HTTP 302跳转方式，让用户访问钉钉开放平台授权网址，构造的地址如下:</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/connect/oauth2/authorize?appid=CORPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE</code></p>

<p>其中REDIRECT_URI为企业H5地址，钉钉开放平台授权服务器如果判断当前用户属于当前企业时，会再次通过HTTP 302跳转回企业应用的H5地址(即REDIRECT_URI)，并在H5的URL后面追加参数code=CODE&amp;state=STATE,即</p>

<p><code class="prettyprint">REDIRECT_URI?code=CODE&amp;state=abcd1234</code></p>

<p>步骤二：企业在后台解析code参数，获取CODE</p>

<p>步骤三：<a href="#通过code换取用户身份"><font color=red >通过CODE换取身份</font></a></p>

<aside class="notice">
有安全限制，REDIRECT_URI域名必须包含在企业所有的微应用域名内,否则会提示无权访问页面，微应用请到钉钉oa后台->选择微应用菜单->微应用中心，添加微应用
</aside>

<h2 id="微应用后台管理员免登">微应用后台管理员免登</h2>

<p>实现微应用后台管理系统与钉钉OA后台的免登</p>

<p>应用场景示例如下图：</p>

<p><img alt="normalcorp" src="https://img.alicdn.com/tps/TB1iw.4KFXXXXXoXFXXXXXXXXXX-594-302.png" /></p>

<p><strong>准备工作</strong>：</p>

<p>1: 配置微应用后台地址</p>

<p>普通企业在<a href="https://oa.dingtalk.com/#/microApp/microAppList"><font color=red>OA后台</font></a>添加微应用配置如左图，ISV在<a href="http://console.d.aliyun.com"><font color=red>开发者后台</font></a>添加微应用配置如下图</p>

<p><img alt="oaback" src="https://img.alicdn.com/tps/TB15zWTKFXXXXcEXVXXXXXXXXXX-642-367.jpg" /></p>

<p>2: 获取完成免登过程中验证身份的密钥（SSOSecret）</p>

<p><font color=red >重要说明：企业和ISV获取的方法一致，都是通过OA后台获取，ISV开发套件微应用的管理后台，使用自己企业的SSOSecret即可完成身份认证</font></p>

<p>在<a href="https://oa.dingtalk.com/#/microApp/microAppSet"><font color=red>OA后台</font></a>获取SSOSecret的方法如下：</p>

<p><img alt="normalcorp" src="https://img.alicdn.com/tps/TB1y_xcKVXXXXa6XXXXXXXXXXXX-1084-621.jpg" /></p>

<p><strong>使用方法（钉钉管理员登陆态）</strong> </p>

<p>步骤一：在OA后台，点击微应用的“进入后台”，自动跳转到准备工作1中配置的微应用后台地址，开发者从跳转的URL中解析code参数，获取CODE并保存下来</p>

<p>步骤二：通过<a href="#获取微应用后台管理Token"><font color=red >获取微应用后台管理Token</font></a>获取AccessToken</p>

<p>步骤三：使用AccessToken<a href="#通过code换取微应用管理员的身份信息"><font color=red >通过步骤一获取的CODE换取微应用管理员的身份信息</font></a></p>

<p><strong>更多用法</strong></p>

<p>在钉钉管理员非登陆态，使用钉钉管理后台的Oauth身份认证可以通过下面方法：</p>

<p>在管理员访问后台地址的时候，企业在后台构造一个连接，通过HTTP 302跳转方式，让用户访问钉钉开放平台授权网址，构造的地址如下:</p>

<p><code class="prettyprint">https://oa.dingtalk.com/omp/api/micro_app/admin/landing?corpid=CORPID&amp;redirect_url=REDIRECT_URL</code></p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpid</td>
<td>开发此微应用的公司corpid，ISV填写自己企业的CorpID</td>
</tr>
<tr>
<td>redirect_url</td>
<td>重定向地址(需要urlencode编码)</td>
</tr>
</tbody></table>

<p>REDIRECT_URL为微应用后台地址，首先跳转到钉钉OA管理后台登录页，登陆成功后，会再次通过HTTP 302跳转回微应用的后台地址(即REDIRECT_URL)，并在REDIRECT_URL后面追加参数code=CODE,即</p>

<p><code class="prettyprint">REDIRECT_URL?code=CODE</code></p>

<p>开发者从URL中解析code参数，获取CODE并保存下来，再按照上面使用方法中的步骤二和步骤三 获得管理员信息</p>

<p>demo查看:<a href="https://github.com/injekt/openapi-demo-java/tree/master/src/com/alibaba/dingtalk/openapi/servlet">https://github.com/injekt/openapi-demo-java/tree/master/src/com/alibaba/dingtalk/openapi/servlet</a></p>

<h2 id="普通钉钉用户账号开放及免登-暂未开放，敬请期待">普通钉钉用户账号开放及免登(暂未开放，敬请期待)</h2>

<p>第三方web服务提供者，通过此项服务，可以使用普通钉钉用户账号登录自有的系统，并可将自有系统的账号与钉钉账号进行绑定，同时还能够获取钉钉用户的个人及企业数据，如姓名、手机号、对应企业的名称、企业是否认证过、企业的权益等级、其在企业内是否为管理员等信息(取决于用户最终授权)。</p>

<p><font color=red >注:此功能与ISV没有关系，任何外部系统都可以使用。</font></p>

<p>1: 获取完成免登过程中验证身份的appId及appSecret。</p>

<p><font color=red >暂未开放，敬请期待</font></p>

<p>2: 使用appid及appSecret访问如下接口，获取accesstoken。</p>

<p>https://oapi.dingtalk.com/sns/gettoken?appid=APPID&amp;appsecret=APPSECRET</p>

<p>3: 在钉钉用户访问你的Web系统时，如果用户选择使用钉钉账号登录，则需要由你构造并引导用户跳转到如下链接。</p>

<p>https://oapi.dingtalk.com/connect/oauth2/sns_authorize?appid=APPID&amp;response_type=code&amp;scope=snsapi_login&amp;state=STATE&amp;redirect_uri=REDIRECT_URL</p>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>appid</td>
<td>需要在第1步获取,代表了你提供的服务，必填</td>
</tr>
<tr>
<td>redirect_url</td>
<td>重定向地址(需要urlencode编码),该地址所在域名需要配置为appid对应的安全域名，必填</td>
</tr>
<tr>
<td>state</td>
<td>用于防止重放攻击，选填</td>
</tr>
<tr>
<td>response_type</td>
<td>固定为code，必填</td>
</tr>
<tr>
<td>scope</td>
<td>固定为snsapi_login，必填</td>
</tr>
</tbody></table>

<p>4:在钉钉用户登录钉钉系统后，会302到你指定的redirect_url，并向url参数中追加code及state两个参数。</p>

<p>5:在你的web系统获取到代表用户的code之后，使用第2步获取的AccessToken及code获取当前钉钉用户授权过的个人数据。</p>

<p><a href="#通过code换取普通钉钉用户的身份信息"><font color=red >https://oapi.dingtalk.com/sns/getuserinfo?access_token=ACCESS_TOKEN&amp;code=CODE</font></a></p>

          <h1 id="服务端开发文档">服务端开发文档</h1>

<p>欢迎您，钉钉的开发者，我们很期待你成为钉钉开放平台的开发者。</p>

<p>微应用是钉钉为连接企业办公打造的移动入口，通过微应用你可以将企业的业务审批，内部OA，CRM，协作，上下游沟通连接到钉钉，更简单和低成本实现企业移动化； 结合钉钉的基础通信能力，让企业应用更活跃，员工更高效，移动化成本更低。</p>

<p>此文档很适合于:</p>

<ol>
<li><p>企业的IT部，了解钉钉如何连接你所在企业的办公；</p></li>
<li><p>服务提供商（ISV），了解如何通过钉钉为您的客户提供定制的企业办公软件，提升你的服务价值。</p></li>
</ol>

<h2 id="建立连接">建立连接</h2>

<p>你可以使用以下两种方式，将钉钉微应用连接到你的企业应用：</p>

<ol>
<li><p>企业应用服务器调用钉钉开放平台提供的接口，以钉钉微应用的身份给企业用户的钉钉账号推送消息，以下称 <strong>主动调用模式</strong>。</p></li>
<li><p>钉钉用户在使用企业提供的微应用H5页面时，该页面可以调用钉钉提供的JS接口，使用钉钉开放的终端能力和业务能力，以下称 <strong>JSAPI模式</strong>。</p></li>
<li><p>钉钉服务器把用户发送的消息或用户触发的事件推送给企业应用，由企业应用处理，以下称 <strong>回调模式</strong>。</p></li>
</ol>

<h3 id="主动调用">主动调用</h3>

<p>当企业应用服务器调用钉钉开放平台接口时，需使用https协议、Json数据格式、UTF8编码，访问域名为 https://oapi.dingtalk.com。
在每次主动调用钉钉开放平台接口时需要带上AccessToken参数。AccessToken参数由CorpID和CorpSecret换取。对于ISV来说，<a href="#8-获取企业授权的access_token"><font color=red>获取企业授权的access_token</font></a></p>

<p>CorpID是企业在钉钉中的标识，每个企业拥有一个唯一的CorpID；</p>

<p>CorpSecret是企业每个应用的凭证密钥。</p>

<p>CorpID及CorpSecret可以在钉钉为企业提供的管理后台中找到，由钉钉自动分配。</p>

<aside class="notice">
POST请求请在HTTP Header中设置 Content-Type:application/json，否则接口调用失败
</aside>

<h3 id="主动调用的频率限制">主动调用的频率限制</h3>

<p>当你获取到AccessToken时，你的微应用后台就可以成功调用钉钉后台所提供的各种接口或访问相应企业的资源或给成员发消息。</p>

<p>为了防止微应用的程序错误而引发钉钉服务器负载异常，默认情况下，每个服务端调用接口都有一定的频率限制，当超过此限制时，调用对应接口会收到相应错误码。</p>

<p>以下是当前默认的频率限制，钉钉后台可能会根据运营情况调整此阈值：</p>

<ul>
<li><p>每个企业调用单个接口的频率不可超过1500次/分</p></li>
<li><p>每个ISV（应用提供商）调用单个接口的频率不可超过2000次/分</p></li>
<li><p>每个ISV（应用提供商）调用单个企业的单个接口频率不可超过1500次/分</p></li>
<li><p>每个套件调用单个企业的单个接口频率不可超过1000次/分</p></li>
</ul>

<h4 id="获取accesstoken">获取AccessToken</h4>

<p>AccessToken是企业访问钉钉开放平台接口的全局唯一票据，调用接口时需携带AccessToken。</p>

<p>AccessToken需要用CorpID和CorpSecret来换取，不同的CorpSecret会返回不同的AccessToken。正常情况下AccessToken有效期为7200秒，有效期内重复获取返回相同结果，并自动续期。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET
<code class="prettyprint">https://oapi.dingtalk.com/gettoken?corpid=id&amp;corpsecret=secrect</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpid</td>
<td>String</td>
<td>是</td>
<td>企业Id</td>
</tr>
<tr>
<td>corpsecret</td>
<td>String</td>
<td>是</td>
<td>企业应用的凭证密钥</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>a)正确的Json返回结果:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fw8ef8we8f76e6f7s8df8s"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>access_token</td>
<td>获取到的凭证</td>
</tr>
</tbody></table>

<p>b)错误的Json返回示例:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">43003</span><span class="p">,</span><span class="w">
   </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"require https"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h4 id="获取微应用后台管理token">获取微应用后台管理Token</h4>

<p>本接口获取的Token和上面获取的AccessToken应用场景不一样，此token只在<a href="#oa后台调用管理员免登"><font color=red>微应用后台管理免登</font></a>服务中使用。
应用场景示例如下图：</p>

<p><img alt="normalcorp" src="https://img.alicdn.com/tps/TB1iw.4KFXXXXXoXFXXXXXXXXXX-594-302.png" /></p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET
<code class="prettyprint">https://oapi.dingtalk.com/sso/gettoken?corpid=id&amp;corpsecret=ssosecret</code></p>

<p>企业在<a href="https://oa.dingtalk.com/#/microApp/microAppSet"><font color=red>OA后台</font></a>获取SSOSecret的方法如下</p>

<p><img alt="normalcorp" src="https://img.alicdn.com/tps/TB1y_xcKVXXXXa6XXXXXXXXXXXX-1084-621.jpg" /></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpid</td>
<td>String</td>
<td>是</td>
<td>企业Id</td>
</tr>
<tr>
<td>corpsecret</td>
<td>String</td>
<td>是</td>
<td>这里必须填写专属的SSOSecret</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>a)正确的Json返回结果:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fw8ef8we8f76e6f7s8df8s"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>access_token</td>
<td>获取到的凭证</td>
</tr>
</tbody></table>

<p>b)错误的Json返回示例:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">43003</span><span class="p">,</span><span class="w">
   </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"require https"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="管理通讯录">管理通讯录</h2>

<h3 id="获取部门列表">获取部门列表</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/list?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
           </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"钉钉事业部"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"autoAddUser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"服务端开发组"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nt">"autoAddUser"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>department</td>
<td>部门列表数据。以部门的order字段从小到大排列</td>
</tr>
<tr>
<td>id</td>
<td>部门id</td>
</tr>
<tr>
<td>name</td>
<td>部门名称</td>
</tr>
<tr>
<td>parentid</td>
<td>父部门id，根部门为1</td>
</tr>
<tr>
<td>createDeptGroup</td>
<td>是否同步创建一个关联此部门的企业群, true表示是, false表示不是</td>
</tr>
<tr>
<td>autoAddUser</td>
<td>当群已经创建后，是否有新人加入部门会自动加入该群, true表示是, false表示不是</td>
</tr>
</tbody></table>

<h3 id="获取部门详情">获取部门详情</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/get?access_token=ACCESS_TOKEN&amp;id=2</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>是</td>
<td>部门id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"钉钉事业部"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"order"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"autoAddUser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptHiding"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptPerimits"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"3|4"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"orgDeptOwner"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptManagerUseridList"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122|manager3211"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>id</td>
<td>部门id</td>
</tr>
<tr>
<td>name</td>
<td>部门名称</td>
</tr>
<tr>
<td>parentid</td>
<td>父部门id，根部门为1</td>
</tr>
<tr>
<td>order</td>
<td>在父部门中的次序值</td>
</tr>
<tr>
<td>createDeptGroup</td>
<td>是否同步创建一个关联此部门的企业群, true表示是, false表示不是</td>
</tr>
<tr>
<td>autoAddUser</td>
<td>当群已经创建后，是否有新人加入部门会自动加入该群, true表示是, false表示不是</td>
</tr>
<tr>
<td>deptHiding</td>
<td>是否隐藏部门, true表示隐藏, false表示显示</td>
</tr>
<tr>
<td>deptPerimits</td>
<td>可以查看指定隐藏部门的其他部门列表，如果部门隐藏，则此值生效，取值为其他的部门id组成的的字符串，使用&rsquo; &#124; &lsquo;符号进行分割</td>
</tr>
<tr>
<td>orgDeptOwner</td>
<td>企业群群主</td>
</tr>
<tr>
<td>deptManagerUseridList</td>
<td>部门的主管列表,取值为由主管的userid组成的字符串，不同的userid使用&rsquo; &#124; &#39;符号进行分割</td>
</tr>
</tbody></table>

<h3 id="创建部门">创建部门</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"钉钉事业部"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>部门名称。长度限制为1~64个字符</td>
</tr>
<tr>
<td>parentid</td>
<td>String</td>
<td>是</td>
<td>父部门id。根部门id为1</td>
</tr>
<tr>
<td>order</td>
<td>String</td>
<td>否</td>
<td>在父部门中的次序值。order值小的排序靠前</td>
</tr>
<tr>
<td>createDeptGroup</td>
<td>Boolean</td>
<td>否</td>
<td>是否创建一个关联此部门的企业群，默认为false</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>id</td>
<td>创建的部门id</td>
</tr>
</tbody></table>

<h3 id="更新部门">更新部门</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/update?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"钉钉事业部"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"parentid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"createDeptGroup"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"autoAddUser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptManagerUseridList"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1111|2222"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptHiding"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deptPerimits"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12|23"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"orgDeptOwner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1111"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>string</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>否</td>
<td>部门名称。长度限制为1~64个字符</td>
</tr>
<tr>
<td>parentid</td>
<td>String</td>
<td>否</td>
<td>父部门id。根部门id为1</td>
</tr>
<tr>
<td>order</td>
<td>String</td>
<td>否</td>
<td>在父部门中的次序值。order值小的排序靠前</td>
</tr>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>部门id</td>
</tr>
<tr>
<td>createDeptGroup</td>
<td>Boolean</td>
<td>否</td>
<td>是否创建一个关联此部门的企业群</td>
</tr>
<tr>
<td>autoAddUser</td>
<td>Boolean</td>
<td>否</td>
<td>如果有新人加入部门是否会自动加入部门群</td>
</tr>
<tr>
<td>deptManagerUseridList</td>
<td>String</td>
<td>否</td>
<td>部门的主管列表,取值为由主管的userid组成的字符串，不同的userid使用&rsquo; &#124; &#39;符号进行分割</td>
</tr>
<tr>
<td>deptHiding</td>
<td>Boolean</td>
<td>否</td>
<td>是否隐藏部门</td>
</tr>
<tr>
<td>deptPerimits</td>
<td>String</td>
<td>否</td>
<td>可以查看指定隐藏部门的其他部门列表，如果部门隐藏，则此值生效，取值为其他的部门id组成的的字符串，使用&rsquo; &#124; &#39;符号进行分割</td>
</tr>
<tr>
<td>orgDeptOwner</td>
<td>String</td>
<td>否</td>
<td>企业群群主</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"updated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="删除部门">删除部门</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/department/delete?access_token=ACCESS_TOKEN&amp;id=ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>部门id。（注：不能删除根部门；不能删除含有子部门、成员的部门）</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取成员详情">获取成员详情</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/get?access_token=ACCESS_TOKEN&amp;userid=zhangsan</code></p>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工在企业内的UserID，企业用来唯一标识用户的字段。</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tel"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-123333"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"workPlace"</span><span class="w"> </span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"remark"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"mobile"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"13800000000"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dingding@aliyun.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"active"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"orderInDepts"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{1:10, 2:20}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isAdmin"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isBoss"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dingId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"WsUDaq7DCVIHc6z1GAsYDSA"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isLeaderInDepts"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{1:true, 2:false}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isHide"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
    </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"工程师"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dingtalk.com/abc.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"jobnumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"爱好"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"年龄"</span><span class="p">:</span><span class="s2">"24"</span><span class="w">
                </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userid</td>
<td>员工唯一标识ID（不可修改）</td>
</tr>
<tr>
<td>name</td>
<td>成员名称</td>
</tr>
<tr>
<td>tel</td>
<td>分机号（ISV不可见）</td>
</tr>
<tr>
<td>workPlace</td>
<td>办公地点（ISV不可见）</td>
</tr>
<tr>
<td>remark</td>
<td>备注（ISV不可见）</td>
</tr>
<tr>
<td>mobile</td>
<td>手机号码</td>
</tr>
<tr>
<td>email</td>
<td>电子邮箱</td>
</tr>
<tr>
<td>active</td>
<td>是否已经激活, true表示已激活, false表示未激活</td>
</tr>
<tr>
<td>orderInDepts</td>
<td>在对应的部门中的排序, Map结构的json字符串, key是部门的Id, value是人员在这个部门的排序值</td>
</tr>
<tr>
<td>isAdmin</td>
<td>是否为企业的管理员, true表示是, false表示不是</td>
</tr>
<tr>
<td>isBoss</td>
<td>是否为企业的老板, true表示是, false表示不是</td>
</tr>
<tr>
<td>dingId</td>
<td>钉钉Id</td>
</tr>
<tr>
<td>isLeaderInDepts</td>
<td>在对应的部门中是否为主管, Map结构的json字符串, key是部门的Id, value是人员在这个部门中是否为主管, true表示是, false表示不是</td>
</tr>
<tr>
<td>isHide</td>
<td>是否号码隐藏, true表示隐藏, false表示不隐藏</td>
</tr>
<tr>
<td>department</td>
<td>成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>职位信息</td>
</tr>
<tr>
<td>avatar</td>
<td>头像url</td>
</tr>
<tr>
<td>jobnumber</td>
<td>员工工号</td>
</tr>
<tr>
<td>extattr</td>
<td>扩展属性，可以设置多种属性(但手机上最多只能显示10个扩展属性，具体显示哪些属性，请到OA管理后台-&gt;设置-&gt;通讯录信息设置和OA管理后台-&gt;设置-&gt;手机端显示信息设置)性</td>
</tr>
</tbody></table>

<h3 id="创建成员">创建成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"orderInDepts"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{1:10, 2:20}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
    </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"产品经理"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15913215421"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tel"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-123333"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"workPlace"</span><span class="w"> </span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"remark"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan@gzdev.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"jobnumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"爱好"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"年龄"</span><span class="p">:</span><span class="s2">"24"</span><span class="w">
                </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>否</td>
<td>员工唯一标识ID（不可修改），企业内必须唯一。长度为1~64个字符，如果不传，服务器将自动生成一个userid</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>成员名称。长度为1~64个字符</td>
</tr>
<tr>
<td>orderInDepts</td>
<td>在对应的部门中的排序, Map结构的json字符串, key是部门的Id, value是人员在这个部门的排序值</td>
<td></td>
<td></td>
</tr>
<tr>
<td>department</td>
<td>List</td>
<td>是</td>
<td>数组类型，数组里面值为整型，成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>String</td>
<td>否</td>
<td>职位信息。长度为0~64个字符</td>
</tr>
<tr>
<td>mobile</td>
<td>String</td>
<td>是</td>
<td>手机号码。企业内必须唯一</td>
</tr>
<tr>
<td>tel</td>
<td>String</td>
<td>否</td>
<td>分机号，长度为0~50个字符</td>
</tr>
<tr>
<td>workPlace</td>
<td>String</td>
<td>否</td>
<td>办公地点，长度为0~50个字符</td>
</tr>
<tr>
<td>remark</td>
<td>String</td>
<td>否</td>
<td>备注，长度为0~1000个字符</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>否</td>
<td>邮箱。长度为0~64个字符。企业内必须唯一</td>
</tr>
<tr>
<td>jobnumber</td>
<td>String</td>
<td>否</td>
<td>员工工号。对应显示到OA后台和客户端个人资料的工号栏目。长度为0~64个字符</td>
</tr>
<tr>
<td>extattr</td>
<td>JSONObject</td>
<td>否</td>
<td>扩展属性，可以设置多种属性(但手机上最多只能显示10个扩展属性，具体显示哪些属性，请到OA管理后台-&gt;设置-&gt;通讯录信息设置和OA管理后台-&gt;设置-&gt;手机端显示信息设置)</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dedwefewfwe1231"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userid</td>
<td>员工唯一标识</td>
</tr>
</tbody></table>

<h3 id="更新成员">更新成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/update?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
    </span><span class="nt">"orderInDepts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{1:10}"</span><span class="p">,</span><span class="w"> 
    </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"产品经理"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15913215421"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tel"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-123333"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"workPlace"</span><span class="w"> </span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"remark"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan@gzdev.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"jobnumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"爱好"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"年龄"</span><span class="p">:</span><span class="s2">"24"</span><span class="w">
                </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明（如果非必须的字段未指定，则钉钉后台不改变该字段之前设置好的值）">参数说明（如果非必须的字段未指定，则钉钉后台不改变该字段之前设置好的值）</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工唯一标识ID（不可修改），企业内必须唯一。长度为1~64个字符</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>成员名称。长度为1~64个字符</td>
</tr>
<tr>
<td>department</td>
<td>List</td>
<td>否</td>
<td>成员所属部门id列表</td>
</tr>
<tr>
<td>orderInDepts</td>
<td>JSONObject</td>
<td>否</td>
<td>实际是Map的序列化字符串，Map的Key是deptId，表示部门id，Map的Value是order，表示排序的值，列表是按order的倒序排列输出的，即从大到小排列输出的</td>
</tr>
<tr>
<td>position</td>
<td>String</td>
<td>否</td>
<td>职位信息。长度为0~64个字符</td>
</tr>
<tr>
<td>mobile</td>
<td>String</td>
<td>否</td>
<td>手机号码。企业内必须唯一</td>
</tr>
<tr>
<td>tel</td>
<td>String</td>
<td>否</td>
<td>分机号，长度为0~50个字符</td>
</tr>
<tr>
<td>workPlace</td>
<td>String</td>
<td>否</td>
<td>办公地点，长度为0~50个字符</td>
</tr>
<tr>
<td>remark</td>
<td>String</td>
<td>否</td>
<td>备注，长度为0~1000个字符</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>否</td>
<td>邮箱。长度为0~64个字符。企业内必须唯一</td>
</tr>
<tr>
<td>jobnumber</td>
<td>String</td>
<td>否</td>
<td>员工工号，对应显示到OA后台和客户端个人资料的工号栏目。长度为0~64个字符</td>
</tr>
<tr>
<td>extattr</td>
<td>JSONObject</td>
<td>否</td>
<td>扩展属性，可以设置多种属性(但手机上最多只能显示10个扩展属性，具体显示哪些属性，请到OA管理后台-&gt;设置-&gt;通讯录信息设置和OA管理后台-&gt;设置-&gt;手机端显示信息设置)</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"updated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="删除成员">删除成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/delete?access_token=ACCESS_TOKEN&amp;userid=ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工唯一标识ID（不可修改）</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="批量删除成员">批量删除成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/batchdelete?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构">请求包结构</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"useridlist"</span><span class="p">:[</span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="s2">"lisi"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>useridlist</td>
<td>List</td>
<td>是</td>
<td>员工UserID列表。列表长度在1到20之间</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取部门成员">获取部门成员</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/simplelist?access_token=ACCESS_TOKEN&amp;department_id=1</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>department_id</td>
<td>long</td>
<td>是</td>
<td>获取的部门id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userlist</td>
<td>成员列表</td>
</tr>
<tr>
<td>userid</td>
<td>员工唯一标识ID（不可修改）</td>
</tr>
<tr>
<td>name</td>
<td>成员名称</td>
</tr>
<tr>
<td>active</td>
<td>表示该用户是否激活了钉钉</td>
</tr>
</tbody></table>

<h3 id="获取部门成员（详情）">获取部门成员（详情）</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/list?access_token=ACCESS_TOKEN&amp;department_id=1</code></p>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>department_id</td>
<td>long</td>
<td>是</td>
<td>获取的部门id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userlist"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"dingId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dwdded"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13122222222"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"tel"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-123333"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"workPlace"</span><span class="w"> </span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"remark"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"order"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"isAdmin"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"isBoss"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nt">"isHide"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"isLeader"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
            </span><span class="nt">"position"</span><span class="p">:</span><span class="w"> </span><span class="s2">"工程师"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan@alibaba-inc.com"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"avatar"</span><span class="p">:</span><span class="w">  </span><span class="s2">"./dingtalk/abc.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"jobnumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"extattr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"爱好"</span><span class="p">:</span><span class="s2">"旅游"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"年龄"</span><span class="p">:</span><span class="s2">"24"</span><span class="w">
                </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>userlist</td>
<td>成员列表</td>
</tr>
<tr>
<td>userid</td>
<td>员工唯一标识ID（不可修改）</td>
</tr>
<tr>
<td>order</td>
<td>表示人员在此部门中的排序，列表是按order的倒序排列输出的，即从大到小排列输出的</td>
</tr>
<tr>
<td>dingId</td>
<td>钉钉ID</td>
</tr>
<tr>
<td>mobile</td>
<td>手机号（ISV不可见）</td>
</tr>
<tr>
<td>tel</td>
<td>分机号（ISV不可见）</td>
</tr>
<tr>
<td>workPlace</td>
<td>办公地点（ISV不可见）</td>
</tr>
<tr>
<td>remark</td>
<td>备注（ISV不可见）</td>
</tr>
<tr>
<td>isAdmin</td>
<td>是否是企业的管理员, true表示是, false表示不是</td>
</tr>
<tr>
<td>isBoss</td>
<td>是否为企业的老板, true表示是, false表示不是</td>
</tr>
<tr>
<td>isHide</td>
<td>是否隐藏号码, true表示是, false表示不是</td>
</tr>
<tr>
<td>isLeader</td>
<td>是否是部门的主管, true表示是, false表示不是</td>
</tr>
<tr>
<td>name</td>
<td>成员名称</td>
</tr>
<tr>
<td>active</td>
<td>表示该用户是否激活了钉钉</td>
</tr>
<tr>
<td>department</td>
<td>成员所属部门id列表</td>
</tr>
<tr>
<td>position</td>
<td>职位信息</td>
</tr>
<tr>
<td>email</td>
<td>邮箱</td>
</tr>
<tr>
<td>avatar</td>
<td>头像url</td>
</tr>
<tr>
<td>jobnumber</td>
<td>员工工号</td>
</tr>
<tr>
<td>extattr</td>
<td>扩展属性，可以设置多种属性(但手机上最多只能显示10个扩展属性，具体显示哪些属性，请到OA管理后台-&gt;设置-&gt;通讯录信息设置和OA管理后台-&gt;设置-&gt;手机端显示信息设置)</td>
</tr>
</tbody></table>

<!--
"mobile": "15913215421",
mobile | 手机号码
-->

<h2 id="管理微应用">管理微应用</h2>

<h3 id="创建微应用">创建微应用</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/microapp/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"appIcon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@HIdsabikkhjsdsas"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"appName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试微应用"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"appDesc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试使用的微应用"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"homepageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://oa.dingtalk.com/?h5"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"pcHomepageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://oa.dingtalk.com/?pc"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ompLink"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>appIcon</td>
<td>String</td>
<td>是</td>
<td>微应用的图标。需要调用上传接口将图标上传到钉钉服务器后获取到的mediaId</td>
</tr>
<tr>
<td>appName</td>
<td>String</td>
<td>是</td>
<td>微应用的名称。长度限制为1~10个字符</td>
</tr>
<tr>
<td>appDesc</td>
<td>String</td>
<td>是</td>
<td>微应用的描述。长度限制为1~20个字符</td>
</tr>
<tr>
<td>homepageUrl</td>
<td>String</td>
<td>是</td>
<td>微应用的移动端主页，必须以http开头或https开头</td>
</tr>
<tr>
<td>pcHomepageUrl</td>
<td>String</td>
<td>否</td>
<td>微应用的PC端主页，必须以http开头或https开头，如果不为空则必须与homepageUrl的域名一致</td>
</tr>
<tr>
<td>ompUrl</td>
<td>String</td>
<td>否</td>
<td>微应用的OA后台管理主页，必须以http开头或https开头</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>id</td>
<td>创建的部门id</td>
</tr>
</tbody></table>

<h2 id="群会话接口（暂未开放）">群会话接口（暂未开放）</h2>

<h3 id="创建会话">创建会话</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"群名称"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"useridlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="s2">"lisi"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>群名称。长度限制为1~20个字符</td>
</tr>
<tr>
<td>owner</td>
<td>String</td>
<td>是</td>
<td>群主userId，员工唯一标识ID；必须为该会话useridlist的成员之一</td>
</tr>
<tr>
<td>useridlist</td>
<td>String[]</td>
<td>是</td>
<td>群成员列表，每次最多操作40人，群人数上限为1000</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxxxxxxxxxxxx"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>chatid</td>
<td>群会话的标识ID</td>
</tr>
</tbody></table>

<h3 id="修改会话">修改会话</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/update?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxxxxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"群名称"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"add_useridlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"lisi"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"del_useridlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"wangwu"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>否</td>
<td>群名称。长度限制为1~20个字符，不传则不修改</td>
</tr>
<tr>
<td>owner</td>
<td>String</td>
<td>否</td>
<td>群主userId，员工唯一标识ID；必须为该会话成员之一；不传则不修改</td>
</tr>
<tr>
<td>add_useridlist</td>
<td>String[]</td>
<td>否</td>
<td>添加成员列表，每次最多操作40人，群人数上限为1000</td>
</tr>
<tr>
<td>del_useridlist</td>
<td>String[]</td>
<td>否</td>
<td>删除成员列表，每次最多操作40人，群人数上限为1000</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取会话">获取会话</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/get?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"chat_info"</span><span class="p">:</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"群名称"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"useridlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"zhangsan"</span><span class="p">,</span><span class="s2">"lisi"</span><span class="p">],</span><span class="w">
            </span><span class="nt">"agentidlist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"12345"</span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>chat_info</td>
<td>群会话信息</td>
</tr>
<tr>
<td>name</td>
<td>群名称</td>
</tr>
<tr>
<td>owner</td>
<td>群主userid</td>
</tr>
<tr>
<td>useridlist</td>
<td>群成员userId列表</td>
</tr>
<tr>
<td>agentidlist</td>
<td>群绑定的微应用agentId列表</td>
</tr>
</tbody></table>

<h3 id="绑定微应用和群会话">绑定微应用和群会话</h3>

<p>此接口仅限ISV接入使用</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/bind?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>agentid</td>
<td>String</td>
<td>是</td>
<td>微应用agentId，每个群最多绑定5个微应用，一个群只能被一个ISV套件绑定一次</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="解绑微应用和群会话">解绑微应用和群会话</h3>

<p>此接口仅限ISV接入使用</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/unbind?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>agentid</td>
<td>String</td>
<td>是</td>
<td>微应用agentId</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="发送消息到群会话">发送消息到群会话</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/chat/send?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h4 id="消息类型及数据格式">消息类型及数据格式</h4>

<h5 id="text消息">text消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三的请假申请"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：text</td>
</tr>
</tbody></table>

<h6 id="text消息体格式">text消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text.content</td>
<td>String</td>
<td>是</td>
<td>消息内容</td>
</tr>
</tbody></table>

<h5 id="image消息">image消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：image</td>
</tr>
</tbody></table>

<h6 id="image消息体格式">image消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>image.media_id</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取。建议宽600像素 x 400像素，宽高比3：2</td>
</tr>
</tbody></table>

<h5 id="voice消息">voice消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"voice"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"voice"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：voice</td>
</tr>
</tbody></table>

<h6 id="voice消息体格式">voice消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>voice.media_id</td>
<td>String</td>
<td>是</td>
<td>语音媒体文件id，可以调用上传媒体文件接口获取。2MB，播放长度不超过60s，AMR格式</td>
</tr>
</tbody></table>

<h5 id="file消息">file消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"file"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：file</td>
</tr>
</tbody></table>

<h6 id="file消息体格式">file消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>file.media_id</td>
<td>String</td>
<td>是</td>
<td>媒体文件id，可以调用上传媒体文件接口获取。10MB</td>
</tr>
</tbody></table>

<h5 id="link消息">link消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"picUrl"</span><span class="p">:</span><span class="s2">"@lALOACZwe2Rk"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"messageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s.dingtalk.com/market/dingtalk/error_code.php"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：link</td>
</tr>
</tbody></table>

<h6 id="link消息体格式">link消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>link.title</td>
<td>String</td>
<td>是</td>
<td>消息标题</td>
</tr>
<tr>
<td>link.text</td>
<td>String</td>
<td>是</td>
<td>消息描述</td>
</tr>
<tr>
<td>link.pic_url</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取</td>
</tr>
<tr>
<td>link.message_url</td>
<td>String</td>
<td>是</td>
<td>消息点击链接地址</td>
</tr>
</tbody></table>

<h5 id="oa消息">OA消息</h5>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
     </span><span class="nt">"chatid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chatxxxxxxxxx"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1122"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"oa"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"oa"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"message_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.dingtalk.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"pc_message_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://oa.dingtalk.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"head"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"bgcolor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FFBBBBBB"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"头部标题"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"正文标题"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"form"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"姓名:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"年龄:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"身高:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.8米"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"体重:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"130斤"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"学历:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"本科"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"爱好:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"打球、听音乐"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nt">"rich"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"num"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15.6"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"元"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@lADOADmaWMzazQKA"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"file_count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"李四 "</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatid</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>发送者的userid</td>
</tr>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：oa</td>
</tr>
</tbody></table>

<h6 id="oa消息体格式">OA消息体格式</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>oa.message_url</td>
<td>String</td>
<td>是</td>
<td>客户端点击消息时跳转到的H5地址</td>
</tr>
<tr>
<td>oa.pc_message_url</td>
<td>String</td>
<td>否</td>
<td>PC端点击消息时跳转到的URL地址</td>
</tr>
<tr>
<td>oa.head</td>
<td>String</td>
<td>是</td>
<td>消息头部内容</td>
</tr>
<tr>
<td>oa.head.bgcolor</td>
<td>String</td>
<td>是</td>
<td>消息头部的背景颜色。长度限制为8个英文字符，其中前2为表示透明度，后6位表示颜色值。不要添加0x</td>
</tr>
<tr>
<td>oa.head.text</td>
<td>String</td>
<td>是</td>
<td>消息的头部标题</td>
</tr>
<tr>
<td>oa.body</td>
<td>Array[JSON Object]</td>
<td>是</td>
<td>消息体</td>
</tr>
<tr>
<td>oa.body.title</td>
<td>String</td>
<td>否</td>
<td>消息体的标题</td>
</tr>
<tr>
<td>oa.body.form</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>消息体的表单，最多显示6个，超过会被隐藏</td>
</tr>
<tr>
<td>oa.body.form.key</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字</td>
</tr>
<tr>
<td>oa.body.form.value</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字对应的值</td>
</tr>
<tr>
<td>oa.body.rich</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>单行富文本信息</td>
</tr>
<tr>
<td>oa.body.rich.num</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的数目</td>
</tr>
<tr>
<td>oa.body.rich.unit</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的单位</td>
</tr>
<tr>
<td>oa.body.content</td>
<td>String</td>
<td>否</td>
<td>消息体的内容，最多显示3行</td>
</tr>
<tr>
<td>oa.body.image</td>
<td>String</td>
<td>否</td>
<td>消息体中的图片media_id</td>
</tr>
<tr>
<td>oa.body.file_count</td>
<td>String</td>
<td>否</td>
<td>自定义的附件数目。此数字仅供显示，钉钉不作验证</td>
</tr>
<tr>
<td>oa.body.author</td>
<td>String</td>
<td>否</td>
<td>自定义的作者名字</td>
</tr>
</tbody></table>

<h4 id="oa消息截图">OA消息截图</h4>

<p><img alt="oames" src="https://img.alicdn.com/tps/TB1gVcFIFXXXXcGXXXXXXXXXXXX.jpg" /></p>

<h2 id="crm接口（暂未开放）">CRM接口（暂未开放）</h2>

<p>您可以通过使用CRM接口，将您的CRM应用中的员工与客户的关系、客户与客户联系人的关系在钉钉客户端通讯录中展现，与钉钉有更深入的功能融合，对于用户来说客户关系与通讯录的紧密结合，更容易管理和联系核心客户</p>

<h3 id="员工新增客户信息">员工新增客户信息</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/customer/create?access_token=ACCESS_TOKEN&amp;user_id=USER_ID</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"customer"</span><span class="p">:[</span><span class="w">
</span><span class="p">{</span><span class="w">
</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"姓名"</span><span class="p">,</span><span class="w">
</span><span class="nt">"address"</span><span class="p">:</span><span class="s2">"地址"</span><span class="p">,</span><span class="w">
</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"描述"</span><span class="p">,</span><span class="w">
</span><span class="nt">"telephone"</span><span class="p">:</span><span class="s2">"电话"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="nt">"contacts"</span><span class="p">:[</span><span class="w">
</span><span class="p">{</span><span class="w">
</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"姓名"</span><span class="p">,</span><span class="w">
</span><span class="nt">"mobile"</span><span class="p">:</span><span class="s2">"手机"</span><span class="p">,</span><span class="w">
</span><span class="nt">"attached"</span><span class="p">:</span><span class="s2">"备注"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="nt">"userIds"</span><span class="p">:[</span><span class="w">
</span><span class="s2">"USER_ID"</span><span class="p">,</span><span class="s2">"USER_ID"</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="nt">"create_by"</span><span class="p">:</span><span class="s2">"创建时间"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>user_id</td>
<td>String</td>
<td>是</td>
<td>员工在企业内的userid</td>
</tr>
<tr>
<td>customer</td>
<td>JSONObject</td>
<td>是</td>
<td>客户信息</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>客户名称</td>
</tr>
<tr>
<td>address</td>
<td>String</td>
<td>是</td>
<td>客户地址</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>是</td>
<td>客户描述</td>
</tr>
<tr>
<td>telephone</td>
<td>String</td>
<td>是</td>
<td>客户电话</td>
</tr>
<tr>
<td>contacts</td>
<td>JSONObject</td>
<td>否</td>
<td>客户联系人信息</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>否</td>
<td>客户联系人名称</td>
</tr>
<tr>
<td>mobile</td>
<td>String</td>
<td>否</td>
<td>客户联系人手机</td>
</tr>
<tr>
<td>attached</td>
<td>String</td>
<td>否</td>
<td>客户联系人备注</td>
</tr>
<tr>
<td>userIds</td>
<td>String[]</td>
<td>否</td>
<td>跟进客户的员工信息</td>
</tr>
<tr>
<td>create_by</td>
<td>String</td>
<td>是</td>
<td>创建时间</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customerid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xxxxxxxxxxxxxxxxxx"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>customerid</td>
<td>客户id</td>
</tr>
</tbody></table>

<h3 id="员工修改客户信息">员工修改客户信息</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/customer/update?access_token=ACCESS_TOKEN&amp;user_id=USER_ID</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"客户id"</span><span class="p">,</span><span class="w">
</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"客户名称"</span><span class="p">,</span><span class="w">
</span><span class="nt">"address"</span><span class="p">:</span><span class="s2">"客户地址"</span><span class="p">,</span><span class="w">
</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"客户描述"</span><span class="p">,</span><span class="w">
</span><span class="nt">"telephone"</span><span class="p">:</span><span class="s2">"电话"</span><span class="p">,</span><span class="w">
</span><span class="nt">"modified_by"</span><span class="p">:</span><span class="s2">"修改时间"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>user_id</td>
<td>String</td>
<td>是</td>
<td>员工id</td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>是</td>
<td>客户id</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>否</td>
<td>客户名称</td>
</tr>
<tr>
<td>address</td>
<td>String</td>
<td>否</td>
<td>客户地址信息</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>否</td>
<td>客户描述信息</td>
</tr>
<tr>
<td>telephone</td>
<td>String</td>
<td>否</td>
<td>客户联系电话</td>
</tr>
<tr>
<td>modified_by</td>
<td>String</td>
<td>否</td>
<td>修改时间</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="员工删除客户">员工删除客户</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/customer/delete?access_token=ACCESS_TOKEN&amp;user_id=USER_ID</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"id[]"</span><span class="p">:</span><span class="s2">"客户id"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>user_id</td>
<td>String</td>
<td>是</td>
<td>会话id</td>
</tr>
<tr>
<td>id</td>
<td>String[]</td>
<td>是</td>
<td>客户id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取客户详细信息">获取客户详细信息</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/customer/get?access_token=ACCESS_TOKEN&amp;id=CUSTOMER_ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>是</td>
<td>客户id</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"customer"</span><span class="p">:{</span><span class="w">

</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"客户名称"</span><span class="p">,</span><span class="w">
</span><span class="nt">"address"</span><span class="p">:</span><span class="s2">"客户地址"</span><span class="p">,</span><span class="w">
</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"客户描述"</span><span class="p">,</span><span class="w">
</span><span class="nt">"telephone"</span><span class="p">:</span><span class="s2">"客户电话"</span><span class="w">
</span><span class="p">},</span><span class="w">
</span><span class="nt">"contactList"</span><span class="p">:[</span><span class="w">
</span><span class="p">{</span><span class="w">
</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"客户联系人名称"</span><span class="p">,</span><span class="w">
</span><span class="nt">"mobile"</span><span class="p">:</span><span class="s2">"客户联系人电话"</span><span class="p">,</span><span class="w">
</span><span class="nt">"attached"</span><span class="p">:</span><span class="s2">"客户联系人备注"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="nt">"userIds"</span><span class="p">:[</span><span class="w">
                </span><span class="s2">"USER_ID"</span><span class="p">,</span><span class="s2">"USER_ID"</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="nt">"create_by"</span><span class="p">:</span><span class="s2">"创建时间"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>customer</td>
<td>客户信息</td>
</tr>
<tr>
<td>name</td>
<td>客户名称</td>
</tr>
<tr>
<td>address</td>
<td>客户地址</td>
</tr>
<tr>
<td>description</td>
<td>客户描述</td>
</tr>
<tr>
<td>telephone</td>
<td>客户电话</td>
</tr>
<tr>
<td>contacts</td>
<td>客户联系人信息</td>
</tr>
<tr>
<td>name</td>
<td>客户联系人名称</td>
</tr>
<tr>
<td>mobile</td>
<td>客户联系人手机</td>
</tr>
<tr>
<td>attached</td>
<td>客户联系人备注</td>
</tr>
<tr>
<td>userIds</td>
<td>跟进客户的员工信息</td>
</tr>
<tr>
<td>create_by</td>
<td>创建时间</td>
</tr>
</tbody></table>

<h3 id="获取客户列表">获取客户列表</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/customer/get?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"customerlist"</span><span class="p">:[</span><span class="w">
</span><span class="p">{</span><span class="w">
</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"客户名称"</span><span class="p">,</span><span class="w">
</span><span class="nt">"address"</span><span class="p">:</span><span class="s2">"客户地址"</span><span class="p">,</span><span class="w">
</span><span class="nt">"description"</span><span class="p">:</span><span class="s2">"客户描述"</span><span class="p">,</span><span class="w">
</span><span class="nt">"telephone"</span><span class="p">:</span><span class="s2">"客户电话"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>customerlist</td>
<td>客户列表信息</td>
</tr>
<tr>
<td>name</td>
<td>客户名称</td>
</tr>
<tr>
<td>address</td>
<td>客户地址</td>
</tr>
<tr>
<td>description</td>
<td>客户描述</td>
</tr>
<tr>
<td>telephone</td>
<td>客户电话</td>
</tr>
</tbody></table>

<h3 id="员工新增客户联系人">员工新增客户联系人</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/contact/create?access_token=ACCESS_TOKEN&amp;user_id=USER_ID</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"customerid"</span><span class="p">:</span><span class="s2">"客户id"</span><span class="p">,</span><span class="w">
</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"客户联系人名称"</span><span class="p">,</span><span class="w">
</span><span class="nt">"mobile"</span><span class="p">:</span><span class="s2">"客户联系人手机"</span><span class="p">,</span><span class="w">
</span><span class="nt">"attached"</span><span class="p">:</span><span class="s2">"客户联系人备注"</span><span class="p">,</span><span class="w">
</span><span class="nt">"create_by"</span><span class="p">:</span><span class="s2">"创建时间"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>user_id</td>
<td>String</td>
<td>是</td>
<td>员工id</td>
</tr>
<tr>
<td>customerid</td>
<td>客户id</td>
<td></td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>客户联系人名称</td>
<td></td>
<td></td>
</tr>
<tr>
<td>mobile</td>
<td>客户联系人手机</td>
<td></td>
<td></td>
</tr>
<tr>
<td>attached</td>
<td>客户联系人备注</td>
<td></td>
<td></td>
</tr>
<tr>
<td>create_by</td>
<td>创建时间</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="员工修改客户联系人">员工修改客户联系人</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/contact/create?access_token=ACCESS_TOKEN&amp;user_id=USER_ID</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"contactid"</span><span class="p">:</span><span class="s2">"客户联系人id"</span><span class="p">,</span><span class="w">
</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"客户联系人名称"</span><span class="p">,</span><span class="w">
</span><span class="nt">"mobile"</span><span class="p">:</span><span class="s2">"客户联系人手机"</span><span class="p">,</span><span class="w">
</span><span class="nt">"attached"</span><span class="p">:</span><span class="s2">"客户联系人备注"</span><span class="p">,</span><span class="w">
</span><span class="nt">"modified_by"</span><span class="p">:</span><span class="s2">"修改时间"</span><span class="w">      
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>user_id</td>
<td>String</td>
<td>是</td>
<td>员工id</td>
</tr>
<tr>
<td>contactid</td>
<td>String</td>
<td>是</td>
<td>客户id</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>客户联系人名称</td>
</tr>
<tr>
<td>mobile</td>
<td>String</td>
<td>是</td>
<td>客户联系人手机</td>
</tr>
<tr>
<td>attached</td>
<td>String</td>
<td>是</td>
<td>客户联系人备注</td>
</tr>
<tr>
<td>modified_by</td>
<td>String</td>
<td>是</td>
<td>修改时间</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="员工删除客户联系人">员工删除客户联系人</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/contact/delete?access_token=ACCESS_TOKEN&amp;user_id=USER_ID</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"contactid[]"</span><span class="p">:</span><span class="s2">"客户联系人id1"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>user_id</td>
<td>String</td>
<td>是</td>
<td>员工id</td>
</tr>
<tr>
<td>contactid</td>
<td>String[]</td>
<td>是</td>
<td>客户id</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="员工客户关系新增">员工客户关系新增</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/empcustomer/create?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"customerId"</span><span class="p">:</span><span class="s2">"客户id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userId"</span><span class="p">:</span><span class="s2">"员工id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"create_by"</span><span class="p">:</span><span class="s2">"创建时间"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>customerId</td>
<td>String</td>
<td>是</td>
<td>客户id</td>
</tr>
<tr>
<td>userId</td>
<td>String</td>
<td>是</td>
<td>员工id</td>
</tr>
<tr>
<td>create_by</td>
<td>String</td>
<td>是</td>
<td>创建时间</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="员工客户关系删除">员工客户关系删除</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/crm/empcustomer/delete?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"customerId"</span><span class="p">:</span><span class="s2">"客户id"</span><span class="p">,</span><span class="w">
</span><span class="nt">"userId"</span><span class="p">:</span><span class="s2">"员工id"</span><span class="p">,</span><span class="w">
</span><span class="nt">"modified_by"</span><span class="p">:</span><span class="s2">"修改时间"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>customerId</td>
<td>String</td>
<td>是</td>
<td>客户id</td>
</tr>
<tr>
<td>userId</td>
<td>String</td>
<td>是</td>
<td>员工id</td>
</tr>
<tr>
<td>modified_by</td>
<td>String</td>
<td>是</td>
<td>修改时间</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h2 id="通讯录变更事件回调接口">通讯录变更事件回调接口</h2>

<p>在使用回调接口之前您需要了解的是，</p>

<p>首先您需要准备好，</p>

<ul>
<li><p>URL:<a href="#注册事件回调接口"><font color=red>注册事件回调接口</font></a>填写的接收推送的地址</p></li>
<li><p>Token:<a href="#注册事件回调接口"><font color=red>注册事件回调接口</font></a>中任意填写的，用来生成signature，用来和回调参数中的signature比对，校验消息的合法性</p></li>
<li><p>数据加密密钥(ENCODING_AES_KEY):<a href="#注册事件回调接口"><font color=red>注册事件回调接口</font></a>中填写的数据加密密钥。用于回调数据的加解密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取,您可以随机生成。</p></li>
</ul>

<p>钉钉服务器会向回调url推送事件变更。</p>

<p>假设您提供的回调URL是</p>

<p><code class="prettyprint">https://127.0.0.1/suite/receive</code></p>

<p>那么在钉钉服务器每一次访问回调URL的时候
将请求(下面链接中的signature,timestamp,nonce的值只是示例，并不代表真实返回的值):</p>

<p><code class="prettyprint">https://127.0.0.1/suite/receive?signature=111108bb8e6dbce3c9671d6fdb69d15066227608
&amp;timestamp=1783610513&amp;nonce=380320111</code></p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>回调数据的格式如右所示：</p>

<p>其中的encrypt字段是经过加密的消息体，encrypt经过一系列解密步骤后，才能产生下面所说的“POST数据解密后示例”，服务提供商可以直接使用钉钉提供的库进行解密的处理。</p>

<p>除此之外，在接收到推送之后，<strong>需要返回字符串success（代表了你收到了推送），返回的数据也需要做加密处理</strong>，如果不返回，钉钉服务器将持续推送下去，达到一定阈值后将不再推送。</p>

<p>&ldquo;Talk is cheap, show me the code.&quot;所以我们也为开发者提供了加解密的demo，目前提供Java/PHP等语言版本。
加解密库和demo的下载：<a href="#加解密库和demo下载"><font color=red >加解密库和demo下载</font></a></p>

<p>如有需要，可以查看具体加解密步骤：<a href="#12-加解密方案"><font color=red >查看</font></a></p>

<h3 id="事件回调">事件回调</h3>

<p>当企业通讯录发生变化，并且事件类型包含在注册时填写的&quot;call_back_tag&quot;中时，比如call_back_tag字段为&rdquo;[&ldquo;user_add_org&rdquo;,&ldquo;user_modify_org&rdquo;]&ldquo;，那么企业通讯录发生了&quot;通讯录用户增加&quot;和&quot;讯录用户更改&quot;，钉钉服务器会向url推送事件。</p>

<p>目前可以监听的事件类型分别为:</p>

<ul>
<li>user_add_org : 通讯录用户增加</li>
<li>user_modify_org : 通讯录用户更改</li>
<li>user_leave_org : 通讯录用户离职</li>
<li>org_admin_add ：通讯录用户被设为管理员</li>
<li>org_admin_remove ：通讯录用户被取消设置管理员</li>
<li>org_dept_create ： 通讯录企业部门创建</li>
<li>org_dept_modify ： 通讯录企业部门修改</li>
<li>org_dept_remove ： 通讯录企业部门删除</li>
</ul>

<p>POST数据解密后示例
接收到推送之后请务必返回经过加密的字符串&quot;success&quot;的json数据</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"EventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">43535463645</span><span class="p">,</span><span class="w">
    </span><span class="nt">"UserId"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"efefef"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"111111"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"CorpId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"corpid"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>EventType</td>
<td>事件类型，有八种，&quot;user_add_org&rdquo;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;,&ldquo;org_admin_add&rdquo;, &ldquo;org_admin_remove&rdquo;, &ldquo;org_dept_create&rdquo;, &ldquo;org_dept_modify&rdquo;, &ldquo;org_dept_remove&rdquo;</td>
</tr>
<tr>
<td>TimeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>UserId</td>
<td>用户发生变更的userid列表</td>
</tr>
<tr>
<td>DeptId</td>
<td>部门发生变更的userid列表</td>
</tr>
<tr>
<td>CorpId</td>
<td>发生通讯录变更的企业</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w">
 </span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&ldquo;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h3 id="注册事件回调接口">注册事件回调接口</h3>

<p>注册回调接口的时候，钉钉服务器会回调<a href="#测试回调url"><font color=red>测试回调url</font></a>，来验证填写的url的合法性，需要您再接收到回调之后返回加密字符串&quot;success&quot;的json数据,才能完成注册。</p>

<p><img src="https://img.alicdn.com/tps/TB10MOOJFXXXXbdXpXXXXXXXXXX-373-351.png" width = "373" height = "351" alt="图片名称" align=center /></p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/register_call_back?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"call_back_tag"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_modify_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_leave_org"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"aes_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="s2">"www.dingtalk.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>call_back_tag</td>
<td>Array[String]</td>
<td>是</td>
<td>需要监听的事件类型，有八种，&quot;user_add_org&rdquo;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;,&ldquo;org_admin_add&rdquo;, &ldquo;org_admin_remove&rdquo;, &ldquo;org_dept_create&rdquo;, &ldquo;org_dept_modify&rdquo;, &ldquo;org_dept_remove&rdquo;</td>
</tr>
<tr>
<td>token</td>
<td>String</td>
<td>是</td>
<td>加解密需要用到的token，ISV(服务提供商)推荐使用注册套件时填写的token，普通企业可以随机填写</td>
</tr>
<tr>
<td>aes_key</td>
<td>String</td>
<td>是</td>
<td>数据加密密钥。用于回调数据的加密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取,您可以随机生成，ISV(服务提供商)推荐使用注册套件时填写的EncodingAESKey</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>是</td>
<td>接收事件回调的url</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="查询事件回调接口">查询事件回调接口</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: get</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/get_call_back?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">   
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"call_back_tag"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_modify_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_leave_org"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"aes_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="s2">"www.dingtalk.com"</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>access_token</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>call_back_tag</td>
<td>需要监听的事件类型，有八种，&quot;user_add_org&quot;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;,&ldquo;org_admin_add&rdquo;, &ldquo;org_admin_remove&rdquo;, &ldquo;org_dept_create&rdquo;, &ldquo;org_dept_modify&rdquo;, &ldquo;org_dept_remove&rdquo;</td>
</tr>
<tr>
<td>token</td>
<td>加解密需要用到的token，ISV(服务提供商)推荐使用注册套件时填写的token，普通企业可以随机填写</td>
</tr>
<tr>
<td>aes_key</td>
<td>数据加密密钥。用于回调数据的加密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取,您可以随机生成，ISV(服务提供商)推荐使用注册套件时填写的EncodingAESKey</td>
</tr>
<tr>
<td>url</td>
<td>接收事件回调的url</td>
</tr>
</tbody></table>

<h3 id="更新事件回调接口">更新事件回调接口</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/update_call_back?access_token=ACCESS_TOKEN</code></p>

<h6 id="请求包结构体">请求包结构体</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"call_back_tag"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_modify_org"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user_leave_org"</span><span class="p">,</span><span class="s2">"org_admin_add"</span><span class="p">,</span><span class="w"> </span><span class="s2">"org_admin_remove"</span><span class="p">,</span><span class="w"> </span><span class="s2">"org_dept_create"</span><span class="p">,</span><span class="w"> </span><span class="s2">"org_dept_modify"</span><span class="p">,</span><span class="w"> </span><span class="s2">"org_dept_remove"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"aes_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11111111lvdhntotr3x9qhlbytb18zyz5z111111111"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"www.dingtalk.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>call_back_tag</td>
<td>Array[String]</td>
<td>是</td>
<td>需要监听的事件类型，有八种，&quot;user_add_org&quot;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;,&ldquo;org_admin_add&rdquo;, &ldquo;org_admin_remove&rdquo;, &ldquo;org_dept_create&rdquo;, &ldquo;org_dept_modify&rdquo;, &ldquo;org_dept_remove&rdquo;</td>
</tr>
<tr>
<td>token</td>
<td>String</td>
<td>是</td>
<td>加解密需要用到的token，ISV(服务提供商)推荐使用注册套件时填写的token，普通企业可以随机填写</td>
</tr>
<tr>
<td>aes_key</td>
<td>String</td>
<td>是</td>
<td>数据加密密钥。用于回调数据的加密，长度固定为43个字符，从a-z, A-Z, 0-9共62个字符中选取,您可以随机生成，ISV(服务提供商)推荐使用注册套件时填写的EncodingAESKey</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>是</td>
<td>接收事件回调的url</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="删除事件回调接口">删除事件回调接口</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: get</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/delete_call_back?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="获取回调失败的结果">获取回调失败的结果</h3>

<p>钉钉服务器给回调接口推送 通讯录变更事件的时候，有可能因为各种原因推送失败(比如网络异常)，此时钉钉服务器将保留此次变更事件。</p>

<p>用户可以通过此回调接口获取推送失败的变更事件。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: get</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/call_back/get_call_back_failed_result?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="nt">"failed_list"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"event_time"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">32112412</span><span class="p">,</span><span class="w">
            </span><span class="nt">"call_back_tag"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"userid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">""</span><span class="p">,</span><span class="s2">""</span><span class="p">],</span><span class="w">
            </span><span class="nt">"corpid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"event_time"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">24431231</span><span class="p">,</span><span class="w">
            </span><span class="nt">"call_back_tag"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"user_add_org"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"userid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">""</span><span class="p">,</span><span class="s2">""</span><span class="p">],</span><span class="w">
            </span><span class="nt">"corpid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
<tr>
<td>has_more</td>
<td>是否还有推送失败的变更事件，若为true,则表示还有未回调的事件</td>
</tr>
<tr>
<td>failed_list</td>
<td>事件列表，一次最多200个</td>
</tr>
<tr>
<td>event_time</td>
<td>事件的时间戳</td>
</tr>
<tr>
<td>call_back_tag</td>
<td>事件类型，有八种，&quot;user_add_org&quot;, &ldquo;user_modify_org&rdquo;, &ldquo;user_leave_org&rdquo;,&ldquo;org_admin_add&rdquo;, &ldquo;org_admin_remove&rdquo;, &ldquo;org_dept_create&rdquo;, &ldquo;org_dept_modify&rdquo;, &ldquo;org_dept_remove&rdquo;</td>
</tr>
<tr>
<td>userid</td>
<td>相关员工列表</td>
</tr>
<tr>
<td>deptid</td>
<td>相关部门列表</td>
</tr>
<tr>
<td>corpid</td>
<td>相关企业id</td>
</tr>
</tbody></table>

<h3 id="测试回调url">测试回调url</h3>

<p>在您注册事件回调接口的时候，钉钉服务器会向您”注册回调接口“时候上传的url(接收回调的url)推送一条消息，用来测试url的合法性。</p>

<p>收到消息需要返回经过加密后的字符串&quot;success&quot;的json数据，否则钉钉服务器将认为url不合法，从而不予推送。</p>

<p>POST数据解密后示例</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"EventType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"check_url"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>EventType</td>
<td>&ldquo;check_url&rdquo;</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<p>服务提供商在收到此事件推送后务必返回包含经过加密的字符串&quot;success&quot;的json数据</p>

<p>只有返回了对应的json数据，钉钉才会判断此事件推送成功，套件才能创建成功。</p>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"msg_signature"</span><span class="p">:</span><span class="s2">"111108bb8e6dbce3c9671d6fdb69d15066227608"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeStamp"</span><span class="p">:</span><span class="s2">"1783610513"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nonce"</span><span class="p">:</span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encrypt"</span><span class="p">:</span><span class="s2">"1ojQf0NSvw2WPvW7LijxS8UvISr8pdDP+rXpPbcLGOmIBNbWetRg7IP0vdhVgkVwSoZBJeQwY2zhROsJq/HJ+q6tp1qhl9L1+ccC9ZjKs1wV5bmA9NoAWQiZ+7MpzQVq+j74rJQljdVyBdI/dGOvsnBSCxCVW0ISWX0vn9lYTuuHSoaxwCGylH9xRhYHL9bRDskBc7bO0FseHQQasdfghjkl"</span><span class="w">
  </span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msg_signature</td>
<td>消息体签名</td>
</tr>
<tr>
<td>timeStamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>nonce</td>
<td>随机字符串</td>
</tr>
<tr>
<td>encrypt</td>
<td>&ldquo;success&quot;加密字符串</td>
</tr>
</tbody></table>

<h2 id="发送普通会话消息">发送普通会话消息</h2>

<p>员工可以在微应用中把消息发送到同企业的人或群。</p>

<p>调用接口时，使用Https协议、JSON数据包格式。</p>

<p>目前支持文本、图片、语音、普通文件、OA消息以及link等消息类型，每个消息都由消息头和消息体组成，普通会话的消息头由sender,cid组成。消息体请参见以下各种<a href="#消息类型及数据格式"><font color=red >消息类型</font></a>。</p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>sender</td>
<td>String</td>
<td>是</td>
<td>消息发送者员工ID</td>
</tr>
<tr>
<td>cid</td>
<td>String</td>
<td>是</td>
<td>群消息或者个人聊天会话Id，(通过<a href="#获取会话信息"><font color=red>JSAPI之pickConversation接口</font></a>唤起联系人界面拿到会话ID）</td>
</tr>
</tbody></table>

<p>普通会话消息样例：</p>

<p><img alt="msg1" src="https://img.alicdn.com/tps/TB1FVMvIFXXXXcnXXXXXXXXXXXX.jpg" /></p>

<h3 id="发送普通会话消息接口说明">发送普通会话消息接口说明</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/message/send_to_conversation?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>如果是群，返回跟发送者同一家企业的一组工号；如果是个人聊天，只返回发送者同一家企业的一个工号；不在同一家企业，发送失败</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"receiver"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UserID1|UserID2"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="发送企业会话消息">发送企业会话消息</h2>

<p>企业可以主动发消息给员工，消息量不受限制。</p>

<p>发送企业会话消息和发送普通会话消息的不同之处在于发送消息的主体不同
- 普通会话消息发送主体是普通员工，体现在接收方手机上的联系人是消息发送员工</p>

<ul>
<li>企业会话消息发送主体是企业，体现在接收方手机上的联系人是你填写的agentid对应的微应用</li>
</ul>

<p>调用接口时，使用Https协议、JSON数据包格式。</p>

<p>目前支持text、image、voice、file、link、OA消息类型。每个消息都由消息头和消息体组成，企业会话的消息头由touser,toparty,agentid组成。消息体请参见以下各种<a href="#消息类型及数据格式"><font color=red >消息类型</font></a>。</p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>touser</td>
<td>String</td>
<td>否</td>
<td>员工ID列表（消息接收者，多个接收者用&rsquo; &#124; &#39;分隔）。特殊情况：指定为@all，则向该企业应用的全部成员发送</td>
</tr>
<tr>
<td>toparty</td>
<td>String</td>
<td>否</td>
<td>部门id列表，多个接收者用&rsquo; &#124; &#39;分隔。当touser为@all时忽略本参数 <font color=red >touser或者toparty 二者有一个必填</font></td>
</tr>
<tr>
<td>agentid</td>
<td>String</td>
<td>是</td>
<td>企业应用id，这个值代表以哪个应用的名义发送消息</td>
</tr>
</tbody></table>

<p>企业会话消息样例：</p>

<p><img alt="msg2" src="https://img.alicdn.com/tps/TB1PAQwIFXXXXXOXXXXXXXXXXXX.jpg" /></p>

<h3 id="发送企业消息接口说明">发送企业消息接口说明</h3>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/message/send?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>如果收件人、部门或标签不存在，发送仍然执行，但返回无效的部分。</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"invaliduser"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UserID1|UserID2"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"invalidparty"</span><span class="p">:</span><span class="s2">"PartyID1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="消息类型及数据格式">消息类型及数据格式</h2>

<h3 id="text消息">text消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三的请假申请"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：text</td>
</tr>
<tr>
<td>content</td>
<td>String</td>
<td>是</td>
<td>消息内容</td>
</tr>
</tbody></table>

<h3 id="image消息">image消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：image</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取。建议宽600像素 x 400像素，宽高比3：2</td>
</tr>
</tbody></table>

<h3 id="voice消息">voice消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"voice"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"voice"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：voice</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>语音媒体文件id，可以调用上传媒体文件接口获取。2MB，播放长度不超过60s，AMR格式</td>
</tr>
</tbody></table>

<h3 id="file消息">file消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"file"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MEDIA_ID"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：file</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>媒体文件id，可以调用上传媒体文件接口获取。10MB</td>
</tr>
</tbody></table>

<h3 id="link消息">link消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"messageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s.dingtalk.com/market/dingtalk/error_code.php"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"picUrl"</span><span class="p">:</span><span class="s2">"@lALOACZwe2Rk"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"测试"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：link</td>
</tr>
</tbody></table>

<h5 id="link消息体格式">link消息体格式</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>link.messageUrl</td>
<td>String</td>
<td>是</td>
<td>消息点击链接地址</td>
</tr>
<tr>
<td>link.picUrl</td>
<td>String</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取</td>
</tr>
<tr>
<td>link.title</td>
<td>String</td>
<td>是</td>
<td>消息标题</td>
</tr>
<tr>
<td>link.text</td>
<td>String</td>
<td>是</td>
<td>消息描述</td>
</tr>
</tbody></table>

<h3 id="oa消息">OA消息</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
     </span><span class="nt">"msgtype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"oa"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"oa"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"message_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://dingtalk.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"head"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"bgcolor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FFBBBBBB"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"头部标题"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"正文标题"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"form"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"姓名:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"年龄:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"身高:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.8米"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"体重:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"130斤"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"学历:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"本科"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"爱好:"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"打球、听音乐"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nt">"rich"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"num"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15.6"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"元"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本大段文本"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@lADOADmaWMzazQKA"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"file_count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"李四 "</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>msgtype</td>
<td>String</td>
<td>是</td>
<td>消息类型，此时固定为：oa</td>
</tr>
</tbody></table>

<h4 id="oa消息体内容">OA消息体内容</h4>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>oa.message_url</td>
<td>String</td>
<td>是</td>
<td>客户端点击消息时跳转到的H5地址</td>
</tr>
<tr>
<td>oa.pc_message_url</td>
<td>String</td>
<td>否</td>
<td>PC端点击消息时跳转到的H5地址</td>
</tr>
<tr>
<td>oa.head</td>
<td>String</td>
<td>是</td>
<td>消息头部内容</td>
</tr>
<tr>
<td>oa.head.bgcolor</td>
<td>String</td>
<td>是</td>
<td>消息头部的背景颜色。长度限制为8个英文字符，其中前2为表示透明度，后6位表示颜色值。不要添加0x</td>
</tr>
<tr>
<td>oa.head.text</td>
<td>String</td>
<td>是</td>
<td>消息的头部标题</td>
</tr>
<tr>
<td>oa.body</td>
<td>Array[JSON Object]</td>
<td>是</td>
<td>消息体</td>
</tr>
<tr>
<td>oa.body.title</td>
<td>String</td>
<td>否</td>
<td>消息体的标题</td>
</tr>
<tr>
<td>oa.body.form</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>消息体的表单，最多显示6个，超过会被隐藏</td>
</tr>
<tr>
<td>oa.body.form.key</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字</td>
</tr>
<tr>
<td>oa.body.form.value</td>
<td>String</td>
<td>否</td>
<td>消息体的关键字对应的值</td>
</tr>
<tr>
<td>oa.body.rich</td>
<td>Array[JSON Object]</td>
<td>否</td>
<td>单行富文本信息</td>
</tr>
<tr>
<td>oa.body.rich.num</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的数目</td>
</tr>
<tr>
<td>oa.body.rich.unit</td>
<td>String</td>
<td>否</td>
<td>单行富文本信息的单位</td>
</tr>
<tr>
<td>oa.body.content</td>
<td>String</td>
<td>否</td>
<td>消息体的内容，最多显示3行</td>
</tr>
<tr>
<td>oa.body.image</td>
<td>String</td>
<td>否</td>
<td>消息体中的图片media_id</td>
</tr>
<tr>
<td>oa.body.file_count</td>
<td>String</td>
<td>否</td>
<td>自定义的附件数目。此数字仅供显示，钉钉不作验证</td>
</tr>
<tr>
<td>oa.body.author</td>
<td>String</td>
<td>否</td>
<td>自定义的作者名字</td>
</tr>
</tbody></table>

<h4 id="oa消息截图">OA消息截图</h4>

<p><img alt="oames" src="https://img.alicdn.com/tps/TB1gVcFIFXXXXcGXXXXXXXXXXXX.jpg" /></p>

<h2 id="管理多媒体文件">管理多媒体文件</h2>

<p>企业在使用接口时，对多媒体文件、多媒体消息的获取和调用等操作，是通过media_id来进行的。通过本接口，企业可以上传或下载多媒体文件。</p>

<h3 id="上传媒体文件">上传媒体文件</h3>

<p>用于上传图片、语音等媒体资源文件以及普通文件（如doc，ppt），接口返回媒体资源标识ID：media_id。请注意，media_id是可复用的，同一个media_id可用于消息的多次发送。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/media/upload?access_token=ACCESS_TOKEN&amp;type=TYPE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>是</td>
<td>媒体文件类型，分别有图片（image）、语音（voice）、普通文件(file)</td>
</tr>
<tr>
<td>media</td>
<td>String</td>
<td>是</td>
<td>form-data中媒体文件标识，有filename、filelength、content-type等信息</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"media_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@dsa8d87y7c8d8c"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>type</td>
<td>媒体文件类型，分别有图片（image）、语音（voice）、普通文件(file)</td>
</tr>
<tr>
<td>media_id</td>
<td>媒体文件上传后获取的唯一标识</td>
</tr>
<tr>
<td>created_at</td>
<td>媒体文件上传时间戳</td>
</tr>
</tbody></table>

<h6 id="上传的媒体文件限制">上传的媒体文件限制</h6>

<ul>
<li>图片（image）:1MB，支持JPG格式</li>
<li>语音（voice）：2MB，播放长度不超过60s，AMR格式</li>
<li>普通文件（file）：10MB</li>
</ul>

<h3 id="获取媒体文件">获取媒体文件</h3>

<p>通过media_id获取图片、语音等文件。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/media/get?access_token=ACCESS_TOKEN&amp;media_id=MEDIA_ID</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>media_id</td>
<td>String</td>
<td>是</td>
<td>媒体文件的唯一标示</td>
</tr>
</tbody></table>

<h6 id="返回说明">返回说明</h6>

<p>和普通的http下载相同，请根据http头做相应的处理。</p>
<pre class="highlight plaintext"><code>  HTTP/1.1 200: OK
  Connection: close
  Content-Type: image/jpeg
  Content-disposition: attachment; filename="MEDIA_ID.jpg"
  Date: Sun, 04 Jan 2015 12:00:00 GMT
  Cache-Control: no-cache, must-revalidate
  Content-Length: 1234567
  ...
</code></pre>

<p>a)正确时返回：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40004</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid media_id"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>b)错误时返回（这里省略了HTTP首部）：</p>

<h2 id="免登">免登</h2>

<p>免登接口是关于用户无需输入用户名＋密码就可以实现登录，通过权限认证后获取用户身份的接口。</p>

<p>详细信息请查看<a href="#免登服务"><font color=red >免登服务流程</font></a></p>

<h3 id="通过code换取用户身份">通过CODE换取用户身份</h3>

<p>企业应用的服务器在拿到CODE后，需要将CODE发送到钉钉开放平台接口，如果验证通过，则返回CODE对应的用户信息。<strong>此接口只用于免登服务中用来换取用户信息</strong></p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/user/getuserinfo?access_token=ACCESS_TOKEN&amp;code=CODE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>code</td>
<td>String</td>
<td>是</td>
<td>通过Oauth认证会给URL带上CODE</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>

<p>正确时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40029</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid code"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USERID"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deviceId"</span><span class="p">:</span><span class="s2">"DEVICEID"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_sys"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sys_level"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="err">|</span><span class="mi">1</span><span class="err">|</span><span class="mi">2</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>userid</td>
<td>员工在企业内的UserID</td>
</tr>
<tr>
<td>deviceId</td>
<td>手机设备号,由钉钉在安装时随机产生</td>
</tr>
<tr>
<td>is_sys</td>
<td>是否是管理员</td>
</tr>
<tr>
<td>sys_level</td>
<td>级别，三种取值。0:非管理员 1：普通管理员 2：超级管理员</td>
</tr>
</tbody></table>

<p>出错时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40029</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid code"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="通过code换取微应用管理员的身份信息">通过CODE换取微应用管理员的身份信息</h3>

<p>企业应用的服务器在拿到CODE后，需要将CODE发送到钉钉开放平台接口，如果验证通过，则返回CODE对应的管理员信息。<strong>此接口只用于微应用后台管理员免登中用来换取管理员信息</strong></p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/sso/getuserinfo?access_token=ACCESS_TOKEN&amp;code=CODE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>再次强调，此token不同于一般的accesstoken，需要调用<a href="#获取管理员免登token"><font color=red >获取微应用管理员免登需要的AccessToken</font></a></td>
</tr>
<tr>
<td>code</td>
<td>String</td>
<td>是</td>
<td>通过Oauth认证给URL带上的CODE</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>

<p>正确时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"corp_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"一家公司"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"corpid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dingxxxxxx"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_sys"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://xxxxxxx.jpg"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456@aliyun.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"名称"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"userid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0571"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corp_name</td>
<td>公司名字</td>
</tr>
<tr>
<td>corpid</td>
<td>公司corpid</td>
</tr>
<tr>
<td>is_sys</td>
<td>是否是管理员（在这里是true）</td>
</tr>
<tr>
<td>avatar</td>
<td>头像地址</td>
</tr>
<tr>
<td>email</td>
<td>email地址&rdquo;,</td>
</tr>
<tr>
<td>name</td>
<td>用户名字,</td>
</tr>
<tr>
<td>userid</td>
<td>员工在企业内的UserID</td>
</tr>
</tbody></table>

<p>出错时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40029</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid code"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="通过code换取普通钉钉用户的身份信息">通过CODE换取普通钉钉用户的身份信息</h3>

<p>第三方web服务提供商在拿到CODE后，需要将CODE发送到钉钉开放平台接口，如果验证通过，则返回CODE对应的钉钉用户信息。<strong>此接口只用于普通钉钉用户账号开放</strong></p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式: GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/sns/getuserinfo?access_token=ACCESS_TOKEN&amp;code=CODE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>需要由appId及appSecret换取</td>
</tr>
<tr>
<td>code</td>
<td>String</td>
<td>是</td>
<td>通过Oauth认证给回调URL带上的CODE</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>

<p>正确时返回示例如下,具体返回字段取决于用户最终授权：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"corp_info"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"is_auth"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
            </span><span class="nt">"is_sys"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> 
            </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"钉钉"</span><span class="w">
        </span><span class="p">},</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"is_auth"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
            </span><span class="nt">"is_sys"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> 
            </span><span class="nt">"corp_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"阿里巴巴"</span><span class="p">,</span><span class="w"> 
            </span><span class="nt">"rights_level"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> 
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> 
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w"> 
    </span><span class="nt">"user_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13012345678"</span><span class="p">,</span><span class="w"> 
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"张三"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corp_info</td>
<td>企业信息</td>
</tr>
<tr>
<td>is_auth</td>
<td>企业是否经过钉钉认证</td>
</tr>
<tr>
<td>is_sys</td>
<td>当前用户是否为该企业的管理员</td>
</tr>
<tr>
<td>rights_level</td>
<td>该企业的权益等级</td>
</tr>
<tr>
<td>corp_name</td>
<td>企业名称</td>
</tr>
<tr>
<td>mobile</td>
<td>手机号</td>
</tr>
<tr>
<td>name</td>
<td>用户姓名</td>
</tr>
</tbody></table>

<p>出错时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">40029</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid code"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<!-- ### 通过CODE换取用户身份

企业应用的服务器在拿到CODE后，需要将CODE发送到钉钉开放平台接口，如果验证通过，则返回CODE对应的用户信息。

###### 请求说明

Https请求方式: GET

`https://oapi.dingtalk.com/user/getuserinfo?access_token=ACCESS_TOKEN&code=CODE`

###### 参数说明

参数 | 参数类型 | 必须 | 说明
---------- | ------- | ------- | ------
access_token | String | 是 | 调用接口凭证
code | String | 是 | 通过Oauth认证会给URL带上CODE

###### 返回结果

正确时返回示例如下：

```
{
    "errcode": 40029,
    "errmsg": "invalid code",
    "userid": "USERID",
    "deviceId":"DEVICEID"
}
```

参数 | 说明
---------- | ------
userId | 员工在企业内的UserID
deviceId | 手机设备号,由钉钉在安装时随机产生

出错时返回示例如下：

```
{
    "errcode": 40029,
    "errmsg": "invalid code"
}
``` -->

<h2 id="统计数据">统计数据</h2>

<h3 id="记录统计数据">记录统计数据</h3>

<p>用户在使用微应用的时候，企业可以通过这个接口记录微应用使用的相关信息，比如调用时间，结束时间等等。钉钉的数据分析工具会对这些数据进行汇总。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式：POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/data/record?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>startTimeMs</td>
<td>String</td>
<td>是</td>
<td>事件发生时间，单位为距离1970的毫秒数</td>
</tr>
<tr>
<td>endTimeMs</td>
<td>String</td>
<td>是</td>
<td>事件结束时间（瞬间结束的，该值和发生事件一致）</td>
</tr>
<tr>
<td>module</td>
<td>String</td>
<td>否</td>
<td>微应用提供区分内部模块的标记</td>
</tr>
<tr>
<td>originId</td>
<td>String</td>
<td>否</td>
<td>微应用中该记录的主键索引</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工在企业内的UserID，企业用来唯一标识用户的字段</td>
</tr>
<tr>
<td>agentId</td>
<td>String</td>
<td>是</td>
<td>授权方应用id</td>
</tr>
<tr>
<td>callbackUrl</td>
<td>String</td>
<td>是</td>
<td>针对该条数据的回调url</td>
</tr>
<tr>
<td>extension</td>
<td>JSONObject</td>
<td>否</td>
<td>扩展字段，json格式,具体的业务数据模型的定义，请参考附录二，现只开放考勤类业务数据模型</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"$:LWCP_v1:$t3G6JuXLNr7pd0fWOQKS2w=="</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>数据标识id</td>
</tr>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h3 id="更新统计数据">更新统计数据</h3>

<p>isv企业可以通过这个接口更新微应用数据，所更新的数据必须是通过/data/record接口插入的，现在只能更新module，callbackUrl，extension三个字段。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式：POST</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/data/update?access_token=ACCESS_TOKEN</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>是</td>
<td>使用/data/record接口插入数据时返回的id</td>
</tr>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>startTimeMs</td>
<td>String</td>
<td>是</td>
<td>事件发生时间，单位为距离1970的毫秒数</td>
</tr>
<tr>
<td>endTimeMs</td>
<td>String</td>
<td>是</td>
<td>事件结束时间（瞬间结束的，该值和发生事件一致）</td>
</tr>
<tr>
<td>module</td>
<td>String</td>
<td>否</td>
<td>微应用提供区分内部模块的标记</td>
</tr>
<tr>
<td>originId</td>
<td>String</td>
<td>否</td>
<td>微应用中该记录的主键索引</td>
</tr>
<tr>
<td>userid</td>
<td>String</td>
<td>是</td>
<td>员工在企业内的UserID，企业用来唯一标识用户的字段</td>
</tr>
<tr>
<td>agentId</td>
<td>String</td>
<td>是</td>
<td>授权方应用id</td>
</tr>
<tr>
<td>callbackUrl</td>
<td>String</td>
<td>是</td>
<td>针对该条数据的回调url</td>
</tr>
<tr>
<td>extension</td>
<td>JSONObject</td>
<td>否</td>
<td>扩展字段，json格式,具体的业务数据模型的定义，请参考附录二，现只开放考勤类业务数据模型</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>返回码</td>
</tr>
<tr>
<td>errmsg</td>
<td>对返回码的文本描述内容</td>
</tr>
</tbody></table>

<h2 id="js接口api">JS接口API</h2>

<h3 id="获取jsapi_ticket">获取jsapi_ticket</h3>

<p>企业在使用微应用中的JS API时，需要先从钉钉开放平台接口获取jsapi_ticket生成签名数据，并将最终签名用的部分字段及签名结果返回到H5中，JS API底层将通过这些数据判断H5是否有权限使用JS API。</p>

<h6 id="请求说明">请求说明</h6>

<p>Https请求方式：GET</p>

<p><code class="prettyprint">https://oapi.dingtalk.com/get_jsapi_ticket?access_token=ACCESS_TOKE</code></p>

<h6 id="参数说明">参数说明</h6>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>String</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>是</td>
<td>这里是固定值，jsapi</td>
</tr>
</tbody></table>

<h6 id="返回结果">返回结果</h6>

<p>正确时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ticket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dsf8sdf87sd7f87sd8v8ds0vs09dvu09sd8vy87dsv87"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">7200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>errcode</td>
<td>错误码</td>
</tr>
<tr>
<td>errmsg</td>
<td>错误信息</td>
</tr>
<tr>
<td>ticket</td>
<td>用于JS API的临时票据</td>
</tr>
<tr>
<td>expires_in</td>
<td>票据过期时间</td>
</tr>
</tbody></table>

<p>出错时返回示例如下：</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"errcode"</span><span class="p">:</span><span class="w"> </span><span class="mi">45009</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errmsg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"接口调用超过限制"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="js-sdk">JS-SDK</h3>

<p>JS-SDK 为H5页面提供了一系列原生UI控件或者服务的JS接口，文档地址如下：</p>

<p><a href="#客户端开发文档"><font color=red >客户端开发文档</font></a></p>

<h2 id="管理日历接入指南">管理日历接入指南</h2>

<p>钉钉提供微应用接入管理日历的能力。目前处于测试阶段，为了保证接入的质量以及良好的用户体验，接入方需要与钉钉管理日历团队协商接入方案。</p>

<p>由于不同接入方的业务不完全一致，如果接入方希望以与本文档不同的形式接入，可以向我们提出合作邀请，我们也提供定制化接入支持。（联系邮箱：pstar.zhangp@alibaba-inc.com）</p>

<p>管理日历目前已接入多个微应用，例如：签到、审批、考勤、日志、拜访计划等。</p>

<p>具体接入文档查看：<a href="http://download.taobaocdn.com/freedom/31112/pdf/p1a6htv7hq1o3p63g9ahpq51n5q4.pdf">管理日历接入指南</a></p>

<h2 id="附录">附录</h2>

<h3 id="附录一-全局返回码说明">附录一 全局返回码说明</h3>

<p>开发者每次调用接口时，可能获得正确或错误的返回码，企业可以根据返回码信息调试接口，排查错误。</p>

<h6 id="全局返回码说明如下：">全局返回码说明如下：</h6>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>-1</td>
<td>系统繁忙</td>
</tr>
<tr>
<td>0</td>
<td>请求成功</td>
</tr>
<tr>
<td>40001</td>
<td>获取access_token时Secret错误，或者access_token无效</td>
</tr>
<tr>
<td>40002</td>
<td>不合法的凭证类型</td>
</tr>
<tr>
<td>40003</td>
<td>不合法的UserID</td>
</tr>
<tr>
<td>40004</td>
<td>不合法的媒体文件类型</td>
</tr>
<tr>
<td>40005</td>
<td>不合法的文件类型</td>
</tr>
<tr>
<td>40006</td>
<td>不合法的文件大小</td>
</tr>
<tr>
<td>40007</td>
<td>不合法的媒体文件id</td>
</tr>
<tr>
<td>40008</td>
<td>不合法的消息类型</td>
</tr>
<tr>
<td>40009</td>
<td>不合法的部门id</td>
</tr>
<tr>
<td>40010</td>
<td>不合法的父部门id</td>
</tr>
<tr>
<td>40011</td>
<td>不合法的排序order</td>
</tr>
<tr>
<td>40012</td>
<td>不合法的发送者</td>
</tr>
<tr>
<td>40013</td>
<td>不合法的corpid</td>
</tr>
<tr>
<td>40014</td>
<td>不合法的access_token</td>
</tr>
<tr>
<td>40015</td>
<td>发送者不在会话中</td>
</tr>
<tr>
<td>40016</td>
<td>不合法的会话ID</td>
</tr>
<tr>
<td>40017</td>
<td>在会话中没有找到与发送者在同一企业的人</td>
</tr>
<tr>
<td>40018</td>
<td>不允许以递归方式查询部门用户列表</td>
</tr>
<tr>
<td>40019</td>
<td>该手机号码对应的用户最多可以加入5个非认证企业</td>
</tr>
<tr>
<td>40020</td>
<td>当前团队人数已经达到上限,用电脑登录钉钉企业管理后台，升级成为认证企业</td>
</tr>
<tr>
<td>40021</td>
<td>更换的号码已注册过钉钉，无法使用该号码</td>
</tr>
<tr>
<td>40022</td>
<td>企业中的手机号码和登陆钉钉的手机号码不一致,暂时不支持修改用户信息,可以删除后重新添加</td>
</tr>
<tr>
<td>60107</td>
<td>使用该手机登录钉钉的用户已经在企业中</td>
</tr>
<tr>
<td>40029</td>
<td>不合法的oauth_code</td>
</tr>
<tr>
<td>40031</td>
<td>不合法的UserID列表</td>
</tr>
<tr>
<td>40032</td>
<td>不合法的UserID列表长度</td>
</tr>
<tr>
<td>40033</td>
<td>不合法的请求字符，不能包含\uxxxx格式的字符</td>
</tr>
<tr>
<td>40035</td>
<td>不合法的参数</td>
</tr>
<tr>
<td>40038</td>
<td>不合法的请求格式</td>
</tr>
<tr>
<td>40039</td>
<td>不合法的URL长度</td>
</tr>
<tr>
<td>40048</td>
<td>url中包含不合法domain</td>
</tr>
<tr>
<td>40055</td>
<td>不合法的agent结构</td>
</tr>
<tr>
<td>40056</td>
<td>不合法的agentid</td>
</tr>
<tr>
<td>40057</td>
<td>不合法的callbackurl</td>
</tr>
<tr>
<td>40061</td>
<td>设置应用头像失败</td>
</tr>
<tr>
<td>40062</td>
<td>不合法的应用模式</td>
</tr>
<tr>
<td>40063</td>
<td>不合法的分机号</td>
</tr>
<tr>
<td>40064</td>
<td>不合法的工作地址</td>
</tr>
<tr>
<td>40065</td>
<td>不合法的备注</td>
</tr>
<tr>
<td>40066</td>
<td>不合法的部门列表</td>
</tr>
<tr>
<td>40067</td>
<td>标题长度不合法</td>
</tr>
<tr>
<td>40073</td>
<td>不存在的openid</td>
</tr>
<tr>
<td>40077</td>
<td>不存在的预授权码</td>
</tr>
<tr>
<td>40078</td>
<td>不存在的临时授权码</td>
</tr>
<tr>
<td>40079</td>
<td>不存在的授权信息</td>
</tr>
<tr>
<td>40080</td>
<td>不合法的suitesecret</td>
</tr>
<tr>
<td>40082</td>
<td>不合法的suitetoken</td>
</tr>
<tr>
<td>40083</td>
<td>不合法的suitekey</td>
</tr>
<tr>
<td>40084</td>
<td>不合法的永久授权码</td>
</tr>
<tr>
<td>40085</td>
<td>不存在的suiteticket</td>
</tr>
<tr>
<td>40086</td>
<td>不合法的第三方应用appid</td>
</tr>
<tr>
<td>40087</td>
<td>创建永久授权码失败</td>
</tr>
<tr>
<td>40088</td>
<td>不合法的套件key或secret</td>
</tr>
<tr>
<td>40089</td>
<td>不合法的corpid或corpsecret</td>
</tr>
<tr>
<td>40090</td>
<td>套件已经不存在</td>
</tr>
<tr>
<td>41001</td>
<td>缺少access_token参数</td>
</tr>
<tr>
<td>41002</td>
<td>缺少corpid参数</td>
</tr>
<tr>
<td>41003</td>
<td>缺少refresh_token参数</td>
</tr>
<tr>
<td>41004</td>
<td>缺少secret参数</td>
</tr>
<tr>
<td>41005</td>
<td>缺少多媒体文件数据</td>
</tr>
<tr>
<td>41006</td>
<td>缺少media_id参数</td>
</tr>
<tr>
<td>41007</td>
<td>无效的ssocode</td>
</tr>
<tr>
<td>41008</td>
<td>缺少oauth</td>
</tr>
<tr>
<td>41009</td>
<td>缺少UserID</td>
</tr>
<tr>
<td>41010</td>
<td>缺少url</td>
</tr>
<tr>
<td>41011</td>
<td>缺少agentid</td>
</tr>
<tr>
<td>41012</td>
<td>缺少应用头像mediaid</td>
</tr>
<tr>
<td>41013</td>
<td>缺少应用名字</td>
</tr>
<tr>
<td>41014</td>
<td>缺少应用描述</td>
</tr>
<tr>
<td>41015</td>
<td>缺少Content</td>
</tr>
<tr>
<td>41016</td>
<td>缺少标题</td>
</tr>
<tr>
<td>41021</td>
<td>缺少suitekey</td>
</tr>
<tr>
<td>41022</td>
<td>缺少suitetoken</td>
</tr>
<tr>
<td>41023</td>
<td>缺少suiteticket</td>
</tr>
<tr>
<td>41024</td>
<td>缺少suitesecret</td>
</tr>
<tr>
<td>41025</td>
<td>缺少permanent_code（永久授权码）</td>
</tr>
<tr>
<td>41026</td>
<td>缺少tmp_auth_code（临时授权码）</td>
</tr>
<tr>
<td>41027</td>
<td>需要授权企业的corpid参数</td>
</tr>
<tr>
<td>41030</td>
<td>企业未对该套件授权</td>
</tr>
<tr>
<td>41031</td>
<td>auth_corpid和permanent_code不匹配</td>
</tr>
<tr>
<td>41100</td>
<td>时间参数不合法</td>
</tr>
<tr>
<td>41101</td>
<td>数据内容过长</td>
</tr>
<tr>
<td>41102</td>
<td>参数值过大</td>
</tr>
<tr>
<td>42001</td>
<td>access_token超时</td>
</tr>
<tr>
<td>42002</td>
<td>refresh_token超时</td>
</tr>
<tr>
<td>42003</td>
<td>oauth_code超时</td>
</tr>
<tr>
<td>42007</td>
<td>预授权码失效</td>
</tr>
<tr>
<td>42008</td>
<td>临时授权码失效</td>
</tr>
<tr>
<td>42009</td>
<td>suitetoken失效</td>
</tr>
<tr>
<td>43001</td>
<td>需要GET请求</td>
</tr>
<tr>
<td>43002</td>
<td>需要POST请求</td>
</tr>
<tr>
<td>43003</td>
<td>需要HTTPS</td>
</tr>
<tr>
<td>43004</td>
<td>无效的HTTP HEADER Content-Type</td>
</tr>
<tr>
<td>43005</td>
<td>需要Content-Type为application/json;charset=UTF-8</td>
</tr>
<tr>
<td>43007</td>
<td>需要授权</td>
</tr>
<tr>
<td>43008</td>
<td>参数需要multipart类型</td>
</tr>
<tr>
<td>43009</td>
<td>post参数需要json类型</td>
</tr>
<tr>
<td>43010</td>
<td>需要处于回调模式</td>
</tr>
<tr>
<td>43011</td>
<td>需要企业授权</td>
</tr>
<tr>
<td>44001</td>
<td>多媒体文件为空</td>
</tr>
<tr>
<td>44002</td>
<td>POST的数据包为空</td>
</tr>
<tr>
<td>44003</td>
<td>图文消息内容为空</td>
</tr>
<tr>
<td>44004</td>
<td>文本消息内容为空</td>
</tr>
<tr>
<td>45001</td>
<td>多媒体文件大小超过限制</td>
</tr>
<tr>
<td>45002</td>
<td>消息内容超过限制</td>
</tr>
<tr>
<td>45003</td>
<td>标题字段超过限制</td>
</tr>
<tr>
<td>45004</td>
<td>描述字段超过限制</td>
</tr>
<tr>
<td>45005</td>
<td>链接字段超过限制</td>
</tr>
<tr>
<td>45006</td>
<td>图片链接字段超过限制</td>
</tr>
<tr>
<td>45007</td>
<td>语音播放时间超过限制</td>
</tr>
<tr>
<td>45008</td>
<td>图文消息超过限制</td>
</tr>
<tr>
<td>45009</td>
<td>接口调用超过限制</td>
</tr>
<tr>
<td>45016</td>
<td>系统分组，不允许修改</td>
</tr>
<tr>
<td>45017</td>
<td>分组名字过长</td>
</tr>
<tr>
<td>45018</td>
<td>分组数量超过上限</td>
</tr>
<tr>
<td>45024</td>
<td>账号数量超过上限</td>
</tr>
<tr>
<td>46001</td>
<td>不存在媒体数据</td>
</tr>
<tr>
<td>46004</td>
<td>不存在的员工</td>
</tr>
<tr>
<td>47001</td>
<td>解析JSON/XML内容错误</td>
</tr>
<tr>
<td>48002</td>
<td>Api禁用</td>
</tr>
<tr>
<td>48003</td>
<td>suitetoken无效</td>
</tr>
<tr>
<td>48004</td>
<td>授权关系无效</td>
</tr>
<tr>
<td>49000</td>
<td>缺少chatid</td>
</tr>
<tr>
<td>49001</td>
<td>绑定的微应用超过个数限制</td>
</tr>
<tr>
<td>49002</td>
<td>一个群只能被一个ISV套件绑定一次</td>
</tr>
<tr>
<td>49003</td>
<td>操作者必须为群主</td>
</tr>
<tr>
<td>49004</td>
<td>添加成员列表和删除成员列表不能有交集</td>
</tr>
<tr>
<td>49005</td>
<td>群人数超过人数限制</td>
</tr>
<tr>
<td>49006</td>
<td>群成员列表必须包含群主</td>
</tr>
<tr>
<td>50001</td>
<td>redirect_uri未授权</td>
</tr>
<tr>
<td>50002</td>
<td>员工不在权限范围</td>
</tr>
<tr>
<td>50003</td>
<td>应用已停用</td>
</tr>
<tr>
<td>50005</td>
<td>企业已禁用</td>
</tr>
<tr>
<td>51000</td>
<td>跳转的域名未授权</td>
</tr>
<tr>
<td>51001</td>
<td>跳转的corpid未授权</td>
</tr>
<tr>
<td>51002</td>
<td>跳转请求不是来自钉钉客户端</td>
</tr>
<tr>
<td>51003</td>
<td>跳转找不到用户信息</td>
</tr>
<tr>
<td>51004</td>
<td>跳转找不到用户的企业信息</td>
</tr>
<tr>
<td>51005</td>
<td>跳转用户不是企业管理员</td>
</tr>
<tr>
<td>51006</td>
<td>跳转生成code失败</td>
</tr>
<tr>
<td>51007</td>
<td>跳转获取用户企业身份失败</td>
</tr>
<tr>
<td>51008</td>
<td>跳转url解码失败</td>
</tr>
<tr>
<td>51009</td>
<td>要跳转的地址不是标准url</td>
</tr>
<tr>
<td>52010</td>
<td>无效的corpid</td>
</tr>
<tr>
<td>52011</td>
<td>jsapi ticket 读取失败</td>
</tr>
<tr>
<td>52012</td>
<td>jsapi 签名生成失败</td>
</tr>
<tr>
<td>52013</td>
<td>签名校验失败</td>
</tr>
<tr>
<td>52014</td>
<td>无效的url参数</td>
</tr>
<tr>
<td>52015</td>
<td>无效的随机字符串参数</td>
</tr>
<tr>
<td>52016</td>
<td>无效的签名参数</td>
</tr>
<tr>
<td>52017</td>
<td>无效的jsapi列表参数</td>
</tr>
<tr>
<td>52018</td>
<td>无效的时间戳</td>
</tr>
<tr>
<td>52019</td>
<td>无效的agentid</td>
</tr>
<tr>
<td>60001</td>
<td>不合法的部门名称</td>
</tr>
<tr>
<td>60002</td>
<td>部门层级深度超过限制</td>
</tr>
<tr>
<td>60003</td>
<td>部门不存在</td>
</tr>
<tr>
<td>60004</td>
<td>父亲部门不存在</td>
</tr>
<tr>
<td>60005</td>
<td>不允许删除有成员的部门</td>
</tr>
<tr>
<td>60006</td>
<td>不允许删除有子部门的部门</td>
</tr>
<tr>
<td>60007</td>
<td>不允许删除根部门</td>
</tr>
<tr>
<td>60008</td>
<td>父部门下该部门名称已存在</td>
</tr>
<tr>
<td>60009</td>
<td>部门名称含有非法字符</td>
</tr>
<tr>
<td>60010</td>
<td>部门存在循环关系</td>
</tr>
<tr>
<td>60011</td>
<td>管理员权限不足，（user/department/agent）无权限</td>
</tr>
<tr>
<td>60012</td>
<td>不允许删除默认应用</td>
</tr>
<tr>
<td>60013</td>
<td>不允许关闭应用</td>
</tr>
<tr>
<td>60014</td>
<td>不允许开启应用</td>
</tr>
<tr>
<td>60015</td>
<td>不允许修改默认应用可见范围</td>
</tr>
<tr>
<td>60016</td>
<td>部门id已经存在</td>
</tr>
<tr>
<td>60017</td>
<td>不允许设置企业</td>
</tr>
<tr>
<td>60018</td>
<td>不允许更新根部门</td>
</tr>
<tr>
<td>60019</td>
<td>从部门查询人员失败</td>
</tr>
<tr>
<td>60020</td>
<td>访问ip不在白名单之中</td>
</tr>
<tr>
<td>60102</td>
<td>UserID在公司中已存在</td>
</tr>
<tr>
<td>60103</td>
<td>手机号码不合法</td>
</tr>
<tr>
<td>60104</td>
<td>手机号码在公司中已存在</td>
</tr>
<tr>
<td>60105</td>
<td>邮箱不合法</td>
</tr>
<tr>
<td>60106</td>
<td>邮箱已存在</td>
</tr>
<tr>
<td>60110</td>
<td>部门个数超出限制</td>
</tr>
<tr>
<td>60111</td>
<td>UserID不存在</td>
</tr>
<tr>
<td>60112</td>
<td>用户name不合法</td>
</tr>
<tr>
<td>60113</td>
<td>身份认证信息（手机/邮箱）不能同时为空</td>
</tr>
<tr>
<td>60114</td>
<td>性别不合法</td>
</tr>
<tr>
<td>60118</td>
<td>用户无有效邀请字段（邮箱，手机号）</td>
</tr>
<tr>
<td>60119</td>
<td>不合法的position</td>
</tr>
<tr>
<td>60120</td>
<td>用户已禁用</td>
</tr>
<tr>
<td>60121</td>
<td>找不到该用户</td>
</tr>
<tr>
<td>60122</td>
<td>不合法的extattr</td>
</tr>
<tr>
<td>60123</td>
<td>不合法的jobnumber</td>
</tr>
<tr>
<td>70001</td>
<td>企业不存在或者已经被解散</td>
</tr>
<tr>
<td>70002</td>
<td>获取套件下的微应用失败</td>
</tr>
<tr>
<td>70003</td>
<td>agentid对应微应用不存在</td>
</tr>
<tr>
<td>70004</td>
<td>企业下没有对应该agentid的微应用</td>
</tr>
<tr>
<td>70005</td>
<td>ISV激活套件失败</td>
</tr>
<tr>
<td>71006</td>
<td>回调地址已经存在</td>
</tr>
<tr>
<td>71007</td>
<td>回调地址已不存在</td>
</tr>
<tr>
<td>71008</td>
<td>回调call_back_tag必须在指定的call_back_tag列表中</td>
</tr>
<tr>
<td>71009</td>
<td>返回文本非success</td>
</tr>
<tr>
<td>71010</td>
<td>POST的JSON数据不包含所需要的参数字段或包含的参数格式非法</td>
</tr>
<tr>
<td>71011</td>
<td>传入的url参数不是合法的url格式</td>
</tr>
<tr>
<td>71012</td>
<td>url地址访问异常,错误原因为:%s</td>
</tr>
<tr>
<td>71013</td>
<td>此域名或IP不能注册或者接收回调事件</td>
</tr>
<tr>
<td>80001</td>
<td>可信域名没有IPC备案，后续将不能在该域名下正常使用jssdk</td>
</tr>
<tr>
<td>90001</td>
<td>您的服务器调用钉钉开放平台所有接口的请求都被暂时禁用了</td>
</tr>
<tr>
<td>90002</td>
<td>您的服务器调用钉钉开放平台当前接口的所有请求都被暂时禁用了</td>
</tr>
<tr>
<td>90003</td>
<td>您的企业调用钉钉开放平台所有接口的请求都被暂时禁用了,仅对企业自己的Accesstoken有效</td>
</tr>
<tr>
<td>90004</td>
<td>您当前使用的CorpId及CorpSecret被暂时禁用了,仅对企业自己的Accesstoken有效</td>
</tr>
<tr>
<td>90005</td>
<td>您的企业调用当前接口次数过多,请求被暂时禁用了,仅对企业自己的Accesstoken有效</td>
</tr>
<tr>
<td>90006</td>
<td>您当前使用的CorpId及CorpSecret调用当前接口次数过多,请求被暂时禁用了,仅对企业自己的Accesstoken有效</td>
</tr>
<tr>
<td>90007</td>
<td>您当前要调用的企业的接口次数过多,对该企业的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90008</td>
<td>您当前要调用的企业的当前接口次数过多,对此企业下该接口的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90009</td>
<td>您调用企业接口超过了限制,对所有企业的所有接口的请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90010</td>
<td>您调用企业当前接口超过了限制,对所有企业的该接口的请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90011</td>
<td>您的套件调用企业接口超过了限制,该套件的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90012</td>
<td>您的套件调用企业当前接口超过了限制,该套件对此接口的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90013</td>
<td>您的套件调用当前企业的接口超过了限制,该套件对此企业的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>90014</td>
<td>您的套件调用企业当前接口超过了限制,该套件对此企业该接口的所有请求都被暂时禁用了,仅对企业授权给ISV的Accesstoken有效</td>
</tr>
<tr>
<td>900001</td>
<td>加密明文文本非法</td>
</tr>
<tr>
<td>900002</td>
<td>加密时间戳参数非法</td>
</tr>
<tr>
<td>900003</td>
<td>加密随机字符串参数非法</td>
</tr>
<tr>
<td>900004</td>
<td>不合法的aeskey</td>
</tr>
<tr>
<td>900005</td>
<td>签名不匹配</td>
</tr>
<tr>
<td>900006</td>
<td>计算签名错误</td>
</tr>
<tr>
<td>900007</td>
<td>计算加密文字错误</td>
</tr>
<tr>
<td>900008</td>
<td>计算解密文字错误</td>
</tr>
<tr>
<td>900009</td>
<td>计算解密文字长度不匹配</td>
</tr>
<tr>
<td>900010</td>
<td>计算解密文字suitekey或者corpid不匹配</td>
</tr>
</tbody></table>

<h3 id="附录二-微应用数据中心业务模型定义">附录二  微应用数据中心业务模型定义</h3>

<h6 id="考勤业务数据模型">考勤业务数据模型</h6>
<pre class="highlight json"><code><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"attendance"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"类别，10-正常打卡，11-异常打卡，12-旷工，13-未设置考勤规则，14-范围外打卡，15-未到岗"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"stdWorkingTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"标准工作时长，格式为数字，单位毫秒"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"actualWorkingTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"实际工作时长，格式为数字，单位毫秒"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"originUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"业务数据跳转url"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"reportLocations"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"上报位置标识"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"上报标识"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"上报时间，时间戳，格式为数字，单位毫秒"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">

    </span><span class="nt">"items"</span><span class="p">:[</span><span class="w">
        </span><span class="s2">"originId"</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="s2">"业务数据标识"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"originUrl"</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="s2">"业务数据跳转url"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="err">:</span><span class="w"> </span><span class="s2">"考勤状态，20-正常，21-迟到，22-早退，23-未打卡，24-缺卡"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"outOfScope"</span><span class="err">:</span><span class="w"> </span><span class="s2">"是否范围外，0-否，1-是"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"classId"</span><span class="err">:</span><span class="w"> </span><span class="s2">"班次标识"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"className"</span><span class="err">:</span><span class="w"> </span><span class="s2">"班次名称"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"periodId"</span><span class="err">:</span><span class="w"> </span><span class="s2">"时段标识"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"periodName"</span><span class="err">:</span><span class="w"> </span><span class="s2">"时段名称"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"periodStartTime"</span><span class="err">:</span><span class="w"> </span><span class="s2">"考勤时间段开始时间，时间戳，格式为数字，单位毫秒"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"periodEndTime"</span><span class="err">:</span><span class="w"> </span><span class="s2">"考勤时间段结束时间，时间戳，格式为数字，单位毫秒"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"checkStartTime"</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="s2">"有效打卡开始时间，时间戳，格式为数字，单位毫秒"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"checkEndTime"</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="s2">"有效打卡结束时间，时间戳，格式为数字，单位毫秒"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"checkTime"</span><span class="err">:</span><span class="w"> </span><span class="s2">"设置的标准打卡时间，时间戳，格式为数字，单位毫秒"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"signTime"</span><span class="err">:</span><span class="w"> </span><span class="s2">"实际考勤打卡时间，时间戳，格式为数字，单位毫秒"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"signPlace"</span><span class="err">:</span><span class="w"> </span><span class="s2">"实际考勤地点"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"signOffset"</span><span class="err">:</span><span class="w"> </span><span class="s2">"实际偏移距离，单位米"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"signWifi"</span><span class="err">:</span><span class="w"> </span><span class="s2">"实际的考勤wifi"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"signWifiMAC"</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="s2">"实际的考勤wifiMAC"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"checkPlace"</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="s2">"设置的考勤地点"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"checkOffset"</span><span class="err">:</span><span class="w"> </span><span class="s2">"设置的偏移距离，单位米"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"checkWifi"</span><span class="w"> </span><span class="err">:</span><span class="s2">"设置的考勤wifi"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"checkWifiMAC"</span><span class="w"> </span><span class="err">:</span><span class="s2">"设置的考勤wifiMAC"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"duty"</span><span class="err">:</span><span class="w"> </span><span class="s2">"上下班,0-上班，1-下班"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"absentTime"</span><span class="err">:</span><span class="w"> </span><span class="s2">"迟到或早退的时长，格式为数字，单位毫秒"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"supplement"</span><span class="err">:</span><span class="w"> </span><span class="s2">"是否已补签，0-否，1-是"</span><span class="w">
    </span><span class="p">]</span><span class="w">   

</span><span class="p">}</span><span class="w">

</span></code></pre>

<h2 id="demo">Demo</h2>

<p>提供了使用Java、PHP、Nodejs 接入钉钉开放平台API的代码示例，和在线调试工具</p>

<p>下面的代码示例展示了一些常用API的使用方式，在运行下面的示例前请先获取CorpID和CorpSecret，并按照示例下的说明配置到合适的位置。</p>

<h3 id="调试工具">调试工具</h3>

<p><a href="https://debug.dingtalk.com"><font color=red >钉钉服务端API调试工具</font></a></p>

<h3 id="java版本">Java版本</h3>
<pre class="highlight javascript"><code> <span class="kr">public</span> <span class="kr">class</span> <span class="nx">Env</span> <span class="p">{</span>
  <span class="kr">public</span> <span class="kr">static</span> <span class="kr">final</span> <span class="nb">String</span> <span class="nx">OAPI_HOST</span> <span class="o">=</span> <span class="s2">"https://oapi.dingtalk.com"</span><span class="p">;</span>
    <span class="kr">public</span> <span class="kr">static</span> <span class="kr">final</span> <span class="nb">String</span> <span class="nx">CORP_ID</span> <span class="o">=</span> <span class="s2">"corpid"</span><span class="p">;</span>
    <span class="kr">public</span> <span class="kr">static</span> <span class="kr">final</span> <span class="nb">String</span> <span class="nx">SECRET</span> <span class="o">=</span> <span class="s2">"secret"</span><span class="p">;</span>
 <span class="p">}</span>

</code></pre>

<p>1.将您的CorpID和CorpSecret配置在Env.java文件</p>

<p>2.启动您的服务器，如果配置正确，则会成功启动。</p>

<p><a href="https://github.com/injekt/openapi-demo-java"><font color=red >Demo地址：</font></a>
<a href="https://github.com/injekt/openapi-demo-java"><font color=red >https://github.com/injekt/openapi-demo-java</font></a></p>

<h3 id="php版本">PHP版本</h3>
<pre class="highlight javascript"><code> <span class="nx">define</span><span class="p">(</span><span class="s2">"OAPI_HOST"</span><span class="p">,</span> <span class="s2">"https://oapi.dingtalk.com"</span><span class="p">);</span>
 <span class="nx">define</span><span class="p">(</span><span class="s2">"CORPID"</span><span class="p">,</span> <span class="s2">""</span><span class="p">);</span>
 <span class="nx">define</span><span class="p">(</span><span class="s2">"SECRET"</span><span class="p">,</span> <span class="s2">""</span><span class="p">);</span>
</code></pre>

<p>1.将您的CorpID和CorpSecret配置在env.php文件</p>

<p>2.启动您的服务器，如果配置正确，则会成功启动。</p>

<p><a href="https://github.com/injekt/openapi-demo-php"><font color=red >Demo地址：</font></a>
<a href="https://github.com/injekt/openapi-demo-php"><font color=red >https://github.com/injekt/openapi-demo-php</font></a></p>

<h3 id="node-js版本">Node.js版本</h3>
<pre class="highlight javascript"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">secret</span><span class="p">:</span> <span class="s1">''</span>
<span class="p">};</span>
</code></pre>

<p>1.将您的CorpID和CorpSecret配置在env.js文件</p>

<p>2.启动您的服务器，如果配置正确，则会成功启动。</p>

<p><a href="https://github.com/injekt/openapi-demo-nodejs"><font color=red >Demo地址：</font></a>
<a href="https://github.com/injekt/openapi-demo-nodejs"><font color=red >https://github.com/injekt/openapi-demo-nodejs</font></a></p>

          <h1 id="客户端开发文档">客户端开发文档</h1>

<p>微应用是 钉钉 为连接企业办公打造的移动入口，通过微应用你可以将企业的业务审批，内部系统，生成，协作，管理，上下游沟通连接到钉钉，更简单和低成本实现企业移动化； 结合钉钉的基础通信能力，让企业应用更活跃，员工更高效，移动化成本更低。</p>

<p>而客户端开发文档将为微应用提供调用原生控件的能力，带给微应用接近原生代码的体验。</p>

<h2 id="demo和调试工具">Demo和调试工具</h2>

<p>我们提供了Demo和调试工具给您的开发提供方便，如果对调用参数有疑问，请使用调试工具。对jsapi用法有疑问，可查看Demo.</p>

<p><a href="http://wsdebug.dingtalk.com/"><font color=red >调试工具</font></a>:<a href="http://wsdebug.dingtalk.com">http://wsdebug.dingtalk.com</a>
打开左边的超链接后，手机扫描二维码，然后在PC页面上配置jsapi参数，点击执行手机就会给予相应反馈</p>

<p><a href="http://h5.m.laiwang.com/home/ding.html"><font color=red >jsapi使用样例地址</font></a>:<a href="http://h5.m.laiwang.com/home/ding.html">http://h5.m.laiwang.com/home/ding.html</a></p>

<p><a href="https://github.com/outlookxie/app-todolist"><font color=red >微应用Demo地址</font></a>:<a href="https://github.com/outlookxie/app-todolist">https://github.com/outlookxie/app-todolist</a></p>

<h2 id="通用">通用</h2>

<h3 id="页面引入js文件">页面引入js文件</h3>

<p>js文件版本在添加升级功能时地址会变化，如有需要（比如要使用新增的js-api）,请随时关注地址变更。但是旧版本js文件也将一直可用。</p>

<p><code class="prettyprint">http://g.alicdn.com/ilw/ding/0.6.6/scripts/dingtalk.js</code></p>

<p>或者</p>

<p><code class="prettyprint">https://g.alicdn.com/ilw/ding/0.6.6/scripts/dingtalk.js</code></p>

<h3 id="全局变量、命名空间">全局变量、命名空间</h3>

<p>直接引入dingtalk.js会得到一个全局变量<code class="prettyprint">dd</code>，支持amd、cmd引入方式</p>

<p>全局变量dd，命名空间：设备(dd.device)、业务(dd.biz)</p>

<h3 id="权限验证配置-beta">权限验证配置(beta)</h3>

<p>钉钉JS API安全验证，只有经过安全验证的微应用才能调用安全级别较高的API。</p>

<p>获取JS-API权限验证使用的签名的方法请参考附录-<a href="#js-api权限签名算法"><font color=red >JS-API权限签名算法</font></a></p>

<p><a href="https://github.com/injekt/jsapi-demo"><font color=red >jsapi权限验证配置demo&ndash;node.js版本</font></a></p>

<p><a href="https://github.com/injekt/openapi-demo-java"><font color=red >jsapi权限验证配置demo&ndash;java版本</font></a></p>

<p><a href="https://github.com/injekt/openapi-demo-php"><font color=red >jsapi权限验证配置demo&ndash;php版本</font></a></p>
<pre class="highlight javascript"><code> <span class="nx">dd</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">agentId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，微应用ID</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span><span class="c1">//必填，企业ID</span>
    <span class="na">timeStamp</span><span class="p">:</span> <span class="p">,</span> <span class="c1">// 必填，生成签名的时间戳</span>
    <span class="na">nonceStr</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，生成签名的随机串</span>
    <span class="na">signature</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，签名</span>
    <span class="na">jsApiList</span><span class="p">:</span> <span class="p">[</span><span class="s1">'device.notification.alert'</span><span class="p">,</span> <span class="s1">'device.notification.confirm'</span><span class="p">]</span> <span class="c1">// 必填，需要使用的jsapi列表</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>agentId</td>
<td>String</td>
<td>是</td>
<td>微应用ID，普通企业可以通过OA后台的微应用－设置查看agentID，ISV需要通过调用授权成功后的get_auth_info获取授权方的agentid</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>是</td>
<td>企业ID</td>
</tr>
<tr>
<td>timeStamp</td>
<td>String</td>
<td>是</td>
<td>生成签名的时间戳</td>
</tr>
<tr>
<td>nonceStr</td>
<td>String</td>
<td>是</td>
<td>生成签名的随机串</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>是</td>
<td>签名</td>
</tr>
<tr>
<td>jsApiList</td>
<td>Array</td>
<td>是</td>
<td>需要调用的jsapi列表</td>
</tr>
</tbody></table>

<h3 id="通过ready接口处理成功验证">通过ready接口处理成功验证</h3>

<p>dd.ready参数为回调函数，在环境准备就绪时触发，jsapi的调用需要保证在该回调函数触发后调用，否则无效。</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="p">;</span>
<span class="p">});</span>
</code></pre>

<h3 id="通过error接口处理失败验证">通过error接口处理失败验证</h3>

<p>config信息验证失败会执行error函数，错误信息可以在返回的error参数中参看</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
    <span class="p">;</span>
<span class="p">});</span>
</code></pre>

<h3 id="接口约定">接口约定</h3>

<ul>
<li>所有接口都为异步</li>
<li>接受一个object类型的参数</li>
<li>成功回调 onSuccess(某些异步接口的成功回调，将在事件触发时被调用，具体详情请查看相关onSuccess回调时机，未做描述的即为同步接口)</li>
<li>失败回调 onFail</li>
</ul>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="err">命名空间</span><span class="p">.</span><span class="err">功能</span><span class="p">.</span><span class="err">方法</span><span class="p">({</span>
    <span class="err">参数</span><span class="mi">1</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="err">参数</span><span class="mi">2</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//成功回调</span>
    <span class="cm">/*
    {
        //所有返回信息都输出在这里
    }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//失败回调</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h2 id="容器">容器</h2>

<p>dd.runtime</p>

<h3 id="获取容器信息">获取容器信息</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">info</span><span class="p">({</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*{
        ability: '0.0.2' //容器版本，用来标识JSAPI能力，可根据该版本来决定能否使用jsapi
    }*/</span>
    <span class="p">}</span>
    <span class="nl">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>

<span class="p">})</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>ability</td>
<td>容器版本，用来标识JSAPI能力，可根据该版本来决定能否使用jsapi</td>
</tr>
</tbody></table>

<h3 id="获取免登授权码">获取免登授权码</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">permission</span><span class="p">.</span><span class="nx">requestAuthCode</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s2">"corpid"</span><span class="p">,</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*{
        code: 'hYLK98jkf0m' //string authCode
    }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>

<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>是</td>
<td>企业ID</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>授权码</td>
</tr>
</tbody></table>

<!--### 请求jsapi

0.0.5

```javascript
dd.runtime.permission.requestJsApis({
    corpId: '', //企业ID
    timeStamp: '', //生成签名的时间戳
    nonceStr: '', //生成签名的随机串
    signature: '', //签名
    jsApiList: [], //需要调用的jsapi列表
    onSuccess: function(result) {
    /*{
        jsApilist: [] //array[string] authJsApiList
    }*/
    }
})
```
##### 参数说明

参数 | 参数类型 | 必须 | 说明
----- | ------- | ------- | ------
corpId | String | 是 | 企业ID
timeStamp | String | 是 | 生成签名的时间戳
nonceStr | String | 是 | 生成签名的随机串
signature | String | 是 | 签名
jsApiList | array[string] | 是 | 需要调用的jsapi列表

##### 返回说明

参数 | 说明
---- | -----
jsApilist | 授权的JsApi列表
-->

<h2 id="设备">设备</h2>

<p>dd.device</p>

<h3 id="基础信息">基础信息</h3>

<h3 id="获取通用唯一识别码">获取通用唯一识别码</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">base</span><span class="p">.</span><span class="nx">getUUID</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            uuid: '3udbhg98ddlljokkkl' //
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>uuid</td>
<td>通用唯一识别码</td>
</tr>
</tbody></table>

<h3 id="获取热点接入信息">获取热点接入信息</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">base</span><span class="p">.</span><span class="nx">getInterface</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            ssid: 'alibaba-inc',
            macIp: '3c:12:aa:09'
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>ssid</td>
<td>热点ssid</td>
</tr>
<tr>
<td>macIp</td>
<td>热点mac地址</td>
</tr>
</tbody></table>

<h2 id="启动器">启动器</h2>

<p>dd.device</p>

<h3 id="检测应用是否安装">检测应用是否安装</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">launcher</span><span class="p">.</span><span class="nx">checkInstalledApps</span><span class="p">({</span>
    <span class="na">apps</span><span class="p">:</span> <span class="p">[</span><span class="s1">'taobao'</span><span class="p">,</span> <span class="s1">'tmall'</span><span class="p">],</span> <span class="c1">//iOS:应用scheme;Android:应用包名</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            installed: ['taobao', 'tmall'] //iOS:应用scheme;Android:应用包名
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>apps</td>
<td>Array[String]</td>
<td>iOS:应用scheme;Android:应用包名</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>installed</td>
<td>安装过的应用列表</td>
</tr>
</tbody></table>

<h3 id="启动第三方应用">启动第三方应用</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">launcher</span><span class="p">.</span><span class="nx">launchApp</span><span class="p">({</span>
    <span class="na">app</span><span class="p">:</span> <span class="s1">'taobao'</span><span class="p">,</span> <span class="c1">//iOS:应用scheme;Android:应用包名</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            result: true //true 唤起成功 false 唤起失败
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>app</td>
<td>String</td>
<td>iOS:应用scheme;Android:应用包名</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>值为true说明唤起成功，值为false说明唤起失败</td>
</tr>
</tbody></table>

<h3 id="获取当前网络类型">获取当前网络类型</h3>

<p>0.0.2</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">getNetworkType</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            result: 'wifi' // result值: wifi 2g 3g 4g unknown none   none表示离线
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>result值: wifi、2g、3g、4g、unknown、none，none表示离线</td>
</tr>
</tbody></table>

<h3 id="事件">事件</h3>

<p>支持事件： pause、resume、backbutton(android)</p>
<pre class="highlight plaintext"><code>//退到后台(webview)
document.addEventListener('pause', function(e) {
    e.preventDefault();
    console.log('事件：pause')
}, false);

//唤醒(webview)
document.addEventListener('resume', function(e) {
    e.preventDefault();
    console.log('事件：resume')
}, false);


//返回按钮(android)
document.addEventListener('backbutton', function(e) {
    e.preventDefault();
    dd.device.notification.alert({
        message: '哎呀，你不小心点到返回键啦!',
        title: '...警告...'
    });
}, false);
</code></pre>

<h2 id="弹窗">弹窗</h2>

<p>dd.device</p>

<h3 id="alert">alert</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">alert</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"亲爱的"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"提示"</span><span class="p">,</span><span class="c1">//可传空</span>
    <span class="na">buttonName</span><span class="p">:</span> <span class="s2">"收到"</span><span class="p">,</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在点击button之后回调</span>
        <span class="cm">/*回调*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://gw.alicdn.com/tps/TB1.3UPJpXXXXbEXVXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息内容</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>弹窗标题</td>
</tr>
<tr>
<td>buttonName</td>
<td>String</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h3 id="confirm">confirm</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">confirm</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"你爱我吗"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"提示"</span><span class="p">,</span>
    <span class="na">buttonLabels</span><span class="p">:</span> <span class="p">[</span><span class="s1">'爱'</span><span class="p">,</span> <span class="s1">'不爱'</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在点击button之后回调</span>
        <span class="cm">/*
        {
            buttonIndex: 0 //被点击按钮的索引值，Number类型，从0开始
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1cL.KJpXXXXXJaXXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息说明</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number类型，从0开始</td>
</tr>
</tbody></table>

<h3 id="prompt">prompt</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">prompt</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"再说一遍？"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"提示"</span><span class="p">,</span>
    <span class="na">buttonLabels</span><span class="p">:</span> <span class="p">[</span><span class="s1">'继续'</span><span class="p">,</span> <span class="s1">'不玩了'</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在点击button之后回调</span>
        <span class="cm">/*
        {
            buttonIndex: 0, //被点击按钮的索引值，Number类型，从0开始
            value: '' //输入的值
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1lZZJJpXXXXazaXXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息内容</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number类型，从0开始</td>
</tr>
<tr>
<td>value</td>
<td>输入的值</td>
</tr>
</tbody></table>

<h3 id="vibrate">vibrate</h3>

<p>震动</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">({</span>
    <span class="na">duration</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="c1">//震动时间，android可配置 iOS忽略</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>duration</td>
<td>Number</td>
<td>震动时间，android可配置 iOS忽略</td>
</tr>
</tbody></table>

<h3 id="showpreloader">showPreloader</h3>

<p>（显示浮层，请和hidePreloader配对使用）</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">showPreloader</span><span class="p">({</span>
    <span class="na">text</span><span class="p">:</span> <span class="s2">"使劲加载中.."</span><span class="p">,</span> <span class="c1">//loading显示的字符，空表示不显示文字</span>
    <span class="na">showIcon</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">//是否显示icon，默认true</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB17bBXJFXXXXb3XXXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>String</td>
<td>loading显示的字符，空表示不显示文字</td>
</tr>
<tr>
<td>showIcon</td>
<td>Boolean</td>
<td>是否显示icon，默认true</td>
</tr>
</tbody></table>

<h3 id="hidepreloader">hidePreloader</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">hidePreloader</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h3 id="toast">toast</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">toast</span><span class="p">({</span>
    <span class="na">icon</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//icon样式，有success和error，默认为空 0.0.2</span>
    <span class="na">text</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//提示信息</span>
    <span class="na">duration</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//显示持续时间，单位秒，默认按系统规范[android只有两种(&lt;=2s &gt;2s)]</span>
    <span class="na">delay</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//延迟显示，单位秒，默认0</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1jjdJKVXXXXXbXpXXXXXXXXXX-200-356.jpg" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>icon</td>
<td>Boolean</td>
<td>icon样式，有success和error，默认为空 0.0.2</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>提示信息</td>
</tr>
<tr>
<td>duration</td>
<td>Number</td>
<td>显示持续时间，单位秒，默认按系统规范[android只有两种(&lt;=2s &gt;2s)]</td>
</tr>
<tr>
<td>delay</td>
<td>Number</td>
<td>延迟显示，单位秒，默认0</td>
</tr>
</tbody></table>

<h3 id="actionsheet">actionsheet</h3>

<p>单选列表</p>

<p>0.0.2</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">actionSheet</span><span class="p">({</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"谁是最棒哒？"</span><span class="p">,</span> <span class="c1">//标题</span>
    <span class="na">cancelButton</span><span class="p">:</span> <span class="s1">'取消'</span><span class="p">,</span> <span class="c1">//取消按钮文本</span>
    <span class="na">otherButtons</span><span class="p">:</span> <span class="p">[</span><span class="s2">"孙悟空"</span><span class="p">,</span><span class="s2">"猪八戒"</span><span class="p">,</span><span class="s2">"唐僧"</span><span class="p">,</span><span class="s2">"沙和尚"</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在点击button之后回调</span>
        <span class="cm">/*{
            buttonIndex: 0 //被点击按钮的索引值，Number，从0开始, 取消按钮为-1
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1jn70JpXXXXXEXFXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>cancelButton</td>
<td>String</td>
<td>取消按钮文本</td>
</tr>
<tr>
<td>otherButtons</td>
<td>Array[String]</td>
<td>其他按钮列表</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number，从0开始, 取消按钮为-1</td>
</tr>
</tbody></table>

<h3 id="modal">modal</h3>

<p>modal弹浮层</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">modal</span><span class="p">({</span>
    <span class="na">image</span><span class="p">:</span><span class="s2">"http://gw.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg_200x200.jpg"</span><span class="p">,</span> <span class="c1">// 标题图片地址</span>
    <span class="na">title</span><span class="p">:</span><span class="s2">"2.4版本更新"</span><span class="p">,</span> <span class="c1">//标题</span>
    <span class="na">content</span><span class="p">:</span><span class="s2">"1.功能更新2.功能更新;"</span><span class="p">,</span> <span class="c1">//文本内容</span>
    <span class="na">buttonLabels</span><span class="p">:[</span><span class="s2">"了解更多"</span><span class="p">,</span><span class="s2">"知道了"</span><span class="p">],</span><span class="c1">// 最多两个按钮，至少有一个按钮。</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在点击button之后回调</span>
        <span class="cm">/*{
            buttonIndex: 0 //被点击按钮的索引值，Number，从0开始
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1M1MKJpXXXXadaXXXXXXXXXXX-720-1280.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>image</td>
<td>String</td>
<td>图片地址</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>content</td>
<td>String</td>
<td>文本内容</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>其他按钮列表</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number，从0开始</td>
</tr>
</tbody></table>

<h2 id="地图">地图</h2>

<p>dd.device</p>

<h3 id="获取当前地理位置">获取当前地理位置</h3>

<p>钉钉Android2.1及之前版本返回的数据会多嵌套一层location字段,2.2版本会改成和钉钉iOS客户端一致，请注意，建议对返回的数据先判断存在location，做向后兼容处理。</p>

<p>目前androidJSAPI返回的坐标是高德坐标，ios是标准坐标，如果服务端调用的是高德API，则需要对ios返回的经纬度做下处理，详细请见<a href="http://lbsbbs.amap.com/forum.php?mod=viewthread&amp;tid=724&amp;page=2"><font color=red >http://lbsbbs.amap.com/forum.php?mod=viewthread&amp;tid=724&amp;page=2</font></a>。坐标转换API <a href="http://lbs.amap.com/api/javascript-api/example/p/1602-2/"><font color=red >http://lbs.amap.com/api/javascript-api/example/p/1602-2/</font></a></p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span>
    <span class="na">targetAccuracy</span> <span class="p">:</span> <span class="nb">Number</span><span class="p">,</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            longitude : Number,
            latitude : Number,
            accuracy : Number,
            isWifiEnabled : Boolean,
            isGpsEnabled : Boolean,
            isFromMock : Boolean,
            provider : wifi|lbs|gps,
            accuracy : Number,
            isMobileEnabled : Boolean,
            errorMessage : String,
            errorCode : Number
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>targetAccuracy</td>
<td>Number</td>
<td>期望定位精度半径（单位米），定位结果尽量满足该参数要求，但是不一定能保证小于该误差</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>longitude</td>
<td>经度</td>
</tr>
<tr>
<td>latitude</td>
<td>纬度</td>
</tr>
<tr>
<td>accuracy</td>
<td>实际的定位精度半径（单位米）</td>
</tr>
<tr>
<td>isWifiEnabled</td>
<td>wifi设置是否开启，不保证已连接上</td>
</tr>
<tr>
<td>isGpsEnabled</td>
<td>gps设置是否开启，不保证已经连接上</td>
</tr>
<tr>
<td>isFromMock</td>
<td>定位返回的经纬度是否是模拟的结果</td>
</tr>
<tr>
<td>provider</td>
<td>我们使用的是混合定位，具体定位提供者有wifi/lbs/gps&quot; 这三种</td>
</tr>
<tr>
<td>isMobileEnabled</td>
<td>移动网络是设置是否开启，不保证已经连接上</td>
</tr>
<tr>
<td>errorMessage</td>
<td>对错误码的描述</td>
</tr>
<tr>
<td>errorCode</td>
<td>错误码</td>
</tr>
</tbody></table>

<!--

### 搜索
0.0.6

```javascript
dd.biz.map.search({
  scope: Number, //定位范围
  extraInfo: {
      prompt: "提示信息"
  }
  onSuccess: function(data) {
  /* data结构
      {
      "province": ""//省
      "provinceCode": "" //省份编码
      "city": "" //城市
      "cityCode": "" //城市编码
      "adCode": "" // POI的行政区划代码
      "adName": "" // POI的行政区划名称
      "distance": "" //获取POI距离中心点的距离
      "postCode": "" //返回POI的邮编
      "title": "" //POI的名称
      "snippet": "" //POI的地址
      "longitude": 11.11, //该点经度
      "latitude": 11.11, //该点纬度
      }
  */
  },
  onFail : function(err) {
  }
})
```
##### 参数说明

参数 | 参数类型 | 说明
----- | ----- | -----
scope | Number | 定位范围
extraInfo.prompt | String | 提示信息

##### 返回说明

参数 | 说明
----- | -----
province | 省份
provinceCode | 省份编码
city | 城市
cityCode | 城市编码
adCode | POI的行政区划代码
adName | POI的行政区划名称
distance | 获取POI距离中心点的距离
postCode | 返回POI的邮编
title | POI的名称
snippet | POI的地址
longitude | 该点经度
latitude | 该点纬度

###定位
0.0.6

```javascript
dd.biz.map.locate({
  onSuccess: function(data) {
   /* data结构
      {
      "province": ""//省
      "provinceCode": "" //省份编码
      "city": "" //城市
      "cityCode": "" //城市编码
      "adCode": "" // POI的行政区划代码
      "adName": "" // POI的行政区划名称
      "distance": "" //获取POI距离中心点的距离
      "postCode": "" //返回POI的邮编
      "title": "" //POI的名称
      "snippet": "" //POI的地址
      "longitude": 11.11, //该点经度
      "latitude": 11.11, //该点纬度
      }
  */
  },
  onFail : function(err) {
  }
})
```

##### 返回说明

参数 | 说明
----- | -----
province | 省份
provinceCode | 省份编码
city | 城市
cityCode | 城市编码
adCode | POI的行政区划代码
adName | POI的行政区划名称
distance | 获取POI距离中心点的距离
postCode | 返回POI的邮编
title | POI的名称
snippet | POI的地址
longitude | 该点经度
latitude | 该点纬度

-->

<h2 id="加速器">加速器</h2>

<p>dd.device</p>

<h3 id="摇一摇">摇一摇</h3>

<p>开启监听</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">accelerometer</span><span class="p">.</span><span class="nx">watchShake</span><span class="p">({</span>
    <span class="na">sensitivity</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span><span class="c1">//振动幅度，Number类型，加速度变化超过这个值后触发shake</span>
    <span class="na">frequency</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span><span class="c1">//采样间隔(毫秒)，Number类型，指每隔多长时间对加速度进行一次采样， 然后对比前后变化，判断是否触发shake</span>
    <span class="na">callbackDelay</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span><span class="c1">//触发『摇一摇』后的等待时间(毫秒)，Number类型，防止频繁调用</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>sensitivity</td>
<td>Number</td>
<td>振动幅度，Number类型，加速度变化超过这个值后触发shake</td>
</tr>
<tr>
<td>frequency</td>
<td>Number</td>
<td>采样间隔(毫秒)，Number类型，指每隔多长时间对加速度进行一次采样， 然后对比前后变化，判断是否触发shake</td>
</tr>
<tr>
<td>callbackDelay</td>
<td>Number</td>
<td>触发『摇一摇』后的等待时间(毫秒)，Number类型，防止频繁调用</td>
</tr>
</tbody></table>

<p>清除监听</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">accelerometer</span><span class="p">.</span><span class="nx">clearShake</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/* 调用成功
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h2 id="业务">业务</h2>

<p>dd.biz</p>

<h3 id="打开应用内页面">打开应用内页面</h3>
<pre class="highlight plaintext"><code>dd.biz.util.open({
    name:String,//页面名称
    params:JSONObject,//传参
    onSuccess : function() {
        /**/
    },
    onFail : function(err) {}
});
</code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>页面名称</td>
</tr>
<tr>
<td>params</td>
<td>JSONObject</td>
<td>传参</td>
</tr>
</tbody></table>

<p>目前支持以下页面，具体参数看右边</p>

<p>a.个人资料页</p>
<pre class="highlight plaintext"><code>// 页面名称：
    profile
// 传参：
    id :用户工号 String
    corpId: '' //企业id
</code></pre>

<p>b.聊天页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    chat
// 传参：
    users: ['123'] 用户列表,工号
    corpId: '' //企业id
</code></pre>

<p>c.免费电话页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    call
// 传参：
</code></pre>

<p>d.联系人添加页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    contactAdd
// 传参：
</code></pre>

<p>f.唤起添加好友页面</p>
<pre class="highlight plaintext"><code>// 页面名称：
    friendAdd
// 传参：
</code></pre>

<h3 id="分享">分享</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">share</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span><span class="c1">//分享类型，0:全部组件 默认； 1:只能分享到钉钉；2:不能分享，只有刷新按钮</span>
    <span class="na">url</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">content</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">image</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在分享完成之后回调</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1L6RvKVXXXXa3XFXXXXXXXXXX-200-356.jpg" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>Number</td>
<td>分享类型，0:全部组件默认； 1:只能分享到钉钉；2:不能分享，只有刷新按钮</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>url地址</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>分享标题</td>
</tr>
<tr>
<td>content</td>
<td>String</td>
<td>分享内容</td>
</tr>
<tr>
<td>image</td>
<td>String</td>
<td>分享的图片</td>
</tr>
</tbody></table>

<h3 id="ut数据埋点">ut数据埋点</h3>

<p>ISV与钉钉进行数据对接的数据埋点接口，用于采集用户数据，ISV可根据微应用中关键操作进行埋点</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">ut</span><span class="p">({</span>
    <span class="na">key</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//打点名</span>
    <span class="na">value</span><span class="p">:</span> <span class="nb">String</span><span class="o">/</span><span class="nx">JSONObject</span><span class="p">,</span><span class="c1">//打点传值</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>String</td>
<td>打点名，目前建议值open_micro_general_operat</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>打点传值，必须传入’corpId&rsquo;:&lsquo;传入corpId&rsquo;,&#39;agentId&rsquo;:&#39;传入agentId&rsquo;,&#39;type&rsquo;:&#39;传入type’；type(由isv自由提供的点击类型，默认可以传空)</td>
</tr>
</tbody></table>

<!--### 选取图片[暂不开放]

```javascript
dd.biz.util.chooseImage({
    multiple: false, //是否多选，默认false
    destType: String, //返回格式 DATA_URL(base64编码) FILE_URI(文件路径)，默认FILE_URI
    onSuccess : function(result) {
        /**/
    },
    onFail : function() {}
})
```
-->

<h3 id="上传图片">上传图片</h3>

<p>选择图片+上传，防止恶意上传</p>

<p>将在成功上传之后回调onSuccess方法，返回alicdn上的图片链接。微应用也可以调用<code class="prettyprint">&lt;input type=&quot;file&quot; accept=&quot;image/*&quot;&gt;</code>来自定义上传图片，此标签2.5及以上版本支持。</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">uploadImage</span><span class="p">({</span>
    <span class="na">multiple</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">//是否多选，默认false</span>
    <span class="na">max</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">//最多可选个数</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在图片上传成功之后调用</span>
        <span class="cm">/*
        [
          'http://gtms03.alicdn.com/tps/i3/TB1VF6uGFXXXXalaXXXmh5R_VXX-237-236.png'
        ]
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1FhFlKVXXXXbNXVXXXXXXXXXX-200-356.png" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>multiple</td>
<td>Boolean</td>
<td>是否多选，默认false</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>Number为正整数，最多可选个数</td>
</tr>
</tbody></table>

<h3 id="上传图片（仅支持拍照上传）">上传图片（仅支持拍照上传）</h3>

<p>只支持直接拍照上传，即调用这个API之后将直接调起相机界面</p>

<p>比如可以应用在，需要用户上传即时照片的场景。成功上传之后回调onSuccess方法，返回图片链接
<code class="prettyprint">javascript
dd.biz.util.uploadImageFromCamera({
    compression:true,//(是否压缩，默认为true)
    onSuccess : function(result) {
         //onSuccess将在图片上传成功之后调用
        /*
        [
          &#39;http://gtms03.alicdn.com/tps/i3/TB1VF6uGFXXXXalaXXXmh5R_VXX-237-236.png&#39;
        ]
        */
    },
    onFail : function() {}
})
</code></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>compression</td>
<td>Boolean</td>
<td>图片地址列表</td>
</tr>
</tbody></table>

<h3 id="图片浏览器">图片浏览器</h3>

<p>调用此api，将显示一个图片浏览器</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">previewImage</span><span class="p">({</span>
    <span class="na">urls</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">],</span><span class="c1">//图片地址列表</span>
    <span class="na">current</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//当前显示的图片链接</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1UjhmKVXXXXboXVXXXXXXXXXX-200-356.jpg" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>urls</td>
<td>Array[String]</td>
<td>图片地址列表</td>
</tr>
<tr>
<td>current</td>
<td>String</td>
<td>当前显示的图片链接</td>
</tr>
</tbody></table>

<!-- ### 扫码

```javascript
dd.biz.util.qrcode({
    onSuccess : function(result) {
        /*
        {
            text: String
        }
        */
    },
    onFail : function(err) {}
})
```
##### 返回说明
参数 | 说明
----- | ------
text | 扫码的内容 -->

<h3 id="日期选择器">日期选择器</h3>

<p>日期</p>

<p>注意：format只支持android系统规范，即2015-03-31格式为yyyy-MM-dd</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">datepicker</span><span class="p">({</span>
    <span class="na">format</span><span class="p">:</span> <span class="s1">'yyyy-MM-dd'</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="s1">'2015-04-17'</span><span class="p">,</span> <span class="c1">//默认显示日期</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在点击完成之后回调</span>
        <span class="cm">/*{
            value: "2015-02-10"
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1bcRLKVXXXXb8XXXXXXXXXXXX-200-356.png" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>format</td>
<td>String</td>
<td>format只支持android系统规范，即2015-03-31格式为yyyy-MM-dd</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>默认显示日期</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>返回选择的日期</td>
</tr>
</tbody></table>

<p>时间</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">timepicker</span><span class="p">({</span>
    <span class="na">format</span><span class="p">:</span> <span class="s1">'HH:mm'</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="s1">'14:00'</span><span class="p">,</span> <span class="c1">//默认显示时间  0.0.3</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在点击完成之后回调</span>
        <span class="cm">/*{
            value: "10:00"
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>format</td>
<td>String</td>
<td>时间格式</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>默认显示时间</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>返回选择的时间</td>
</tr>
</tbody></table>

<p>日期+时间</p>

<p>0.0.4</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">datetimepicker</span><span class="p">({</span>
    <span class="na">format</span><span class="p">:</span> <span class="s1">'yyyy-MM-dd HH:mm'</span><span class="p">,</span>
    <span class="na">value</span><span class="p">:</span> <span class="s1">'2015-04-17 08:00'</span><span class="p">,</span> <span class="c1">//默认显示</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在点击完成之后回调</span>
        <span class="cm">/*{
            value: "2015-06-10 09:50"
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>format</td>
<td>String</td>
<td>日期和时间的格式</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>默认显示的日期和时间</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>返回选择的日期和时间</td>
</tr>
</tbody></table>

<h3 id="下拉控件">下拉控件</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">chosen</span><span class="p">({</span>
    <span class="na">source</span><span class="p">:[{</span>
        <span class="na">key</span><span class="p">:</span> <span class="s1">'选项1'</span><span class="p">,</span> <span class="c1">//显示文本</span>
        <span class="na">value</span><span class="p">:</span> <span class="s1">'123'</span> <span class="c1">//值，</span>
    <span class="p">},{</span>
        <span class="na">key</span><span class="p">:</span> <span class="s1">'选项2'</span><span class="p">,</span>
        <span class="na">value</span><span class="p">:</span> <span class="s1">'234'</span>
    <span class="p">}],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//onSuccess将在点击完成之后回调</span>
        <span class="cm">/*
        {
            key: '选项2',
            value: '234'
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB177sWJpXXXXbeXFXXXXXXXXXX-750-1334.jpg" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>Array[String]</td>
<td>下拉控件的内容</td>
</tr>
<tr>
<td>key</td>
<td>String</td>
<td>显示文本</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>文本对应的值</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>返回选择的文本</td>
</tr>
<tr>
<td>value</td>
<td>返回选择的值</td>
</tr>
</tbody></table>

<h2 id="会话">会话</h2>

<p>dd.biz</p>

<h3 id="获取会话信息">获取会话信息</h3>

<p>0.0.7</p>

<p>corpid必须是用户所属的企业的corpid</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">pickConversation</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">isConfirm</span><span class="p">:</span><span class="s1">'true'</span><span class="p">,</span> <span class="c1">//是否弹出确认窗口，默认为true</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在选择结束之后调用</span>
        <span class="cm">/*{
            cid: 'xxxx',
            title:'xxx'
        }*/</span>
<span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1cXJPKVXXXXXFXXXXXXXXXXXX-200-356.png" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业ID</td>
</tr>
<tr>
<td>isConfirm</td>
<td>Boolean</td>
<td>是否弹出确认窗口，默认为true</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>cid</td>
<td>会话id</td>
</tr>
<tr>
<td>title</td>
<td>会话标题</td>
</tr>
</tbody></table>

<h3 id="根据corpid选择会话">根据corpid选择会话</h3>

<p>0.0.11</p>

<p>corpid必须是用户所属的企业的corpid</p>

<p>2.6版本新增</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">chooseConversationByCorpId</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">'xxx'</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="c1">//onSuccess将在选择结束之后调用</span>
        <span class="cm">/*{
            chatId: 'xxxx',
            title:'xxx'
        }*/</span>
<span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业ID</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>chatId</td>
<td>会话id</td>
</tr>
<tr>
<td>title</td>
<td>会话标题</td>
</tr>
</tbody></table>

<h3 id="根据chatid跳转到对应会话">根据chatid跳转到对应会话</h3>

<p>0.0.11</p>

<p>corpid必须是用户所属的企业的corpid</p>

<p>2.6版本新增</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">toConversation</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">'xxx'</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">chatId</span><span class="p">:</span><span class="s1">'xxx'</span><span class="p">,</span><span class="c1">//会话Id</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业ID</td>
</tr>
<tr>
<td>chatId</td>
<td>String</td>
<td>会话ID</td>
</tr>
</tbody></table>

<h5 id="返回说明（无）">返回说明（无）</h5>

<!--### 发送消息

```javascript
dd.biz.chat.sendMessage({
    users : ['100', '101'],//用户列表，工号
    corpId: '', //企业id
    type: 1,//消息类型 1：image  2：link  [暂定和发钉保持一致]
    attachment: {
        images: [''],
    },
    text: String,
    onSuccess : function() {},
    onFail : function() {}
})
```

### 选择会话(群)

类似分享到钉钉的选取页面，只能选一个回话 0.0.3

```javascript
dd.biz.chat.chooseConversation({
    onSuccess : function(data) {
    /*
    {
        id: '123' //会话id
    }
    */
    },
    onFail : function() {}
})
```
#####　返回说明
参数 | 说明
----- | ------
id | 会话id

###获取会话信息

0.0.6

```javascript
dd.biz.chat.getConversationInfo ({
  cid: String, //会话ID
  onSuccess: function(data) {
  /* data结构
      "cid": "1111", //会话ID
      "title": '123', //会话标题
      "avatarIcons": ["http://", ...], //会话的头像数组
      "memberCount": 11, //群聊成员总数
      }
  */
  },
  onFail : function(err) {
  }
})
```
##### 参数说明

参数 | 参数类型 | 说明
----- | ----- | -----
cid | String | 会话ID

##### 返回说明
参数 | 说明
----- | -----
cid | 会话ID
title | 会话标题
avatarIcons | 会话的头像数组
memberCount | 群聊成员总数
-->

<h2 id="ding">Ding</h2>

<p>dd.biz</p>

<h3 id="发钉">发钉</h3>

<h4 id="图片类型">图片类型</h4>

<p>0.0.3</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">ding</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
    <span class="na">users</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span> <span class="s1">'101'</span><span class="p">],</span><span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">type</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">//钉类型 1：image  2：link</span>
    <span class="na">alertType</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="na">alertDate</span><span class="p">:</span> <span class="p">{</span><span class="s2">"format"</span><span class="p">:</span><span class="s2">"yyyy-MM-dd HH:mm"</span><span class="p">,</span><span class="s2">"value"</span><span class="p">:</span><span class="s2">"2015-05-09 08:00"</span><span class="p">},</span>
    <span class="na">attachment</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">images</span><span class="p">:</span> <span class="p">[</span><span class="s1">''</span><span class="p">],</span>
    <span class="p">},</span> <span class="c1">//附件信息</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//消息</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//onSuccess将在点击发送之后调用</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1h_JtKVXXXXbNXFXXXXXXXXXX-200-356.png" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>type</td>
<td>Number</td>
<td>Number为整数。钉类型 1：image，2：link</td>
</tr>
<tr>
<td>alertType</td>
<td>Number</td>
<td>钉提醒类型 0:电话, 1:短信, 2:应用内</td>
</tr>
<tr>
<td>alertDate</td>
<td>Object</td>
<td>钉提醒时间</td>
</tr>
<tr>
<td>attachment</td>
<td>Object</td>
<td>附件信息</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>消息</td>
</tr>
</tbody></table>

<h4 id="link类型">Link类型</h4>

<p>0.0.3</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">ding</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
    <span class="na">users</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span> <span class="s1">'101'</span><span class="p">],</span><span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">type</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">//钉类型 1：image  2：link</span>
    <span class="na">alertType</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="na">alertDate</span><span class="p">:</span> <span class="p">{</span><span class="s2">"format"</span><span class="p">:</span><span class="s2">"yyyy-MM-dd HH:mm"</span><span class="p">,</span><span class="s2">"value"</span><span class="p">:</span><span class="s2">"2015-05-09 08:00"</span><span class="p">},</span>
    <span class="na">attachment</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">image</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">''</span>
    <span class="p">}</span>
    <span class="nl">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//消息</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>type</td>
<td>Number</td>
<td>Number为整数。钉类型 1：image  2：link</td>
</tr>
<tr>
<td>alertType</td>
<td>Number</td>
<td>钉提醒类型 0:电话, 1:短信, 2:应用内</td>
</tr>
<tr>
<td>alertDate</td>
<td>Object</td>
<td>钉提醒时间</td>
</tr>
<tr>
<td>attachment</td>
<td>Object</td>
<td>附件信息</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>消息</td>
</tr>
</tbody></table>

<h2 id="电话">电话</h2>

<p>dd.biz</p>

<h3 id="打电话">打电话</h3>

<p>0.0.3</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">telephone</span><span class="p">.</span><span class="nx">call</span><span class="p">({</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'101'</span><span class="p">,</span> <span class="s1">'102'</span><span class="p">],</span> <span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
</tbody></table>

<h2 id="ui控件">UI控件</h2>

<p>dd.ui</p>

<h3 id="输入框">输入框</h3>

<p>0.0.2</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">plain</span><span class="p">({</span>
    <span class="na">placeholder</span><span class="p">:</span> <span class="s1">'说点什么吧'</span><span class="p">,</span> <span class="c1">//占位符</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//默认填充文本</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//onSuccess将在点击发送之后调用</span>
        <span class="cm">/*{
            text: String
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1ju0BKVXXXXcrXpXXXXXXXXXX-200-356.png" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>placeholder</td>
<td>String</td>
<td>占位符</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>默认填充文本</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>返回文本</td>
</tr>
</tbody></table>

<h3 id="设置顶部进度条颜色">设置顶部进度条颜色</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progressBar</span><span class="p">.</span><span class="nx">setColors</span><span class="p">({</span>
    <span class="na">colors</span><span class="p">:</span> <span class="p">[],</span> <span class="c1">//array[number] 进度条变化颜色，最多支持4个颜色</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
            true:成功  false:失败
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>colors</td>
<td>array[number]</td>
<td>进度条变化颜色，最多支持4个颜色</td>
</tr>
</tbody></table>

<h3 id="启用下拉刷新">启用下拉刷新</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">pullToRefresh</span><span class="p">.</span><span class="nx">enable</span><span class="p">({</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h3 id="收起下拉loading">收起下拉loading</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">pullToRefresh</span><span class="p">.</span><span class="nx">stop</span><span class="p">()</span>
</code></pre>

<h3 id="禁用下拉刷新">禁用下拉刷新</h3>

<p>0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">pullToRefresh</span><span class="p">.</span><span class="nx">disable</span><span class="p">()</span>
</code></pre>

<h3 id="启用bounce">启用bounce</h3>

<p>启用iOS webview弹性效果(仅iOS支持) 0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">webViewBounce</span><span class="p">.</span><span class="nx">enable</span><span class="p">()</span>
</code></pre>

<h3 id="禁用bounce">禁用bounce</h3>

<p>禁用iOS webview弹性效果(仅iOS支持) 0.0.5</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">webViewBounce</span><span class="p">.</span><span class="nx">disable</span><span class="p">()</span>
</code></pre>

<h2 id="扫码">扫码</h2>

<p>dd.biz</p>

<p>0.0.6</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">scan</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span><span class="c1">//type为qrCode或者barCode</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//onSuccess将在扫码成功之后回调</span>
      <span class="cm">/* data结构
        { 'text': String}
      */</span>
    <span class="p">},</span>
   <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
   <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>String</td>
<td>type为qrCode或者barCode</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>扫码内容</td>
</tr>
</tbody></table>

<h2 id="企业通讯录">企业通讯录</h2>

<p>dd.biz</p>

<h3 id="选人">选人</h3>

<p>0.0.6</p>

<p>corpid必须是用户所属的企业的corpid</p>

<p>此接口只能对用户进行选择，若要同时选择部门，请使用“选人，选部门”接口。</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">choose</span><span class="p">({</span>
  <span class="na">startWithDepartmentId</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//-1表示打开的通讯录从自己所在部门开始展示, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</span>
  <span class="na">multiple</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span> <span class="c1">//是否多选： true多选 false单选； 默认true</span>
  <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">,</span> <span class="nb">String</span><span class="p">,</span> <span class="p">...],</span> <span class="c1">//默认选中的用户列表，工号；成功回调中应包含该信息</span>
  <span class="na">corpId</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//企业id</span>
  <span class="na">max</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//人数限制，当multiple为true才生效，可选范围1-1500</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//onSuccess将在选人结束，点击确定按钮的时候被回调</span>
  <span class="cm">/* data结构
    [{
      "name": "张三", //姓名
      "avatar": "http://g.alicdn.com/avatar/zhangsan.png" //头像图片url，可能为空
      "emplId": '0573', //工号
     },
     ...
    ]
  */</span>
  <span class="p">},</span>
  <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1j_JPKVXXXXXbXXXXXXXXXXXX-200-356.png" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>startWithDepartmentId</td>
<td>Number</td>
<td>-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</td>
</tr>
<tr>
<td>multiple</td>
<td>Boolean</td>
<td>是否多选： true多选，false单选； 默认true</td>
</tr>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>默认选中的用户列表，用户id；成功回调中应包含该信息</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>人数限制，当multiple为true才生效，可选范围1-1500</td>
</tr>
</tbody></table>

<!--
startWithDepartmentId: Number, //-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)
startWithDepartmentId | Number | -1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)
-->

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>姓名</td>
</tr>
<tr>
<td>avatar</td>
<td>头像图片url，可能为空</td>
</tr>
<tr>
<td>emplId</td>
<td>用户id，<a href="#%B7%D6%10X%E6%C5"><font color=red>获取成员详情接口</font></a></td>
</tr>
</tbody></table>

<h3 id="选人，选部门">选人，选部门</h3>

<p>0.0.6</p>

<p>corpid必须是用户所属的企业的corpid</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">complexChoose</span><span class="p">({</span>
  <span class="na">startWithDepartmentId</span><span class="p">:</span> <span class="nb">Number</span><span class="p">,</span> <span class="c1">//-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</span>
  <span class="na">selectedUsers</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">,</span> <span class="nb">String</span><span class="p">,</span> <span class="p">...],</span> <span class="c1">//预选用户</span>
  <span class="na">corpId</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="c1">//企业id</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//onSuccess将在选人，选部门结束，点击确定按钮的时候被回调</span>
  <span class="cm">/* data结构
    {
      "users": [
      {
        "name": "张三", //姓名
        "avatar": "htp://g.alicdn.com/avatar/zhangsan.png" //头像图片url，可能为空
        "emplId": "0573", //工号:
      },
      ...
      ],
      "department": [
      {
        "id": 2,
        "name": "来往事业部",
      },
      ...
      ]
    }
  */</span>
  <span class="p">},</span>
  <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB1QCXuKVXXXXbWXFXXXXXXXXXX-750-1334.jpg
" width = "200" height = "355" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>startWithDepartmentId</td>
<td>Number</td>
<td>-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)</td>
</tr>
<tr>
<td>selectedUsers</td>
<td>Array[String]</td>
<td>预选用户</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
</tbody></table>

<!--隐藏selectedDepartments
selectedDepartments | Array | 预选部门 id必选，name可选
selectedDepartments: [{name: '', id: ''}, ...],//预选部门 id必选，name可选
-->

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>选取的用户</td>
</tr>
<tr>
<td>users.name</td>
<td>姓名</td>
</tr>
<tr>
<td>users.avatar</td>
<td>头像图片url，可能为空</td>
</tr>
<tr>
<td>users.emplId</td>
<td>用户id,<a href="#%B7%D6%10X%E6%C5"><font color=red>获取成员详情接口</font></a></td>
</tr>
<tr>
<td>department</td>
<td>选取的部门</td>
</tr>
<tr>
<td>department.id</td>
<td>部门id</td>
</tr>
<tr>
<td>department.name</td>
<td>部门名称</td>
</tr>
</tbody></table>

<!-- ### 选取

默认展示当前  业通讯录，开发中

```javascript
dd.biz.contact.choose({
    multiple: true, //是否多选： true多选 false单选； 默认true
    users: ['100','101'], //默认选中的用户列表，工号；成功回调中应包含该信息
    corpId: '', //企业id
    max: 50, //人数限制，当multiple为true才生效，可选范围1-1500
    onSuccess : function(result) {
        /*
        [{
            emplId: '0573', //工号
            name: '张三', //姓名
            nickNameCn: '三张', //花名
            mobilePhone: '****', //手机号 后续不再返回该字段
            emailAddr: '***', //邮箱  后期不再返回该字段
            pinyin: 'zhangsan', //姓名拼音
            avatar: 'htp://g.alicdn.com/avatar/zhangsan.png' //头像图片url，可能为空
        }]
        */
    },
    onFail : function(err) {}
});
```

##### 参数说明

参数 | 参数类型 | 说明
----- | ----- | -----
multiple | Boolean | 是否多选： true多选 false单选； 默认true
users | Array[String] | 默认选中的用户列表，工号；成功回调中应包含该信息
corpId | String |  企业id
max | Number| Number为正整数。人数限制，当multiple为true才生效，可选范围1-1500


#####　返回说明

参数 | 说明
------|------
emplID | 是否多选： true多选 false单选； 默认true
name | 姓名
nickNameCn | 花名
mobilePhone | 手机号，后续不再返回该字段
emailAddr | 邮箱，后期不再返回该字段
pinyin | 姓名拼音
avatar | 头像图片url，可能为空 -->

<h3 id="创建企业群聊天">创建企业群聊天</h3>

<p>0.0.4</p>

<p>corpid必须是用户所属的企业的corpid</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">createGroup</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//企业id，可选，配置该参数即在指定企业创建群聊天</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span><span class="s1">'101'</span><span class="p">],</span> <span class="c1">//默认选中的用户工号列表，可选；使用此参数必须指定corpId</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            id: 123   //企业群id
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id，可选，配置该参数即在指定企业创建群聊天</td>
</tr>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>默认选中的用户列表，可选；使用此参数必须指定corpId</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>企业群id</td>
</tr>
</tbody></table>

<!--### 添加好友

```javascript
dd.biz.contact.addFriend({
    onSuccess: function(result) {
        /*{
            id: 123   //企业群id
        }*/
    },
    onFail: function(err) {
    }
})
```
-->

<!--## 用户

### 获取当前用户信息

目前只开放emplId字段

```javascript
dd.biz.user.get({
    onSuccess : function(result) {
        /*
        {
            id: '112', //id
            emplId: '0573' //工号
        }
        */
    },
    onFail : function(err) {}
});
```
-->

<h2 id="导航栏">导航栏</h2>

<p>dd.biz</p>

<h3 id="设置导航栏颜色">设置导航栏颜色</h3>
<pre class="highlight html"><code>/**
 * 设置导航栏颜色为FF5E97F6
 */
http://abc.xyz?dd_nav_bgcolor=FF5E97F6
</code></pre>

<h5 id="参数说明">参数说明</h5>

<p>目前设置导航栏颜色是通过url参数进行配置, 其键为dd_nav_bgcolor，其值形式为AARRGGBB</p>

<p>例如：微应用当前页面的链接为：https://abc.xyz/，设置导航栏颜色时增加参数，参数名是dd_nav_bgcolor，值为FF112233 其中前面两位默认是FF，后面6位是对应的色值，最终的页面url为：https://abc.xyz/?dd_nav_bgcolor=FF5E97F6</p>

<h3 id="设置左侧导航按钮">设置左侧导航按钮</h3>

<p>只支持iOS</p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setLeft</span><span class="p">({</span>
    <span class="na">show</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span><span class="c1">//控制按钮显示， true 显示， false 隐藏， 默认true</span>
    <span class="na">control</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否控制点击事件，true 控制，false 不控制， 默认false</span>
    <span class="na">showIcon</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否显示icon，true 显示， false 不显示，默认true； 注：具体UI以客户端为准</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span><span class="c1">//控制显示文本，空字符串表示显示默认文本</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
        <span class="c1">//如果control为true，则onSuccess将在发生按钮点击事件被回调</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>show</td>
<td>Boolean</td>
<td>控制按钮显示， true 显示， false 隐藏， 默认true</td>
</tr>
<tr>
<td>control</td>
<td>Boolean</td>
<td>是否控制点击事件，true 控制，false 不控制， 默认false</td>
</tr>
<tr>
<td>showIcon</td>
<td>Boolean</td>
<td>是否显示icon，true 显示，false 不显示，默认true； 注：具体UI以客户端为准</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>控制显示文本，空字符串表示显示默认文本</td>
</tr>
</tbody></table>

<h3 id="设置右侧导航按钮">设置右侧导航按钮</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setRight</span><span class="p">({</span>
    <span class="na">show</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span><span class="c1">//控制按钮显示， true 显示， false 隐藏， 默认true</span>
    <span class="na">control</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否控制点击事件，true 控制，false 不控制， 默认false</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'发送'</span><span class="p">,</span><span class="c1">//控制显示文本，空字符串表示显示默认文本</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {}
        */</span>
        <span class="c1">//如果control为true，则onSuccess将在发生按钮点击事件被回调</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>show</td>
<td>Boolean</td>
<td>控制按钮显示， true 显示， false 隐藏， 默认true</td>
</tr>
<tr>
<td>control</td>
<td>Boolean</td>
<td>是否控制点击事件，true 控制，false 不控制， 默认false</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>控制显示文本，空字符串表示显示默认文本</td>
</tr>
</tbody></table>

<p>可通过拼接url方式隐藏 showmenu=false</p>

<h3 id="设置标题">设置标题</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setTitle</span><span class="p">({</span>
    <span class="na">title</span> <span class="p">:</span> <span class="s1">'邮箱正文'</span><span class="p">,</span><span class="c1">//控制标题文本，空字符串表示显示默认文本</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*结构
        {
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>String</td>
<td>控制标题文本，空字符串表示显示默认文本</td>
</tr>
</tbody></table>

<h3 id="设置标题栏icon">设置标题栏Icon</h3>

<p>调用此jsapi之后，icon的显示位置在Android和iOS上有所区别,如下图</p>

<ul>
<li>iOS：显示在导航栏标题的右边，紧靠着标题</li>
<li>Android：显示在导航栏右侧按钮组的最左边</li>
</ul>

<p><img alt="setIcon" src="https://img.alicdn.com/tps/TB1ckCRKVXXXXXdXVXXXXXXXXXX-325-117.jpg" /></p>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setIcon</span><span class="p">({</span>
    <span class="na">showIcon</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//是否显示icon</span>
    <span class="na">iconIndex</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="c1">//显示的iconIndex,如图</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*结构
        {
        }*/</span>
        <span class="c1">//点击icon之后将会回调这个函数</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//jsapi调用失败将会回调此函数</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<p><img src="https://img.alicdn.com/tps/TB16nmYKVXXXXXiXFXXXXXXXXXX-184-274.jpg" width = "184" height = "274" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>showIcon</td>
<td>Boolean</td>
<td>控制按钮显示， true 显示， false 隐藏， 默认false</td>
</tr>
<tr>
<td>iconIndex</td>
<td>int</td>
<td>将要显示的icon的iconIndex（对应关系如右图,有三种icon可选）  注：具体UI以客户端为准</td>
</tr>
</tbody></table>

<h3 id="触发关闭">触发关闭</h3>
<pre class="highlight javascript"><code><span class="nx">dd</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">close</span><span class="p">({</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*result结构
        {}
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h2 id="分享到会话">分享到会话</h2>

<p>该功能是钉钉团队为开发者提供，帮助移动应用通过用户社交快速传播的功能。</p>

<p>“分享到会话”功能为客户端调用功能，请将对应SDK集成至开发者移动端应用中。</p>

<h3 id="场景介绍">场景介绍</h3>

<p>用户使用开发者制作的移动应用时，可以将自己喜欢的内容，通过该功能快速地转发给自己在钉钉内的好友。好友点击打开内容链接，
将通过钉钉内置浏览器打开网页的形式进行呈现。在传播内容的同时，也会同时露出应用的名称与logo，起到品牌传播的效果。</p>

<h3 id="应用范例">应用范例</h3>

<h4 id="支付宝">支付宝</h4>

<p>从支付宝发送红包可以分享给钉钉同事，用户分享后，钉钉好友可以通过这个分享直接打开支付宝抢红包。</p>

<h3 id="渠道显示说明">渠道显示说明</h3>

<p>1、当用户手机安装钉钉2.7及以上版本，正常分享；</p>

<p>2、当用户手机没有安装钉钉，点击分享渠道可以弹出提示，也可以引导用户下载钉钉。IOS引导至appstore，安卓引导至：http://www.dingtalk.com/index-b.html</p>

<p>3、当用户手机安装钉钉版本低于2.7，点击分享渠道出提示升级钉钉。</p>

<h3 id="分享sdk接入前准备">分享sdk接入前准备</h3>

<p>分享到钉钉好友的所有接口功能，均需要使用在开放平台上创建的应用进行调用。目前仅支持阿里内部渠道的线下接入。线上的应用创建流程还在开发中。请随时关注文档更新。</p>

<h3 id="接入流程">接入流程</h3>

<h4 id="android接入流程">Android接入流程</h4>

<p>1、搭建开发环境</p>

<p>[1] 推荐用Android Studio建立工程。</p>

<p>[2] 在工程中新建一个libs目录，将开发工具包中libs目录下的libddshare.jar复制到该目录中（如下图所示，建立了一个名为DDShareDemo 的工程，并把jar包复制到libs目录下）。</p>

<p><img src="https://img.alicdn.com/tps/TB1gMLMKVXXXXbFXFXXXXXXXXXX-1082-690.png"  /></p>

<p>[3] 将libs目录下的libddshare.jar文件添加到工程依赖中。</p>

<p>2、 在代码中使用开发工具包</p>

<p>[1] 具体可参考demo的代码。</p>

<p>[2] 接收钉钉的回调
如果你的程序需要接收钉钉发送的请求，或者接收发送到钉钉请求的响应结果，需要下面3步操作：</p>

<p>a. 在你的包名相应目录下新建一个ddshare包，并在该ddshare目录下新增一个DDShareActivity类，该类继承自Activity（例如应用程序的包名为com.laiwang.ding.share.openapi.ddshareopenapi，则新添加的类如下图所示）</p>

<p><img src="https://img.alicdn.com/tps/TB1s0PEKVXXXXa.aXXXXXXXXXXX-1000-468.png"  /></p>

<p>并在AndroidManifest文件里面加上exported属性，设置为true，例如：</p>

<p><img src="https://img.alicdn.com/tps/TB1jGn8KVXXXXa6XXXXXXXXXXXX-1030-322.png"  /></p>

<p>b. 实现IDDAPIEventHandler接口，发送到定递给你请求的响应结果将回调到onResp方法</p>

<p>c. 在DDShareActivity中将接收到的intent及实现了IDDAPIEventHandler接口的对象传递给IDDShareApi接口的handleIntent方法，示例如下图：</p>

<p><img src="https://img.alicdn.com/tps/TB1SXrSKVXXXXaWXFXXXXXXXXXX-952-220.png"  /></p>

<p>应用请求钉钉的响应结果将通过onResp回调。
注意
如果需要混淆代码，为了保证sdk的正常使用，需要在proguard.cfg加上下面两行配置：
-keep class  com.android.dingtalk.share.ddsharemodule.** {
   *;
}</p>

<p>3、 判断当前设备是否支持分享</p>

<p>钉钉从2.7版本开始支持分享，api中提供了接口来判断当前设备是否能够支持分享到钉钉</p>

<p>[1]判断当前设备是否已经安装钉钉</p>

<p>boolean isInstalled = iddShareApi.isDDAppInstalled();</p>

<p>[2]判断当前设备是否支持分享到钉钉（已经安装钉钉&amp;&amp;钉钉版本支持分享）</p>

<p>boolean isSupport = iddShareApi.isDDSupportAPI();</p>

<p>4、 分享支持的类型</p>

<p>支持文本、图片、链接以及特殊的支付宝红包类型，具体使用可参考Demo</p>

<h4 id="ios接入流程">iOS接入流程</h4>

<p>准备工作</p>

<ul>
<li>申请AppID, 申请时请提供，应用的BundleID，应用名称和应用图标，图标需要提供两个尺寸：28x28px和 108x108px，格式为PNG；</li>
<li>下载DTShareSDK；DTShareSDK最低部署系统版本为iOS7.0，包含 <code class="prettyprint">armv7, i386, x86_64, arm64</code> 架构；</li>
<li>安装钉钉iOS客户端2.7.0及以后的版本；</li>
</ul>

<p>步骤1：将SDK的下列文件导入到工程中；</p>

<p><img alt="share_sdk_import" src="https://img.alicdn.com/tps/TB1hydHLXXXXXXFXXXXXXXXXXXX-290-97.png" /></p>

<p>步骤2：配置工程</p>

<ul>
<li>在Other Linker Flags添加 <code class="prettyprint">-all_load</code>选项;</li>
</ul>

<p><img alt="other_linker_flags" src="https://img.alicdn.com/tps/TB118c9KVXXXXcIaXXXXXXXXXXX-808-201.png" /></p>

<ul>
<li>将申请的appId添加到URL Types中作为钉钉回调的scheme, <code class="prettyprint">identifier</code> 填写<code class="prettyprint">dingtalk</code>; <code class="prettyprint">URL Schemes</code>填写申请的AppId。 iOS9及以后的系统需要将钉钉和分享SDK的scheme配置在Info.plist的LSApplicationQueriesSchemes列表中，scheme分别为 <code class="prettyprint">dingtalk, dingtalk-open</code></li>
</ul>

<p><img alt="Alt text" src="https://img.alicdn.com/tps/TB1QyhdLXXXXXbZXVXXXXXXXXXX-973-709.png" /></p>

<p>步骤4：注册应用并添加必要的URL Handler</p>

<p>如示例中，在AppDelegate.m文件中引用<code class="prettyprint">AppDelegate.h</code>，在@implementation AppDelegate中增加如下代码：</p>

<p><img alt="share_sdk_code_sample" src="https://img.alicdn.com/tps/TB1F7xvLXXXXXbHXpXXXXXXXXXX-999-554.png" /></p>

<p>步骤4：分享数据到钉钉客户端</p>

<p>发送分享请求的过程主要分为两部分：</p>

<ul>
<li>组装DTMediaMessage对象；</li>
<li>调用+[DTOpenAPI sendReq:]发送数据；</li>
</ul>

<p>不同类型的分享数据通过DTMediaMessage的mediaObject区分：</p>

<ul>
<li>DTMediaTextObject 纯文本数据；</li>
<li>DTMediaImageObject 纯图片数据；</li>
<li>DTMediaWebObject Web页面数据；</li>
</ul>

<p>下面是分享文本部分代码，其它类型请参考Demo示例：</p>

<p><img alt="share_sdk_text_sample_code" src="https://img.alicdn.com/tps/TB1ZWthLXXXXXbxXVXXXXXXXXXX-595-257.png" /></p>

<p><strong>注意：分享纯图片数据和Web页面缩略图时，可以使用两种形式：图片URL和图片Data，钉钉内优先使用图片Data形式；分享数据的数据量限制在SDK的头文件中均有描述，超过限制的数据不会发送到钉钉客户端。</strong></p>

<h4 id="判断当前设备是否支持分享到钉钉">判断当前设备是否支持分享到钉钉</h4>

<p>钉钉从2.7版本开始支持分享，SDK中提供了接口来判断当前设备是否能够支持分享到钉钉。</p>

<p><img alt="share_sdk_check_dingtalk_api" src="https://img.alicdn.com/tps/TB1zfhBLXXXXXXpXpXXXXXXXXXX-556-288.png" /></p>

<p><strong>注意：在iOS9上需要将钉钉SDK相关的Scheme注册到Info.plist的LSApplicationQueriesSchemes明代中，否则会导致检测方法总是返回NO。</strong></p>

<h3 id="demo下载">Demo下载</h3>

<p><a href="http://download.taobaocdn.com/freedom/31112/compress/p1a71dcqcqen6g7e2joobd1bdm4.zip"><font color=blue >Android Demo 下载</font></a></p>

<p><a href="http://download.taobaocdn.com/freedom/31112/compress/DTShareKit.zip"><font color=blue >iOS Demo 下载</font></a></p>

<h2 id="附录">附录</h2>

<h3 id="js-api权限签名算法">JS-API权限签名算法</h3>

<p>如果开发者想使用钉钉容器开放的jsapi接口，需要经过以下流程：</p>

<ul>
<li><p>首先需要<a href="#获取jsapi_ticket"><font color=red >获取jsapi_ticket</font></a>。</p></li>
<li><p>然后在web页面加载到钉钉容器时，通过<a href="#页面引入js文件"><font color=red >jsapi权限验证配置接口</font></a>验证可用的jsapi。这个接口使用的参数signature，在下文中有详细的说明。</p></li>
</ul>

<h4 id="1-获取jsapi_ticket">1.获取jsapi_ticket</h4>

<p>jsapi_ticket,是开发者调用钉钉JS接口的临时授权码，其作用主要用于生成签名，这个签名在<a href="http://open.dingtalk.com/#页面引入js文件"><font color=red >jsapi权限验证配置接口</font></a>中使用。</p>

<p>正常的情况下，jsapi_ticket的有效期为7200秒，通过access_token（注意，假如您是ISV开发者，这个access_token需要<a href="#8-获取企业授权的access_token"><font color=red >企业授权的access_token接口</font></a>）来获取。由于频繁刷新jsapi_ticket会导致api调用受限，影响自身业务，开发者必须在自己的服务全局缓存jsapi_ticket。
获取jsapi_ticket，具体可以<a href="#js接口api"><font color=red >参考文档</font></a></p>

<h4 id="2-签名生成算法">2.签名生成算法</h4>

<p>开发者在web页面使用钉钉容器提供的jsapi时，需要验证调用权限，并以参数signature标识合法性</p>

<p>签名生成的规则：</p>

<p>List keyArray = sort(noncestr,timestamp,jsapi_ticket,url);</p>

<p>String str = assemble(keyArray);</p>

<p>signature = sha1(str);</p>

<p>参与签名的字段包括在上文中获取的jsapi_ticket，noncestr（随机字符串，自己随便填写即可）,timestamp（当前时间戳，具体值为当前时间到1970年1月1号的秒数）,url（当前网页的URL，不包含#及其后面部分）。例如：</p>

<ul>
<li>noncestr=Zn4zmLFKD0wzilzM</li>
<li>jsapi_ticket=mS5k98fdkdgDKxkXGEs8LORVREiweeWETE40P37wkidkfksDSKDJFD5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcKIDU8l</li>
<li>timestamp=1414588745</li>
<li>url=http://open.dingtalk.com</li>
</ul>

<p>步骤1. sort()含义为对所有待签名参数按照字段名的ASCII 码从小到大排序（字典序）</p>

<p>步骤2. assemble()含义为根据步骤1中获的参数字段的顺序，使用URL键值对的格式（即key1=value1&amp;key2=value2…）拼接成字符串</p>

<p>步骤2. sha1()的含义为对在步骤2拼接好的字符串进行sha1加密。</p>

<h3 id="图片缩放">图片缩放</h3>

<p>通过JS-API获取的图片都支持缩放，比如图片：</p>

<p><code class="prettyprint">http://gtms02.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg</code></p>

<p>可通过文件名拼接的方法缩放为最大宽高为250x250的尺寸。</p>

<p><code class="prettyprint">http://gtms02.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg_250x250.jpg</code></p>

<p>拼接规则为:文件名+拼接规则；推荐使用以下拼接规则：</p>

<p>80x80 =&gt; _80x80.jpg</p>

<p>120x120 =&gt; _120x120.jpg</p>

<p>250x250 =&gt; _250x250.jpg</p>

<p>310x310 =&gt; _310x310.jpg</p>

<h3 id="容器能力">容器能力</h3>

<p><a href="#alert">device.notification.alert</a></p>

<p><a href="#confirm">device.notification.confirm</a></p>

<p><a href="#prompt">device.notification.prompt</a></p>

<p><a href="#vibrate">device.notification.vibrate</a></p>

<p><a href="#摇一摇">device.accelerometer.watchShake</a></p>

<p><a href="#摇一摇">device.accelerometer.clearShake</a></p>

<p><a href="#打开应用内页面">biz.util.open</a></p>

<p><a href="#分享">biz.util.share</a></p>

<p><a href="#ut打点">biz.util.ut</a></p>

<p><a href="#日期选择器">biz.util.datepicker</a> //android</p>

<p><a href="#日期选择器">biz.util.timepicker</a> //android</p>

<p><a href="#选人">biz.contact.choose</a></p>

<!--
[biz.user.get](#get)
-->

<p><a href="#设置左侧导航按钮">biz.navigation.setLeft</a></p>

<p><a href="#设置右侧导航按钮">biz.navigation.setRight</a></p>

<p><a href="#设置标题">biz.navigation.setTitle</a></p>

<p>// v0.0.1</p>

<p><a href="#toast">device.notification.toast</a></p>

<p><a href="#showpreloader">device.notification.showPreloader</a></p>

<p><a href="#hidepreloader">device.notification.hidePreloader</a></p>

<p><a href="#获取当前地理位置">device.geolocation.get</a></p>

<p><a href="#上传图片">biz.util.uploadImage</a></p>

<p><a href="#图片浏览器">biz.util.previewImage</a></p>

<p>//v0.0.2</p>

<p><a href="#输入框">ui.input.plain</a></p>

<p><a href="#actionsheet">device.notification.actionSheet</a></p>

<p><a href="#获取当前网络类型">device.connection.getNetworkType</a></p>

<p><a href="#获取容器信息">runtime.info</a></p>

<p>//v0.0.3</p>

<p><a href="#发钉">biz.ding.post</a></p>

<p><a href="#打电话">biz.telephone.call</a></p>

<p>//v0.0.4</p>

<p><a href="#创建企业群聊天">biz.contact.createGroup</a></p>

<p><a href="#日期选择器">biz.util.datetimepicker</a></p>

<p>//v0.0.5</p>

<p><a href="#下拉控件">biz.util.chosen</a></p>

<p><a href="#获取通用唯一识别码">device.base.getUUID</a></p>

<p><a href="#获取热点接入信息">device.base.getInterface</a></p>

<p><a href="#检测应用是否安装">device.launcher.checkInstalledApps</a></p>

<p><a href="#启动第三方应用">device.launcher.launchApp</a></p>

<p><a href="#设置顶部进度条颜色">ui.progressBar.setColors</a></p>

<p><a href="#获取免登授权码">runtime.permission.requestAuthCode</a></p>

<p><a href="#启用下拉刷新">ui.pullToRefresh.enable</a></p>

<p><a href="#收起下拉loading">ui.pullToRefresh.stop</a></p>

<p><a href="#禁用下拉刷新">ui.pullToRefresh.disable</a></p>

<p><a href="#启用bounce">ui.webViewBounce.enable</a></p>

<p><a href="#启用bounce">ui.webViewBounce.disable</a></p>

<p><a href="#触发关闭">biz.navigation.close</a></p>

<p>//0.0.6</p>

<p><a href="#扫码">biz.util.scan</a></p>

<p><a href="#选人，选部门">biz.contact.complexChoose</a></p>

<p>//0.0.7</p>

<p><a href="#获取会话信息">biz.chat.pickConversation</a></p>

<p>//0.0.8</p>

<p><a href="#modal">device.notification.modal</a></p>

<p><a href="#上传图片（仅支持拍照上传）">biz.util.uploadImageFromCamera</a></p>

<p>//0.0.11</p>

<p><a href="#根据corpid选择会话">biz.chat.chooseConversationByCorpId</a></p>

<p><a href="#根据chatid跳转到对应会话">biz.chat.toConversation</a></p>

          <h1 id="pc端开发文档">PC端开发文档</h1>

<p>微应用是 钉钉 为连接企业办公打造的办公入口，通过微应用你可以将企业的业务审批，内部系统，生成，协作，管理，上下游沟通连接到钉钉，更简单和低成本实现企业协同；</p>

<p>结合钉钉的基础通信能力，让企业应用更活跃，员工更高效。</p>

<p>钉钉的 PC 端开发文档将为开发者提供调用钉钉基础控件的能力，通过与客户端微应用结合，给用户带来多端的体验。</p>

<h2 id="demo-和调试工具">Demo 和调试工具</h2>

<p>我们提供了Demo和调试工具给您的开发提供方便，如果对调用参数有疑问，请使用调试工具。</p>

<!-- 对jsapi用法有疑问，可查看Demo. -->

<p>调试工具: 点击 <a href="https://t.dingtalk.com/invite/index?code=5b2a85509e&amp;inviterUid=80E166E782C43269">https://t.dingtalk.com/invite/index?code=5b2a85509e&amp;inviterUid=80E166E782C43269</a>申请加入该组织，获得同意后，在 PC 端点击 [工作] - [钉钉API测试]。</p>

<!-- github:`待补充` -->

<h2 id="配置展示形式">配置展示形式</h2>

<h3 id="企业接入">企业接入</h3>

<p>通过访问管理后台<a href="https://oa.dingtalk.com">https://oa.dingtalk.com</a>，点击[微应用]-[新增微应用]，输入 PC 端地址，重新登录即可出现。</p>

<h3 id="isv接入">ISV接入</h3>

<p>参考<a href="http://open.dingtalk.com/doc/index.html?spm=a3140.7785475.0.0.07BTXr#3-创建微应用">创建微应用</a>，配置 pc 端地址即可。</p>

<h3 id="企业会话支持-pc-端打开">企业会话支持 PC 端打开</h3>

<p>参考<a href="http://open.dingtalk.com/doc/index.html?spm=a3140.7785475.0.0.07BTXr#发送企业会话消息">发送企业会话消息</a>，消息体中带入 pc_message_url 即可实现在 PC 端的打开。</p>

<h2 id="应用设计">应用设计</h2>

<!--
#### 样式库

钉钉不限制第三方微应用的表现形式，但是需要引入钉钉的默认基础样式，基础样式确保了字体，字体颜色，行间距等基础的样式统一。

引入下列 reset.css:`待补充`

同时，钉钉提供了部分通用样式供开发者参考，包含了头像，按钮，icon等资源。 `待补充`

同时，钉钉要求开发者在设计微应用的时候，基于 `retina` 进行开发； -->

<h4 id="响应式">响应式</h4>

<p>因为钉钉的 PC 端的宽度是可变的，所以微应用的页面都要求进行响应式设计。</p>

<h5 id="基础尺寸-企业会话详情">基础尺寸 - 企业会话详情</h5>

<p><img src="https://static.dingtalk.com/media/lALOArO7PM0CWs0DhA_900_602.png" />
企业会话详情目前是定宽设计（360px），但不排除未来该宽度可以调整，所以需要开发者将此页面进行响应式设计。</p>

<h5 id="基础尺寸-微应用首页">基础尺寸 - 微应用首页</h5>

<p><img src="https://static.dingtalk.com/media/lALOArO6j80CWs0DhA_900_602.png" />
微应用首页默认宽度是585px，支持用户拖拽更改宽高，所以需要开发者将此页面进行响应式设计。</p>

<h2 id="通用">通用</h2>

<h3 id="页面引入js文件">页面引入js文件</h3>

<p>js文件版本在添加升级功能时地址会变化，如有需要（比如要使用新增的js-api）,请随时关注地址变更。但是旧版本js文件也将一直可用。</p>

<p><code class="prettyprint">http://g.alicdn.com/dingding/dingtalk-pc-api/2.3.1/index.js</code></p>

<h3 id="全局变量、命名空间">全局变量、命名空间</h3>

<p>直接引入index.js会得到一个全局变量<code class="prettyprint">DingTalkPC</code>，支持amd、cmd引入方式</p>

<p>全局变量DingTalkPC，命名空间：设备(DingTalkPC.device)、业务(DingTalkPC.biz)</p>

<h3 id="权限验证配置-beta">权限验证配置(beta)</h3>

<p>钉钉JS API安全验证，只有经过安全验证的微应用才能调用安全级别较高的API。</p>

<p>获取JS-API权限验证使用的签名的方法请参考附录-<a href="#js-api权限签名算法"><font color=red >JS-API权限签名算法</font></a></p>

<p><a href="https://github.com/injekt/jsapi-demo"><font color=red >jsapi权限验证配置demo&ndash;node.js版本</font></a></p>

<p><a href="https://github.com/injekt/openapi-demo-java"><font color=red >jsapi权限验证配置demo&ndash;java版本</font></a></p>

<p><a href="https://github.com/injekt/openapi-demo-php"><font color=red >jsapi权限验证配置demo&ndash;php版本</font></a></p>
<pre class="highlight javascript"><code> <span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">agentId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，微应用ID</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span><span class="c1">//必填，企业ID</span>
    <span class="na">timeStamp</span><span class="p">:</span> <span class="p">,</span> <span class="c1">// 必填，生成签名的时间戳</span>
    <span class="na">nonceStr</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，生成签名的随机串</span>
    <span class="na">signature</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// 必填，签名</span>
    <span class="na">jsApiList</span><span class="p">:</span> <span class="p">[</span><span class="s1">'device.notification.alert'</span><span class="p">,</span> <span class="s1">'device.notification.confirm'</span><span class="p">]</span> <span class="c1">// 必填，需要使用的jsapi列表</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>agentId</td>
<td>String</td>
<td>是</td>
<td>微应用ID</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>是</td>
<td>企业ID</td>
</tr>
<tr>
<td>timeStamp</td>
<td>String</td>
<td>是</td>
<td>生成签名的时间戳</td>
</tr>
<tr>
<td>nonceStr</td>
<td>String</td>
<td>是</td>
<td>生成签名的随机串</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>是</td>
<td>签名</td>
</tr>
<tr>
<td>jsApiList</td>
<td>Array</td>
<td>是</td>
<td>需要调用的jsapi列表</td>
</tr>
</tbody></table>

<h3 id="通过ready接口处理成功验证">通过ready接口处理成功验证</h3>

<p>DingTalkPC.ready参数为回调函数，在环境准备就绪时触发，jsapi的调用需要保证在该回调函数触发后调用，否则无效。</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">){</span>
  <span class="cm">/*{
      authorizedAPIList: ['device.notification.alert'], //已授权API列表
      unauthorizedAPIList: [''], //未授权API列表
  }*/</span>
  <span class="c1">//接口操作应该在ready后才可调用</span>
<span class="p">});</span>
</code></pre>

<h3 id="通过error接口处理失败验证">通过error接口处理失败验证</h3>

<p>config信息验证失败会执行error函数，错误信息可以在返回的error参数中参看</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
  <span class="cm">/*{
      errorCode: 1001, //错误码
      errorMessage: '', //错误信息
  }*/</span>
<span class="p">});</span>
</code></pre>

<h3 id="接口约定">接口约定</h3>

<ul>
<li>所有接口都为异步</li>
<li>接受一个object类型的参数</li>
<li>成功回调 onSuccess</li>
<li>失败回调 onFail</li>
</ul>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="err">命名空间</span><span class="p">.</span><span class="err">功能</span><span class="p">.</span><span class="err">方法</span><span class="p">({</span>
    <span class="err">参数</span><span class="mi">1</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="err">参数</span><span class="mi">2</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//成功回调</span>
    <span class="cm">/*
    {
        //所有返回信息都输出在这里
    }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//失败回调</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre>

<h3 id="pc版获取免登授权码">PC版获取免登授权码</h3>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">permission</span><span class="p">.</span><span class="nx">requestAuthCode</span><span class="p">({</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="c1">//企业ID</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*{
        code: 'hYLK98jkf0m' //string authCode
    }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>

<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>是</td>
<td>企业ID</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>授权码</td>
</tr>
</tbody></table>

<h2 id="弹窗">弹窗</h2>

<p>DingTalkPC.device</p>

<h3 id="alert">alert</h3>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">alert</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"亲爱的"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"提示"</span><span class="p">,</span><span class="c1">//可传空</span>
    <span class="na">buttonName</span><span class="p">:</span> <span class="s2">"收到"</span><span class="p">,</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/*回调*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="http://gtms04.alicdn.com/tps/i4/TB1mXnaKFXXXXbvXVXXV8PWOVXX-1792-1200.png" width = "350" height = "" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息内容</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>弹窗标题</td>
</tr>
<tr>
<td>buttonName</td>
<td>String</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h3 id="confirm">confirm</h3>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">confirm</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"你爱我吗"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"提示"</span><span class="p">,</span>
    <span class="na">buttonLabels</span><span class="p">:</span> <span class="p">[</span><span class="s1">'爱'</span><span class="p">,</span> <span class="s1">'不爱'</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            buttonIndex: 0 //被点击按钮的索引值，Number类型，从0开始
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="http://gtms01.alicdn.com/tps/i1/TB1I4jbKFXXXXbBXVXX._qIYpXX-1794-1198.png" width = "350" height = "" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息说明</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number类型，从0开始</td>
</tr>
</tbody></table>

<h3 id="prompt">prompt</h3>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">prompt</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"再说一遍？"</span><span class="p">,</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"提示"</span><span class="p">,</span>
    <span class="na">buttonLabels</span><span class="p">:</span> <span class="p">[</span><span class="s1">'继续'</span><span class="p">,</span> <span class="s1">'不玩了'</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        {
            buttonIndex: 0, //被点击按钮的索引值，Number类型，从0开始
            value: '' //输入的值
        }
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<p><img src="http://gtms02.alicdn.com/tps/i2/TB1iwLlKFXXXXbgXFXXFvH2OVXX-1792-1194.png" width = "350" height = "" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>消息内容</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>buttonLabels</td>
<td>Array[String]</td>
<td>按钮名称</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number类型，从0开始</td>
</tr>
<tr>
<td>value</td>
<td>输入的值</td>
</tr>
</tbody></table>

<h3 id="toast">toast</h3>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">toast</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"information"</span><span class="p">,</span> <span class="c1">//toast的类型 alert, success, error, warning, information, confirm</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'这里是个toast'</span><span class="p">,</span> <span class="c1">//提示信息</span>
    <span class="na">duration</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">//显示持续时间，单位秒，最短2秒，最长5秒</span>
    <span class="na">delay</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">//延迟显示，单位秒，默认0, 最大限制为10</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{}*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="http://gtms03.alicdn.com/tps/i3/TB18p6hKFXXXXXBXVXXrQ409pXX-1786-1198.png" width ="350" height = "" alt="图片名称"  align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>String</td>
<td>toast的类型 alert, success, error, warning, information, confirm，默认information</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>提示信息</td>
</tr>
<tr>
<td>duration</td>
<td>Number</td>
<td>显示持续时间，单位秒，最小2，最大限制为5</td>
</tr>
<tr>
<td>delay</td>
<td>Number</td>
<td>延迟显示，单位秒，默认0，最大限制为10</td>
</tr>
</tbody></table>

<h3 id="actionsheet">actionsheet</h3>

<p>单选列表</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">notification</span><span class="p">.</span><span class="nx">actionSheet</span><span class="p">({</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"谁是最棒哒？"</span><span class="p">,</span> <span class="c1">//标题</span>
    <span class="na">cancelButton</span><span class="p">:</span> <span class="s1">'取消'</span><span class="p">,</span> <span class="c1">//取消按钮文本</span>
    <span class="na">otherButtons</span><span class="p">:</span> <span class="p">[</span><span class="s2">"孙悟空"</span><span class="p">,</span><span class="s2">"猪八戒"</span><span class="p">,</span><span class="s2">"唐僧"</span><span class="p">,</span><span class="s2">"沙和尚"</span><span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*{
            buttonIndex: 0 //被点击按钮的索引值，Number，从0开始, 取消按钮为-1
        }*/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="http://gtms04.alicdn.com/tps/i4/TB1mSvwKFXXXXX7XFXXpXX.QFXX-1886-1278.png" width = "350" height = "" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
<tr>
<td>cancelButton</td>
<td>String</td>
<td>取消按钮文本</td>
</tr>
<tr>
<td>otherButtons</td>
<td>Array[String]</td>
<td>其他按钮列表</td>
</tr>
</tbody></table>

<h5 id="返回说明">返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>buttonIndex</td>
<td>被点击按钮的索引值，Number，从0开始, 取消按钮为-1</td>
</tr>
</tbody></table>

<h2 id="业务">业务</h2>

<p>DingTalkPC.biz</p>

<h3 id="打开应用内页面">打开应用内页面</h3>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">open</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span><span class="s1">'profile'</span><span class="p">,</span><span class="c1">//页面名称</span>
    <span class="na">params</span><span class="p">:{</span>
        <span class="na">id</span><span class="p">:</span> <span class="s1">'123456'</span><span class="p">,</span><span class="c1">// String 必选 用户工号</span>
        <span class="na">corpId</span><span class="p">:</span><span class="s1">'dingb4ff1079f84f8d54'</span> <span class="c1">//String 必选 企业id</span>
    <span class="p">},</span><span class="c1">//传参</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>页面名称</td>
</tr>
<tr>
<td>params</td>
<td>JSONObject</td>
<td>传参</td>
</tr>
</tbody></table>

<p>目前支持以下页面，具体参数看右边</p>

<ol>
<li>个人资料页</li>
</ol>

<p>传参例子(右旁代码区)以及参数说明</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"profile"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"params"</span><span class="p">:{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"corpId"</span><span class="p">:</span><span class="s2">"dingb4ff1079f84f8d54"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"onSuccess"</span><span class="p">:</span><span class="err">function()</span><span class="w"> </span><span class="p">{</span><span class="w">

    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"onFail"</span><span class="p">:</span><span class="err">function(err)</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>是</td>
<td>固定为 &ldquo;profile&rdquo;</td>
</tr>
<tr>
<td>params.id</td>
<td>String</td>
<td>是</td>
<td>用户工号</td>
</tr>
<tr>
<td>params.corpId</td>
<td>String</td>
<td>是</td>
<td>企业ID</td>
</tr>
</tbody></table>

<!--
b.聊天页面

```javascript
// 页面名称：
    chat
// 传参：
    users: ['123'] 用户列表,工号
    corpId: '' //企业id
```

c.免费电话页面

```javascript
// 页面名称：
    call
// 传参：
```

d.联系人添加页面

```javascript
// 页面名称：
    contactAdd
// 传参：
```

f.唤起添加好友页面


```
// 页面名称：
    friendAdd
// 传参：
``` -->

<h3 id="打开模态框（modal）">打开模态框（modal）</h3>

<p>打开一个模态框</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">openModal</span><span class="p">({</span>
    <span class="na">size</span><span class="p">:</span><span class="s1">'middle'</span><span class="p">,</span>  <span class="c1">// modal的尺寸</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://test.dingtalk.com/modal.html'</span><span class="p">,</span> <span class="c1">//打开modal的内容的url</span>
    <span class="na">title</span><span class="p">:</span> <span class="s1">'modal title'</span><span class="p">,</span> <span class="c1">//顶部标题</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*

        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="http://gtms02.alicdn.com/tps/i2/TB1PqPwKFXXXXa8XFXXsaR5YpXX-1880-1276.png" width = "350" height = "" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>size</td>
<td>String</td>
<td>模态框的尺寸大小 三种选择 具体看下表</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>模态框内部显示内容的url</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>模态框标题</td>
</tr>
</tbody></table>

<h5 id="尺寸选择详情：">尺寸选择详情：</h5>

<table><thead>
<tr>
<th>名称</th>
<th>size输入</th>
<th>尺寸长宽</th>
</tr>
</thead><tbody>
<tr>
<td>（默认）大模态框</td>
<td></td>
<td>包括标题 676px * 545px</td>
</tr>
<tr>
<td>中模态框</td>
<td>&ldquo;middle&rdquo;</td>
<td>包括标题 440px * 300px</td>
</tr>
<tr>
<td>小模态框</td>
<td>&ldquo;mini&rdquo;</td>
<td>包括标题 366px * 120px</td>
</tr>
</tbody></table>

<h3 id="打开侧边面板（slidepanel）">打开侧边面板（SlidePanel）</h3>

<p>打开侧边面板</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">openSlidePanel</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'about:blank'</span><span class="p">,</span> <span class="c1">//打开侧边栏的url</span>
    <span class="na">title</span><span class="p">:</span> <span class="s1">'title'</span><span class="p">,</span> <span class="c1">//侧边栏顶部标题</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="http://gtms02.alicdn.com/tps/i2/TB1mzDBKFXXXXcTXpXXhMAQZVXX-1888-1278.png" width = "350" height = "" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>String</td>
<td>侧边面板顶部显示标题</td>
</tr>
<tr>
<td>url</td>
<td>String</td>
<td>侧边面板内部显示内容的url</td>
</tr>
</tbody></table>

<h3 id="上传图片">上传图片</h3>

<p>选择图片+上传，防止恶意上传</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">uploadImage</span><span class="p">({</span>
    <span class="na">multiple</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="c1">//是否多选，默认false</span>
    <span class="na">max</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">//最多可选个数</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
        [
          'https://static.dingtalk.com/media/lADOA9bQH8zIzMg_200_200.jpg'
        ]
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>multiple</td>
<td>Boolean</td>
<td>是否多选，默认false</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>Number为正整数，最多可选个数</td>
</tr>
</tbody></table>

<h3 id="下载文件">下载文件</h3>

<p>下载一个文件</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">downloadFile</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'//static.dingtalk.com/media/lADOADTWJM0C2M0C7A_748_728.jpg_60x60q90.jpg'</span><span class="p">,</span> <span class="c1">//要下载的文件的url</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'一个图片.jpg'</span><span class="p">,</span> <span class="c1">//定义下载文件名字</span>
    <span class="na">onProgress</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">){</span>
      <span class="c1">// 文件下载进度回调</span>
    <span class="p">},</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
          true
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="http://gtms02.alicdn.com/tps/i2/TB1TfjCKFXXXXXwXFXXDZsQZVXX-1888-1280.png" width = "350" height = "" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String</td>
<td>要下载文件的url</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>定义下载文件的名字，记得添加文件扩展名，默认无文件扩展名</td>
</tr>
<tr>
<td>onProgress</td>
<td>Function</td>
<td>文件下载进度回调</td>
</tr>
</tbody></table>

<h3 id="打开本地文件">打开本地文件</h3>

<p>打开本地文件接口</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">openLocalFile</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//本地文件的url</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
          true
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String</td>
<td>url是缓存文件的key</td>
</tr>
</tbody></table>

<h3 id="批量检测本地文件是否存在">批量检测本地文件是否存在</h3>

<p>批量检测本地文件是否存在</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">isLocalFileExist</span><span class="p">({</span>
    <span class="na">params</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//本地文件的url</span>
      <span class="p">},{</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">''</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*
          [{
              url: '', //本地文件的url
              path: '', // 文件的path
              isExist: true //根据你输入的文件的url检测出的结果，true:存在，false：不存在
          }]
        */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String</td>
<td>url是缓存文件的key</td>
</tr>
</tbody></table>

<h3 id="预览图片">预览图片</h3>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">previewImage</span><span class="p">({</span>
    <span class="na">urls</span><span class="p">:</span> <span class="p">[</span><span class="s1">'//static.dingtalk.com/media/1.jpg'</span><span class="p">,</span> <span class="s1">'//static.dingtalk.com/media/2.jpg'</span><span class="p">],</span><span class="c1">//图片地址列表</span>
    <span class="na">current</span><span class="p">:</span> <span class="s1">'//static.dingtalk.com/media/1.jpg'</span><span class="p">,</span><span class="c1">//当前显示的图片链接</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<p><img src="http://gtms02.alicdn.com/tps/i2/TB1SaYsKFXXXXaIXVXXkOgK6FXX-1882-1276.png" width = "350" height = "" alt="图片名称" align=right /></p>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>urls</td>
<td>Array[String]</td>
<td>图片地址列表</td>
</tr>
<tr>
<td>current</td>
<td>String</td>
<td>当前显示的图片链接</td>
</tr>
</tbody></table>

<h3 id="在浏览器上打开链接">在浏览器上打开链接</h3>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">openLink</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://www.dingtalk.com"</span><span class="p">,</span><span class="c1">//要打开链接的地址</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String</td>
<td>要打开链接的地址</td>
</tr>
</tbody></table>

<h2 id="导航">导航</h2>

<p>DingTalkPC.biz</p>

<h3 id="触发关闭">触发关闭</h3>

<p>注意：只在SlidePanel和Modal里起作用</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">quit</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="s2">"quit message"</span><span class="p">,</span><span class="c1">//退出信息，传递给openModal或者openSlidePanel的onSuccess函数的result参数</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>String</td>
<td>退出信息，传递给openModal或者openSlidePanel的onSuccess函数的result参数</td>
</tr>
</tbody></table>

<h3 id="设置标题">设置标题</h3>

<p>注意：只在SlidePanel和Modal里起作用</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setTitle</span><span class="p">({</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">"lalala"</span><span class="p">,</span><span class="c1">//标题</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
</tbody></table>

<h3 id="设置左侧导航按钮">设置左侧导航按钮</h3>

<p>注意：只在SlidePanel里起作用</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">navigation</span><span class="p">.</span><span class="nx">setLeft</span><span class="p">({</span>
    <span class="na">text</span><span class="p">:</span> <span class="s2">"lalala"</span><span class="p">,</span><span class="c1">//显示文字信息</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/**/</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>String</td>
<td>显示文字信息</td>
</tr>
</tbody></table>

<h4 id="设置左侧按钮点击后的回调">设置左侧按钮点击后的回调</h4>

<p>DingTalkPC.addEventListener(&lsquo;leftBtnClick&rsquo;, handleFn);</p>
<pre class="highlight javascript"><code><span class="c1">//添加监听回调函数</span>
<span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'leftBtnClick'</span><span class="p">,</span> <span class="nx">handleFn</span><span class="p">);</span>

<span class="c1">//移除相应handleFn的监听回调函数</span>
<span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">'leftBtnClick'</span><span class="p">,</span> <span class="nx">handleFn</span><span class="p">);</span>

</code></pre>

<h2 id="ding">Ding</h2>

<p>DingTalkPC.biz</p>

<h3 id="发钉">发钉</h3>

<h4 id="图片类型">图片类型</h4>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">ding</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
    <span class="na">users</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span> <span class="s1">'101'</span><span class="p">],</span><span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">'dingb4ff1079f84f8d54'</span><span class="p">,</span> <span class="c1">//加密的企业id</span>
    <span class="na">type</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">//钉类型 1：image  2：link</span>
    <span class="na">alertType</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="na">alertDate</span><span class="p">:</span> <span class="p">{</span><span class="s2">"format"</span><span class="p">:</span><span class="s2">"yyyy-MM-dd HH:mm"</span><span class="p">,</span><span class="s2">"value"</span><span class="p">:</span><span class="s2">"2015-05-09 08:00"</span><span class="p">},</span>
    <span class="na">attachment</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">images</span><span class="p">:</span> <span class="p">[</span><span class="s1">''</span><span class="p">],</span> <span class="c1">//只取第一个image</span>
    <span class="p">},</span> <span class="c1">//附件信息</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//消息体</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>type</td>
<td>Number</td>
<td>Number为整数。钉类型 1：image，2：link</td>
</tr>
<tr>
<td>alertType</td>
<td>Number</td>
<td>钉提醒类型 0：电话, 1：短信, 2：应用内</td>
</tr>
<tr>
<td>alertDate</td>
<td>Object</td>
<td>钉提醒时间</td>
</tr>
<tr>
<td>attachment</td>
<td>Object</td>
<td>附件信息</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>消息体</td>
</tr>
</tbody></table>

<h4 id="link类型">Link类型</h4>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">ding</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
    <span class="na">users</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'100'</span><span class="p">,</span> <span class="s1">'101'</span><span class="p">],</span><span class="c1">//用户列表，工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">'dingb4ff1079f84f8d54'</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">type</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">//钉类型 1：image  2：link</span>
    <span class="na">alertType</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="na">alertDate</span><span class="p">:</span> <span class="p">{</span><span class="s2">"format"</span><span class="p">:</span><span class="s2">"yyyy-MM-dd HH:mm"</span><span class="p">,</span><span class="s2">"value"</span><span class="p">:</span><span class="s2">"2015-05-09 08:00"</span><span class="p">},</span>
    <span class="na">attachment</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//附件的标题</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//附件点击后跳转url</span>
        <span class="na">image</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//附件显示时的图片 【可选】</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">''</span> <span class="c1">//附件显示时的消息体 【可选】</span>
    <span class="p">}</span>
    <span class="nl">text</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">//消息体</span>
    <span class="na">onSuccess</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">})</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>用户列表，工号</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>type</td>
<td>Number</td>
<td>Number为整数。钉类型 1：image  2：link</td>
</tr>
<tr>
<td>alertType</td>
<td>Number</td>
<td>钉提醒类型 0：电话, 1：短信, 2：应用内</td>
</tr>
<tr>
<td>alertDate</td>
<td>Object</td>
<td>钉提醒时间</td>
</tr>
<tr>
<td>attachment</td>
<td>Object</td>
<td>附件信息</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>消息体</td>
</tr>
</tbody></table>

<h2 id="企业通讯录">企业通讯录</h2>

<p>DingTalkPC.biz</p>

<h3 id="选人">选人</h3>

<p>此接口只能对用户进行选择，若要同时选择部门，请使用“选人，选部门”接口。</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">contact</span><span class="p">.</span><span class="nx">choose</span><span class="p">({</span>
    <span class="na">multiple</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">//是否多选： true多选 false单选； 默认true</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'10001'</span><span class="p">,</span> <span class="s1">'10002'</span><span class="p">,</span> <span class="p">...],</span> <span class="c1">//默认选中的用户列表，工号；成功回调中应包含该信息</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">'dingb4ff1079f84f8d54'</span><span class="p">,</span> <span class="c1">//企业id</span>
    <span class="na">max</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="c1">//人数限制，当multiple为true才生效，可选范围1-1500</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* data结构
      [{
        "name": "张三", //姓名
        "avatar": "http://g.alicdn.com/avatar/zhangsan.png" //头像图片url，可能为空
        "emplId": '0573', //工号
       },
       ...
      ]
    */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>multiple</td>
<td>Boolean</td>
<td>是否多选： true多选，false单选； 默认true</td>
</tr>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>默认选中的用户列表，工号；成功回调中应包含该信息</td>
</tr>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业id</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>人数限制，当multiple为true才生效，可选范围1-1500</td>
</tr>
</tbody></table>

<!--
startWithDepartmentId: Number, //-1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)
startWithDepartmentId | Number | -1表示从自己所在部门开始, 0表示从企业最上层开始，(其他数字表示从该部门开始:暂时不支持)
-->

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>姓名</td>
</tr>
<tr>
<td>avatar</td>
<td>头像图片url，可能为空</td>
</tr>
<tr>
<td>emplId</td>
<td>工号</td>
</tr>
</tbody></table>

<h2 id="自定义联系人">自定义联系人</h2>

<p>DingTalkPC.biz</p>

<h3 id="单选自定义联系人">单选自定义联系人</h3>

<p>选取单个自定义联系人</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">customContact</span><span class="p">.</span><span class="nx">choose</span><span class="p">({</span>
    <span class="na">title</span><span class="p">:</span> <span class="s1">'选人的标题'</span><span class="p">,</span> <span class="c1">//标题</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'10001'</span><span class="p">,</span> <span class="s1">'10002'</span><span class="p">,</span> <span class="p">...],</span><span class="c1">//一组员工工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">'dingb4ff1079f84f8d54'</span><span class="p">,</span><span class="c1">//加密的企业 ID，</span>
    <span class="na">isShowCompanyName</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>   <span class="c1">//true|false，默认为 false</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* data结构
      [{
        "name": "张三", //姓名
        "avatar": "http://g.alicdn.com/avatar/zhangsan.png" //头像图片url，可能为空
        "emplId": '0573', //工号
       },
       ...
      ]
    */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业ID</td>
</tr>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>一组员工工号</td>
</tr>
<tr>
<td>isShowCompanyName</td>
<td>Boolean</td>
<td>是否显示公司名称</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>标题</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>姓名</td>
</tr>
<tr>
<td>avatar</td>
<td>头像图片url，可能为空</td>
</tr>
<tr>
<td>emplId</td>
<td>工号</td>
</tr>
</tbody></table>

<h3 id="多选自定义联系人">多选自定义联系人</h3>

<p>选取多个自定义联系人</p>
<pre class="highlight javascript"><code><span class="nx">DingTalkPC</span><span class="p">.</span><span class="nx">biz</span><span class="p">.</span><span class="nx">customContact</span><span class="p">.</span><span class="nx">multipleChoose</span><span class="p">({</span>
    <span class="na">title</span><span class="p">:</span> <span class="s1">'多选人的标题'</span><span class="p">,</span> <span class="c1">//标题</span>
    <span class="na">users</span><span class="p">:</span> <span class="p">[</span><span class="s1">'10001'</span><span class="p">,</span> <span class="s1">'10002'</span><span class="p">,</span> <span class="p">...],</span><span class="c1">//一组员工工号</span>
    <span class="na">corpId</span><span class="p">:</span> <span class="s1">'dingb4ff1079f84f8d54'</span><span class="p">,</span><span class="c1">//企业 ID，</span>
    <span class="na">isShowCompanyName</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>   <span class="c1">//true|false，默认为 false</span>
    <span class="na">selectedUsers</span><span class="p">:</span> <span class="p">[</span><span class="s2">"18658"</span><span class="p">],</span> <span class="c1">//默认选中的人</span>
    <span class="na">disabledUsers</span><span class="p">:</span> <span class="p">[</span><span class="s2">"78308"</span><span class="p">],</span> <span class="c1">//不能选的人</span>
    <span class="na">max</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="c1">//人数限制</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* data结构
      [{
        "name": "张三", //姓名
        "avatar": "http://g.alicdn.com/avatar/zhangsan.png" //头像图片url，可能为空
        "emplId": '0573', //工号
       },
       ...
      ]
    */</span>
    <span class="p">},</span>
    <span class="na">onFail</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>

<h5 id="参数说明">参数说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>参数类型</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>corpId</td>
<td>String</td>
<td>企业ID</td>
</tr>
<tr>
<td>users</td>
<td>Array[String]</td>
<td>是否多选： true多选，false单选； 默认true</td>
</tr>
<tr>
<td>isShowCompanyName</td>
<td>Boolean</td>
<td>默认选中的用户列表，工号；成功回调中应包含该信息</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>选择窗口的标题</td>
</tr>
<tr>
<td>selectedUsers</td>
<td>Array[String]</td>
<td>默认选中的人</td>
</tr>
<tr>
<td>disabledUsers</td>
<td>Array[String]</td>
<td>不能选的人</td>
</tr>
<tr>
<td>max</td>
<td>Number</td>
<td>人数限制</td>
</tr>
</tbody></table>

<h5 id="　返回说明">　返回说明</h5>

<table><thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>姓名</td>
</tr>
<tr>
<td>avatar</td>
<td>头像图片url，可能为空</td>
</tr>
<tr>
<td>emplId</td>
<td>工号</td>
</tr>
</tbody></table>

<!-- ## 聊天
DingTalkPC.biz

### 选择会话

```javascript
DingTalkPC.biz.chat.chooseConversation({
    onSuccess: function(data) {
    /* data结构
      {
        "id":"25001:2442003", //会话id
        "title":"钉钉-轻浅-pc专业户" // 会话名称
      }
    */
    },
    onFail : function(err) {}
});
```

#### 参数说明

空


#### 返回说明

参数 | 说明
------|------
id | 会话id
title | 会话名称 -->

<h2 id="附录">附录</h2>

<h3 id="js-api权限签名算法">JS-API权限签名算法</h3>

<p>如果开发者想使用钉钉容器开放的jsapi接口，需要经过以下流程：</p>

<ul>
<li><p>首先需要<a href="#获取jsapi_ticket"><font color=red >获取jsapi_ticket</font></a>。</p></li>
<li><p>然后在web页面加载到钉钉容器时，通过<a href="#页面引入js文件"><font color=red >jsapi权限验证配置接口</font></a>验证可用的jsapi。这个接口使用的参数signature，在下文中有详细的说明。</p></li>
</ul>

<h4 id="1-获取jsapi_ticket">1.获取jsapi_ticket</h4>

<p>jsapi_ticket,是开发者调用钉钉JS接口的临时授权码，其作用主要用于生成签名，这个签名在<a href="http://open.dingtalk.com/#页面引入js文件"><font color=red >jsapi权限验证配置接口</font></a>中使用。</p>

<p>正常的情况下，jsapi_ticket的有效期为7200秒，通过access_token来获取。由于频繁刷新jsapi_ticket会导致api调用受限，影响自身业务，开发者必须在自己的服务全局缓存jsapi_ticket。
获取jsapi_ticket，具体可以<a href="#js接口api"><font color=red >参考文档</font></a></p>

<h4 id="2-签名生成算法">2.签名生成算法</h4>

<p>开发者在web页面使用钉钉容器提供的jsapi时，需要验证调用权限，并以参数signature标识合法性</p>

<p>签名生成的规则：</p>

<p>List keyArray = sort(noncestr,timestamp,jsapi_ticket,url);</p>

<p>String str = assemble(keyArray);</p>

<p>signature = sha1(str);</p>

<p>参与签名的字段包括在上文中获取的jsapi_ticket，noncestr（随机字符串，自己随便填写即可）,timestamp（当前时间戳，具体值为当前时间到1970年1月1号的秒数）,url（当前网页的URL，不包含#及其后面部分）。例如：</p>

<ul>
<li>noncestr=Zn4zmLFKD0wzilzM</li>
<li>jsapi_ticket=mS5k98fdkdgDKxkXGEs8LORVREiweeWETE40P37wkidkfksDSKDJFD5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcKIDU8l</li>
<li>timestamp=1414588745</li>
<li>url=http://open.dingtalk.com</li>
</ul>

<p>步骤1. sort()含义为对所有待签名参数按照字段名的ASCII 码从小到大排序（字典序）</p>

<p>步骤2. assemble()含义为根据步骤1中获的参数字段的顺序，使用URL键值对的格式（即key1=value1&amp;key2=value2…）拼接成字符串</p>

<p>步骤2. sha1()的含义为对在步骤2拼接好的字符串进行sha1加密。</p>

<h3 id="图片缩放">图片缩放</h3>

<p>通过JS-API获取的图片都支持缩放，比如图片：</p>

<p><code class="prettyprint">http://gtms02.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg</code></p>

<p>可通过文件名拼接的方法缩放为最大宽高为250x250的尺寸。</p>

<p><code class="prettyprint">http://gtms02.alicdn.com/tps/i2/TB1SlYwGFXXXXXrXVXX9vKJ2XXX-2880-1560.jpg_250x250.jpg</code></p>

<p>拼接规则为:文件名+拼接规则；推荐使用以下拼接规则：</p>

<p>80x80 =&gt; _80x80.jpg</p>

<p>120x120 =&gt; _120x120.jpg</p>

<p>250x250 =&gt; _250x250.jpg</p>

<p>310x310 =&gt; _310x310.jpg</p>

<!--
### 容器能力

[runtime.permission.requestAuthCode](#获取免登授权码)

[device.notification.alert](#alert)

[device.notification.confirm](#confirm)

[device.notification.prompt](#prompt)

[device.notification.toast](#toast)

[device.notification.actionSheet](#actionSheet)

[biz.util.open](#打开应用内页面)

[biz.util.openModal](#打开模态框（modal）)

[biz.util.openSlidePanel](#打开侧边面板（SlidePanel）)

[biz.util.uploadImage](#上传图片)

[biz.util.downloadFile](#下载文件)

[biz.util.openLocalFile](#打开文件)

[biz.util.isLocalFileExist](#批量检测文件是否存在)

[biz.util.previewImage](#预览图片)

[biz.util.openLink](#在浏览器上打开链接)

[biz.navigation.quit](#触发关闭)

[biz.navigation.setTitle](#设置标题)

[biz.navigation.setLeft](#设置左侧导航按钮)

[biz.ding.post](#发钉)

[biz.contact.choose](#选人)

[biz.customContact.choose](#单选自定义联系人)

[biz.customContact.multipleChoose](#多选自定义联系人) -->

          <h1 id="微应用体验优化">微应用体验优化</h1>

<h2 id="ui规范">UI规范</h2>

<p>对于钉钉中的微应用，要求能符合钉钉整体的UI规范。诸如字体，字号，颜色等。
<img alt="UI" src="https://img.alicdn.com/tps/TB1.yF4KpXXXXcBXpXXXXXXXXXX-601-281.jpg" /></p>

<p><a href="http://yunpan.taobao.com/s/k9w3LeGzmM"><font color=red>UI规范下载</font></a></p>

<h2 id="h5性能优化方案">H5性能优化方案</h2>

<p>对于一个H5的产品，功能无疑很重要，但是性能同样是用户体验中不可或缺的一环。原本H5的渲染性能就不及native的app，如果不把性能优化做起来，将极大地影响用户使用产品的积极性。所以我们提供了一份H5性能优化的方案，<a href="http://ddtalk.github.io/blog/2015/09/07/dingding-first/"><font color=red>地址</font></a>。</p>

<h2 id="微应用性能评测">微应用性能评测</h2>

<p>目前微应用性能评测流程还在优化阶段。<br></p>

<p>微应用的性能测验主要是对微应用的整体性能进行评分，这其中包括但不仅限于首屏打开时间等指标。<br></p>

<p>大概流程如下：<br></p>

<p>1、微应用进行性能评测前首先需要确保我们的测试帐号被加入到将要测验的企业里。目前的测试帐号有以下几个：<font color=blue > 13291824394, 15210137915，15810497158。 </font> <br></p>

<p>2、<a href="http://mqc.aliyun.com/hfive.htm?from=dingtalk">点击打开测验页面</a> <br></p>

<p>3、然后，按照提示，输入要测试的H5应用地址，下一步选择手机即可开始测验。<br></p>

<p>4、测验完成之后，就可以看到测试报告了。测试报告会给出被测试的微应用的整体打分。这个打分机制我们还在不断优化，后续会根据大家的case制定出一套完善的评分机制。测试报告同时会给出被测验的微应用需要优化的地方，开发者可以根据测试报告的优化建议进行相关优化，待优化完成可以再次发起测验流程，并查看报告。<br></p>

<h2 id="cdn">CDN</h2>

<p>钉钉开放平台为常用的js库提供了CDN加速服务，这样做不仅可以为您节省流量，还可以获得更快的访问速度。</p>

<h3 id="backbone">backbone</h3>

<p><a href="http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone-min.js">http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone-min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone.js">http://g.alicdn.com/ilw/cdnjs/backbone/1.2.1/backbone.js</a></p>

<h3 id="jquery">jquery</h3>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.min.js">http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.js">http://g.alicdn.com/ilw/cdnjs/jquery/2.1.4/jquery.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.min.js">http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.js">http://g.alicdn.com/ilw/cdnjs/jquery/1.8.3/jquery.js</a></p>

<h3 id="underscore">underscore</h3>

<p><a href="http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore-min.js">http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore-min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore.js">http://g.alicdn.com/ilw/cdnjs/underscore/1.8.3/underscore.js</a></p>

<h3 id="zepto">zepto</h3>

<p><a href="http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.min.js">http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.min.js</a></p>

<p><a href="http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.js">http://g.alicdn.com/ilw/cdnjs/zepto/1.1.6/zepto.js</a></p>

          <h1 id="调试工具">调试工具</h1>

<ul>
<li><p><a href="https://debug.dingtalk.com"><font color=red >钉钉服务端API调试工具</font></a></p></li>
<li><p><a href="https://debug.dingtalk.com/isv.html"><font color=red >ISV接入调试工具</font></a></p></li>
<li><p><a href="http://wsdebug.dingtalk.com/"><font color=red >JSAPI调试工具</font></a>（打开页面后，手机扫描二维码，然后在页面上配置参数，即可调试）</p></li>
</ul>

          <h1 id="团队博客">团队博客</h1>

<p>钉钉开放平台团队建立了一个博客，以提供更加详细的关于钉钉开放平台的信息，帮助钉钉开发者更好的进行开发</p>

<p>如有兴趣，请查看：<a href="http://ddtalk.github.io/blog/"><font color=red>地址</font></a></p>

          <h1 id="faq">FAQ</h1>

<h3 id="q-从哪里可以获得corpid和corpsecret">Q:从哪里可以获得CorpID和CorpSecret?</h3>

<p>A:在钉钉管理后台的微应用设置页面可以获取，详细方法请参见<a href="#获取corpid和corpsecret"><font color=red >《接入指南-获取CorpID和CorpSecret》</font></a>。</p>

<h3 id="q-『计算解密文字错误』怎么解决？">Q:『计算解密文字错误』怎么解决？</h3>

<p>A:查看<a href="#加解密库和demo下载"><font color=red >加解密库和demo下载</font></a>第二个步骤</p>

<h3 id="q-调用管理通讯录接口返回430004，无效的http-header-content-type如何解决？">Q:调用管理通讯录接口返回430004，无效的HTTP HEADER Content-Type如何解决？</h3>

<p>A:管理通讯录的部分接口采用了POST请求，请求体使用JSON格式，请在HTTP请求头中设置Content-Type:application/json。</p>

<h3 id="q-如何试用套件">Q:如何试用套件</h3>

<p>A:参见<a href="http://download.taobaocdn.com/freedom/31112/pdf/p1a01o2gfr4q811go5fq19i5ni14.pdf"><font color=red >套件试用流程</font></a></p>

<h3 id="q-部署阿里云ssl证书出现问题如何解决？">Q:部署阿里云ssl证书出现问题如何解决？</h3>

<p>A:参见<a href="http://ddtalk.github.io/blog/2015/09/24/dingtalk/"><font color=red >阿里云证书配置-slb（负载均衡）</font></a></p>

<h3 id="q-jsapi权限校验时返回-message-quot-权限校验失败-quot-，errorcode-3">Q:jsapi权限校验时返回{message:&ldquo;权限校验失败&quot;，errorCode:3}</h3>

<p>A:首先检查用来生成签名(signature)的jsapi_ticket是否过期（jsapi_ticket有效期为7200秒，而且当你请求了新的ticket之后，旧的ticket就失效了）。</p>

<p>然后检查生成签名的Url参数，与调用dd.config 所在的url是否一致</p>

<p>(生成签名用的url需要去除hash部分，e.g. 如果当前页面url是http://abc.def/ghi/jkl?m=123&amp;n=456#opq，则用于生成签名的url是http://abc.def/ghi/jkl?m=123&amp;n=456)</p>

<p>可以使用<a href="https://debug.dingtalk.com"><font color=red >调试工具</font></a>来生成jsapi_ticket和signature，并和你实际使用的进行对比。</p>

<h3 id="q-上传文件不成功">Q:上传文件不成功</h3>

<p>A:使用multipart/form-data请求上传文件，需要附加文件标示信息，参数名为media，java示例代码为</p>

<p><code class="prettyprint">
HttpEntity requestEntity =MultipartEntityBuilder.create().addPart(&quot;media&quot;,
new FileBody(file, ContentType.APPLICATION_OCTET_STREAM, file.getName())).build();
</code></p>

<h3 id="q-isv如何在app及后台获取企业及用户相关信息">Q:ISV如何在App及后台获取企业及用户相关信息</h3>

<p>A:微应用主页支持使用$CORPID$模板参数表示corpid，用户访问微应用的时候钉钉将把$CORPID$替换成用户所属企业的corpid，例如http://www.dingtalk.com/index?corpid=$CORPID$。</p>

<p>获取用户信息请参考<a href="#免登服务"><font color=red >免登服务</font></a></p>

<h3 id="q-isv接入回调接口没有suiteticket推送，为什么？">Q:ISV接入回调接口没有suiteticket推送，为什么？</h3>

<p>A:当你注册套件之后，钉钉服务器会向你填写的回调接口推送suite_ticket。接收到推送之后需要返回加密后的字符串“success”,如果不返回，钉钉服务器将连续推送，直到推送次数超过100次，就不再推送。
此时您需要进入<a href="http://console.d.aliyun.com"><font color=red>开发者后台</font></a>，进入套件管理页面，点击『重新推送』按钮，即可重新推送。
<img alt="repush" src="https://img.alicdn.com/tps/TB15j7OJFXXXXckXXXXXXXXXXXX-1121-124.jpg" /></p>

<h3 id="q-isv套件回调url验证有效性失败">Q:ISV套件回调url验证有效性失败</h3>

<p>A:在填写套件回调url的时候，需要ISV填写回调url是可用的。</p>

<p>钉钉服务器通过向回调url推送一条『验证回调URL有效性事件』来判断回调url是否可用，具体流程请参见<a href="#5-回调接口（分为五个回调类型）"><font color=red>回调接口</font></a></p>

<h3 id="q-不存在的临时授权码">Q:不存在的临时授权码</h3>

<p>当您通过临时授权码(tmp_auth_code)和套件token(suite_access_token)去换取永久授权码(permanent_code)之时，需要保证suite_access_token,tmp_auth_code都没有过期。</p>

<h3 id="q-钉钉发送会话消息时候，cid怎么获取">Q:钉钉发送会话消息时候，cid怎么获取?</h3>

<p>A:请查看
<a href="#获取会话信息"><font color=red>jsapi-获取会话信息</font></a>。</p>

<p>使用场景示例:用户在微应用中拉起本地聊天窗口列表(通过调用jsapi-获取会话信息)，选择某一个聊天窗口，微应用将收到钉钉返回的cid，通过这个cid会送会话消息。</p>

<p>如果希望在后台直接发送消息，请查看服务端开发文档-<a href="#发送企业会话消息"><font color=red>发送企业会话消息</font></a>。</p>

<h3 id="q-新增部门和员工信息为中文时，创建不成功">Q:新增部门和员工信息为中文时，创建不成功</h3>

<p>A:请检查编码格式，需要是UTF-8编码</p>

<h3 id="q-使用jsapi返回签名或者ticket获取失败">Q:使用JSAPI返回签名或者Ticket获取失败</h3>

<p>A:JSAPI返回失败主要有两种错误</p>

<p>[<font color=red >错误码:52011</font>] [jsapi ticket 读取失败]</p>

<p>1)确认agentId参数正确传入</p>

<p>2)确认以传入agentId对应的企业身份获取过jsapi_ticket,也就是调用过get_jsapi_ticket方法</p>

<p>3)确认agentId对应的企业身份获取的jsapi_ticket没有过期.即在两个小时的有效期之内</p>

<p>[<font color=red >错误码:52013</font>][签名校验失败]   </p>

<p>1)确认agentId参数正确传入</p>

<p>2)确认获得的jsapi_ticket为最新的,没有其他服务同时调用get_jsapi_ticket方法,导致生成签名的jsapi_ticket过期</p>

<p>3)确认生成jsapi签名正确,可以使用debug工具进行调试https://debug.dingtalk.com/      </p>

<h3 id="q-开发遇到困难怎样反馈给你们">Q:开发遇到困难怎样反馈给你们?</h3>

<p>A:我们目前在阿里云开发者论坛开放了一个<a href="http://bbs.aliyun.com/thread/276.html?spm=5176.7189909.0.0.bq46VP"><font color=red >钉钉开放平台</font></a>模块，你可以按照以下格式发帖到这个模块，我们会定期搜集和解决。</p>

<p>请编辑如下信息，发到论坛，这样便于快速解决问题。</p>

<table><thead>
<tr>
<th>企业完整名称</th>
<th>例如 阿里巴巴</th>
</tr>
</thead><tbody>
<tr>
<td>访问接口的路径</td>
<td>例如 https://oapi.dingtalk.com/gettoken，不需要把token之类的信息附上</td>
</tr>
<tr>
<td>输入参数</td>
<td>需要提供CorpId，不需要提供AccessToken及CorpSecret</td>
</tr>
<tr>
<td>发起请求的服务器的外网IP地址</td>
<td></td>
</tr>
<tr>
<td>发起请求的时间点</td>
<td>例如 2015-6-16 10:03:50</td>
</tr>
<tr>
<td>返回的错误结果</td>
<td>例如 系统繁忙</td>
</tr>
</tbody></table>

          <h1 id="更新日志">更新日志</h1>

<ul>
<li><p>2015.12.15 <a href="#管理日历接入指南"><font color=red >增加管理日历接入指南</font></a></p></li>
<li><p>2015.11.19 <a href="#根据corpid选择会话"><font color=red >增加会话JSAPI接口</font></a></p></li>
<li><p>2015.11.19 <a href="#群会话接口（暂未开放）"><font color=red >增加群会话接口</font></a></p></li>
<li><p>2015.11.13 <a href="#oa后台管理员调用免登"><font color=red >增加OA后台管理员免登</font></a></p></li>
<li><p>2015.11.12 <a href="#ding"><font color=red >dd.biz.ding.post 增加参数</font></a></p></li>
<li><p>2015.11.5 <a href="#管理通讯录"><font color=red >通讯录接口增加参数</font></a></p></li>
<li><p>2015.10.16 <a href="#通用"><font color=red >更新客户端文档引入javascript文件版本</font></a></p></li>
<li><p>2015.10.10 <a href="#创建部门"><font color=red >创建部门和更新部门新增参数</font></a></p></li>
<li><p>2015.9.25 <a href="#5-回调接口（分为五个回调类型）"><font color=red >增加验证回调URL有效性事件和套件信息更新事件</font></a></p></li>
<li><p>2015.9.11 <a href="#通讯录变更事件回调接口"><font color=red >增加通讯录事件回调接口</font></a></p></li>
<li><p>2015.9.8 <a href="#%E2%1FZ%A2"><font color=red >增加团队博客</font></a></p></li>
<li><p>2015.9.6 <a href="#jsapi%03%D5%E5w"><font color=red >增加JS-API调试工具</font></a></p></li>
<li><p>2015.9.6 <a href="#上传图片（仅支持拍照上传）"><font color=red >增加biz.util.uploadImageFromCamera接口</font></a></p></li>
<li><p>2015.8.28 <a href="#isv接入调试工具"><font color=red >增加ISV接入调试工具</font></a></p></li>
<li><p>2015.8.25 <a href="#5-回调接口（分为三个回调类型）"><font color=red >增加回调接口加解密库和对应加解密demo</font></a></p></li>
<li><p>2015.8.20 <a href="#钉钉服务端API调试工具"><font color=red >增加钉钉服务端API调试工具</font></a></p></li>
<li><p>2015.8.6 <a href="#合作伙伴接入"><font color=red >增加合作伙伴(ISV服务提供商)接入阿里云的指南</font></a></p></li>
</ul>

      </div>
    </div
  </body>
</html>
